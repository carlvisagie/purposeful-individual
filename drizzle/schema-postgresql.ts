import { pgTable, serial, integer, bigint, varchar, text, boolean, timestamp, json, jsonb, uuid, real, doublePrecision, numeric, date, time, bigserial, smallint } from "drizzle-orm/pg-core";

export const accessibilityProfiles = pgTable("accessibility_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  screenReaderEnabled: boolean("screen_reader_enabled").default(false),
  highContrast: boolean("high_contrast").default(false),
  largeText: boolean("large_text").default(false),
  colorBlindMode: varchar("color_blind_mode", { length: 50 }),
  reduceMotion: boolean("reduce_motion").default(false),
  keyboardNavigation: boolean("keyboard_navigation").default(false),
  stickyKeys: boolean("sticky_keys").default(false),
  simplifiedInterface: boolean("simplified_interface").default(false),
  reducedDistractions: boolean("reduced_distractions").default(false),
  closedCaptions: boolean("closed_captions").default(false),
  audioDescriptions: boolean("audio_descriptions").default(false),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const accountDeletionRequests = pgTable("account_deletion_requests", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  reason: text("reason"),
  feedback: text("feedback"),
  status: varchar("status", { length: 50 }),
  scheduledFor: timestamp("scheduled_for"),
  completedAt: timestamp("completed_at"),
  requestedAt: timestamp("requested_at").defaultNow(),
});

export const accountabilityPartnerships = pgTable("accountability_partnerships", {
  id: varchar("id", { length: 255 }).notNull(),
  user1Id: varchar("user1_id", { length: 255 }).notNull(),
  user2Id: varchar("user2_id", { length: 255 }).notNull(),
  sharedGoals: text("shared_goals"),
  checkInFrequency: varchar("check_in_frequency", { length: 50 }),
  lastCheckIn: timestamp("last_check_in"),
  totalCheckIns: integer("total_check_ins").default(0),
  partnershipSatisfaction: integer("partnership_satisfaction"),
  helpfulnessRating: integer("helpfulness_rating"),
  status: varchar("status", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const achievements = pgTable("achievements", {
  id: varchar("id", { length: 255 }).notNull(),
  achievementName: varchar("achievement_name", { length: 255 }).notNull(),
  description: text("description"),
  icon: varchar("icon", { length: 255 }),
  category: varchar("category", { length: 50 }),
  difficulty: varchar("difficulty", { length: 50 }),
  requirements: text("requirements"),
  experiencePoints: integer("experience_points").notNull(),
  rarity: varchar("rarity", { length: 50 }),
  totalUnlocked: integer("total_unlocked").default(0),
  createdAt: timestamp("created_at").defaultNow(),
});

export const actPractices = pgTable("act_practices", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  practiceDate: timestamp("practice_date").notNull(),
  actProcess: varchar("act_process", { length: 50 }),
  technique: varchar("technique", { length: 255 }),
  situation: text("situation"),
  difficultThought: text("difficult_thought"),
  difficultEmotion: varchar("difficult_emotion", { length: 100 }),
  acceptanceLevel: integer("acceptance_level"),
  defusionLevel: integer("defusion_level"),
  valueIdentified: varchar("value_identified", { length: 255 }),
  actionTaken: text("action_taken"),
  psychologicalFlexibility: integer("psychological_flexibility"),
  effectiveness: integer("effectiveness"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const activeSessions = pgTable("active_sessions", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  sessionToken: varchar("session_token", { length: 500 }).notNull(),
  deviceId: varchar("device_id", { length: 255 }),
  deviceName: varchar("device_name", { length: 255 }),
  deviceType: varchar("device_type", { length: 50 }),
  ipAddress: varchar("ip_address", { length: 50 }),
  country: varchar("country", { length: 100 }),
  city: varchar("city", { length: 100 }),
  userAgent: text("user_agent"),
  browser: varchar("browser", { length: 100 }),
  os: varchar("os", { length: 100 }),
  active: boolean("active").default(true),
  lastActivityAt: timestamp("last_activity_at").defaultNow(),
  expiresAt: timestamp("expires_at"),
  mfaVerified: boolean("mfa_verified").default(false),
  createdAt: timestamp("created_at").defaultNow(),
  terminatedAt: timestamp("terminated_at"),
});

export const adaptiveOutcomeTracking = pgTable("adaptiveOutcomeTracking", {
  id: integer("id").primaryKey().notNull(),
  clientId: integer("client_id").notNull(),
  baselineDate: timestamp("baseline_date").notNull(),
  baselineEmotionalState: integer("baseline_emotional_state").notNull(),
  baselineFunctioning: integer("baseline_functioning").notNull(),
  baselineGoals: text("baseline_goals"),
  currentEmotionalState: integer("current_emotional_state"),
  currentFunctioning: integer("current_functioning"),
  goalsAchieved: text("goals_achieved"),
  emotionalImprovement: integer("emotional_improvement"),
  functioningImprovement: integer("functioning_improvement"),
  daysInCoaching: integer("days_in_coaching"),
  sleepImproved: varchar("sleep_improved", { length: 50 }),
  relationshipsImproved: varchar("relationships_improved", { length: 50 }),
  workPerformanceImproved: varchar("work_performance_improved", { length: 50 }),
  physicalHealthImproved: varchar("physical_health_improved", { length: 50 }),
  attributedToCoaching: varchar("attributed_to_coaching", { length: 50 }),
  mostHelpfulAspect: text("most_helpful_aspect"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const adminActions = pgTable("admin_actions", {
  id: varchar("id", { length: 255 }).notNull(),
  adminUserId: varchar("admin_user_id", { length: 255 }).notNull(),
  actionType: varchar("action_type", { length: 100 }).notNull(),
  actionCategory: varchar("action_category", { length: 50 }),
  targetType: varchar("target_type", { length: 100 }),
  targetId: varchar("target_id", { length: 255 }),
  description: text("description"),
  changes: text("changes"),
  ipAddress: varchar("ip_address", { length: 50 }),
  actionTimestamp: timestamp("action_timestamp").defaultNow(),
});

export const adminNotifications = pgTable("admin_notifications", {
  id: varchar("id", { length: 255 }).notNull(),
  notificationType: varchar("notification_type", { length: 50 }),
  title: varchar("title", { length: 500 }).notNull(),
  message: text("message"),
  actionUrl: varchar("action_url", { length: 500 }),
  priority: varchar("priority", { length: 50 }),
  read: boolean("read").default(false),
  readAt: timestamp("read_at"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const adminUsers = pgTable("admin_users", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  role: varchar("role", { length: 50 }),
  permissions: text("permissions"),
  active: boolean("active").default(true),
  lastLoginAt: timestamp("last_login_at"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const aiInsights = pgTable("aiInsights", {
  id: integer("id").primaryKey().notNull(),
  clientId: integer("client_id").notNull(),
  insightDate: timestamp("insight_date").defaultNow().notNull(),
  insightType: varchar("insight_type", { length: 100 }).notNull(),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description").notNull(),
  severity: varchar("severity", { length: 50 }),
  actionable: text("actionable"),
  isRead: varchar("is_read", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const aiChatConversations = pgTable("ai_chat_conversations", {
  id: integer("id").primaryKey().notNull(),
  userId: integer("user_id"),
  clientId: integer("client_id"),
  subscriptionId: integer("subscription_id"),
  sessionDuration: integer("session_duration").default(0),
  title: varchar("title", { length: 255 }),
  rating: integer("rating"),
  feedbackText: text("feedback_text"),
  feedbackCategory: varchar("feedback_category", { length: 50 }),
  wasHelpful: varchar("was_helpful", { length: 50 }),
  reviewedByAdmin: varchar("reviewed_by_admin", { length: 50 }),
  adminNotes: text("admin_notes"),
  lastMessageAt: timestamp("last_message_at").defaultNow().notNull(),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
  sessionId: varchar("session_id", { length: 36 }),
});

export const aiChatMessages = pgTable("ai_chat_messages", {
  id: integer("id").primaryKey().notNull(),
  conversationId: integer("conversation_id").notNull(),
  role: varchar("role", { length: 50 }),
  content: text("content").notNull(),
  emotionDetected: varchar("emotion_detected", { length: 100 }),
  crisisFlag: varchar("crisis_flag", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const aiCoachComparisonInsights = pgTable("ai_coach_comparison_insights", {
  id: integer("id").primaryKey().notNull(),
  generatedAt: timestamp("generated_at").defaultNow().notNull(),
  overallRanking: jsonb("overall_ranking"),
  topPerformerInsights: jsonb("top_performer_insights"),
  improvementOpportunities: jsonb("improvement_opportunities"),
  recommendations: jsonb("recommendations"),
});

export const aiCoachEvolutionLog = pgTable("ai_coach_evolution_log", {
  id: integer("id").primaryKey().notNull(),
  coachType: varchar("coach_type", { length: 50 }).notNull(),
  changeType: varchar("change_type", { length: 50 }).notNull(),
  changeDescription: text("change_description").notNull(),
  changeMadeBy: varchar("change_made_by", { length: 100 }),
  metricsBefore: jsonb("metrics_before"),
  metricsAfter: jsonb("metrics_after"),
  impactAssessment: varchar("impact_assessment", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const aiCoachFeedback = pgTable("ai_coach_feedback", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  conversationId: varchar("conversation_id", { length: 255 }),
  messageId: varchar("message_id", { length: 255 }),
  feedbackType: varchar("feedback_type", { length: 50 }),
  feedbackText: text("feedback_text"),
  rating: integer("rating"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const aiCoachPerformanceAggregates = pgTable("ai_coach_performance_aggregates", {
  id: integer("id").primaryKey().notNull(),
  coachType: varchar("coach_type", { length: 50 }).notNull(),
  periodStart: timestamp("period_start").notNull(),
  periodEnd: timestamp("period_end").notNull(),
  totalSessions: integer("total_sessions").default(0),
  completedSessions: integer("completed_sessions").default(0),
  avgDurationSeconds: integer("avg_duration_seconds"),
  avgClientRating: numeric("avg_client_rating"),
  totalBreakthroughs: integer("total_breakthroughs").default(0),
  avgMoodImprovement: numeric("avg_mood_improvement"),
  uniqueClients: integer("unique_clients").default(0),
  retentionRate: numeric("retention_rate"),
  topTechniques: jsonb("top_techniques"),
  commonIssues: jsonb("common_issues"),
  calculatedAt: timestamp("calculated_at").defaultNow().notNull(),
});

export const aiCoachProfiles = pgTable("ai_coach_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  preferredCoachingStyle: varchar("preferred_coaching_style", { length: 50 }),
  preferredTone: varchar("preferred_tone", { length: 50 }),
  verbosity: varchar("verbosity", { length: 50 }),
  proactiveCheckins: boolean("proactive_checkins").default(true),
  dailyCheckIn: boolean("daily_check_in").default(false),
  weeklyReview: boolean("weekly_review").default(true),
  dataSharing: boolean("data_sharing").default(true),
  effectiveQuestionTypes: text("effective_question_types"),
  effectiveInterventionTypes: text("effective_intervention_types"),
  optimalCheckInTiming: text("optimal_check_in_timing"),
  trustLevel: integer("trust_level"),
  satisfactionLevel: integer("satisfaction_level"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const aiCoachSessions = pgTable("ai_coach_sessions", {
  id: integer("id").primaryKey().notNull(),
  sessionId: varchar("session_id", { length: 255 }).notNull(),
  coachType: varchar("coach_type", { length: 50 }).notNull(),
  sessionMode: varchar("session_mode", { length: 50 }),
  clientId: integer("client_id"),
  userId: integer("user_id"),
  startedAt: timestamp("started_at").defaultNow().notNull(),
  endedAt: timestamp("ended_at"),
  durationSeconds: integer("duration_seconds"),
  messageCount: integer("message_count"),
  clientMessageCount: integer("client_message_count"),
  coachMessageCount: integer("coach_message_count"),
  sessionCompleted: boolean("session_completed").default(true),
  clientInitiatedEnd: boolean("client_initiated_end").default(true),
  startingMood: varchar("starting_mood", { length: 50 }),
  endingMood: varchar("ending_mood", { length: 50 }),
  moodImprovement: numeric("mood_improvement"),
  breakthroughMoments: jsonb("breakthrough_moments"),
  breakthroughCount: integer("breakthrough_count").default(0),
  techniquesUsed: jsonb("techniques_used"),
  clientRating: integer("client_rating"),
  clientFeedback: text("client_feedback"),
  wouldRecommend: boolean("would_recommend"),
  whatWorked: jsonb("what_worked"),
  whatDidntWork: jsonb("what_didnt_work"),
  rapportLevel: varchar("rapport_level", { length: 50 }),
  transcriptSummary: text("transcript_summary"),
  keyTopicsDiscussed: jsonb("key_topics_discussed"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const aiCoachTechniqueEffectiveness = pgTable("ai_coach_technique_effectiveness", {
  id: integer("id").primaryKey().notNull(),
  coachType: varchar("coach_type", { length: 50 }).notNull(),
  techniqueName: varchar("technique_name", { length: 255 }).notNull(),
  timesUsed: integer("times_used").default(0),
  avgClientRatingWhenUsed: numeric("avg_client_rating_when_used"),
  breakthroughCorrelation: numeric("breakthrough_correlation"),
  moodImprovementCorrelation: numeric("mood_improvement_correlation"),
  lastUpdated: timestamp("last_updated").defaultNow().notNull(),
});

export const aiRecommendations = pgTable("ai_recommendations", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  recommendationType: varchar("recommendation_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  reasoning: text("reasoning"),
  supportingData: text("supporting_data"),
  confidence: numeric("confidence"),
  priority: varchar("priority", { length: 50 }),
  status: varchar("status", { length: 50 }),
  userFeedback: text("user_feedback"),
  helpfulnessRating: integer("helpfulness_rating"),
  implemented: boolean("implemented").default(false),
  implementedAt: timestamp("implemented_at"),
  outcomePositive: boolean("outcome_positive"),
  createdAt: timestamp("created_at").defaultNow(),
  respondedAt: timestamp("responded_at"),
});

export const aiSafetyRules = pgTable("ai_safety_rules", {
  id: varchar("id", { length: 255 }).notNull(),
  ruleName: varchar("rule_name", { length: 255 }).notNull(),
  ruleType: varchar("rule_type", { length: 50 }),
  systemPromptAddition: text("system_prompt_addition"),
  validationLogic: text("validation_logic"),
  appliesTo: varchar("applies_to", { length: 50 }),
  priority: integer("priority").default(100),
  active: boolean("active").default(true),
  violationsPrevented: integer("violations_prevented").default(0),
  effectiveness: numeric("effectiveness"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const aiSettings = pgTable("ai_settings", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  aiCoachEnabled: boolean("ai_coach_enabled").default(true),
  aiInsightsEnabled: boolean("ai_insights_enabled").default(true),
  aiRecommendationsEnabled: boolean("ai_recommendations_enabled").default(true),
  aiPredictionsEnabled: boolean("ai_predictions_enabled").default(true),
  autoHabitTracking: boolean("auto_habit_tracking").default(false),
  autoGoalSuggestions: boolean("auto_goal_suggestions").default(true),
  autoProgressReports: boolean("auto_progress_reports").default(true),
  proactiveCheckIns: boolean("proactive_check_ins").default(true),
  proactiveInterventions: boolean("proactive_interventions").default(true),
  aiTone: varchar("ai_tone", { length: 50 }),
  aiVerbosity: varchar("ai_verbosity", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const analyticsEvents = pgTable("analytics_events", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  eventType: varchar("event_type", { length: 100 }).notNull(),
  eventData: text("event_data"),
  sessionId: varchar("session_id", { length: 255 }),
  eventTimestamp: timestamp("event_timestamp").defaultNow(),
});

export const analyticsLearning = pgTable("analytics_learning", {
  id: varchar("id", { length: 255 }).notNull(),
  insightType: varchar("insight_type", { length: 100 }).notNull(),
  avgViewRate: numeric("avg_view_rate"),
  avgActionRate: numeric("avg_action_rate"),
  avgHelpfulnessRating: numeric("avg_helpfulness_rating"),
  avgBehaviorChange: numeric("avg_behavior_change"),
  optimalTiming: varchar("optimal_timing", { length: 100 }),
  optimalFrequency: varchar("optimal_frequency", { length: 100 }),
  mostEffectiveFor: text("most_effective_for"),
  userCount: integer("user_count"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const analyticsProfiles = pgTable("analytics_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  preferredView: varchar("preferred_view", { length: 50 }),
  preferredChartType: varchar("preferred_chart_type", { length: 50 }),
  trackingFrequency: varchar("tracking_frequency", { length: 50 }),
  insightFrequency: varchar("insight_frequency", { length: 50 }),
  insightTypes: text("insight_types"),
  mostActionableInsights: text("most_actionable_insights"),
  preferredMetrics: text("preferred_metrics"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const apiKeys = pgTable("api_keys", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  keyName: varchar("key_name", { length: 255 }).notNull(),
  keyHash: varchar("key_hash", { length: 500 }).notNull(),
  keyPrefix: varchar("key_prefix", { length: 20 }),
  permissions: text("permissions"),
  ipWhitelist: text("ip_whitelist"),
  rateLimit: integer("rate_limit"),
  active: boolean("active").default(true),
  lastUsedAt: timestamp("last_used_at"),
  totalRequests: integer("total_requests").default(0),
  expiresAt: timestamp("expires_at"),
  createdAt: timestamp("created_at").defaultNow(),
  revokedAt: timestamp("revoked_at"),
});

export const apiRateLimits = pgTable("api_rate_limits", {
  id: varchar("id", { length: 255 }).notNull(),
  userIntegrationId: varchar("user_integration_id", { length: 255 }).notNull(),
  requestsPerHour: integer("requests_per_hour"),
  requestsPerDay: integer("requests_per_day"),
  requestsThisHour: integer("requests_this_hour").default(0),
  requestsToday: integer("requests_today").default(0),
  hourResetAt: timestamp("hour_reset_at"),
  dayResetAt: timestamp("day_reset_at"),
  throttled: boolean("throttled").default(false),
  throttledUntil: timestamp("throttled_until"),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const apiRequestLogs = pgTable("api_request_logs", {
  id: varchar("id", { length: 255 }).notNull(),
  apiKeyId: varchar("api_key_id", { length: 255 }),
  userId: varchar("user_id", { length: 255 }),
  method: varchar("method", { length: 10 }).notNull(),
  endpoint: varchar("endpoint", { length: 500 }).notNull(),
  statusCode: integer("status_code").notNull(),
  responseTime: integer("response_time"),
  ipAddress: varchar("ip_address", { length: 50 }),
  userAgent: text("user_agent"),
  errorMessage: text("error_message"),
  requestTimestamp: timestamp("request_timestamp").defaultNow(),
});

export const appearanceSettings = pgTable("appearance_settings", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  theme: varchar("theme", { length: 50 }),
  accentColor: varchar("accent_color", { length: 50 }),
  sidebarPosition: varchar("sidebar_position", { length: 50 }),
  compactMode: boolean("compact_mode").default(false),
  fontSize: varchar("font_size", { length: 50 }),
  fontFamily: varchar("font_family", { length: 100 }),
  highContrast: boolean("high_contrast").default(false),
  reduceMotion: boolean("reduce_motion").default(false),
  screenReaderOptimized: boolean("screen_reader_optimized").default(false),
  defaultDashboard: varchar("default_dashboard", { length: 100 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const articleFeedback = pgTable("article_feedback", {
  id: varchar("id", { length: 255 }).notNull(),
  articleId: varchar("article_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }),
  helpful: boolean("helpful").notNull(),
  feedback: text("feedback"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const auditLogs = pgTable("audit_logs", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }),
  eventType: varchar("event_type", { length: 100 }).notNull(),
  eventCategory: varchar("event_category", { length: 50 }),
  action: varchar("action", { length: 255 }).notNull(),
  resource: varchar("resource", { length: 255 }),
  resourceId: varchar("resource_id", { length: 255 }),
  details: text("details"),
  success: boolean("success").notNull(),
  errorMessage: text("error_message"),
  ipAddress: varchar("ip_address", { length: 50 }),
  userAgent: text("user_agent"),
  sessionId: varchar("session_id", { length: 255 }),
  severity: varchar("severity", { length: 50 }),
  eventTimestamp: timestamp("event_timestamp").defaultNow(),
});

export const autismOutcomeTracking = pgTable("autismOutcomeTracking", {
  id: integer("id").primaryKey().notNull(),
  profileId: integer("profile_id").notNull(),
  assessmentDate: timestamp("assessment_date").notNull(),
  atecScore: integer("atec_score"),
  carsScore: integer("cars_score"),
  communicationLevel: varchar("communication_level", { length: 50 }),
  behaviorScore: integer("behavior_score"),
  adaptiveFunctionScore: integer("adaptive_function_score"),
  giSymptomScore: integer("gi_symptom_score"),
  sleepScore: integer("sleep_score"),
  familyQol: integer("family_qol"),
  parentStress: integer("parent_stress"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const autismPatternDetection = pgTable("autismPatternDetection", {
  id: integer("id").primaryKey().notNull(),
  childProfile: text("child_profile").notNull(),
  interventionCombination: text("intervention_combination").notNull(),
  outcomeData: text("outcome_data").notNull(),
  patternType: varchar("pattern_type", { length: 50 }),
  confidence: integer("confidence"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const autismProfiles = pgTable("autismProfiles", {
  id: integer("id").primaryKey().notNull(),
  userId: integer("user_id").notNull(),
  childName: varchar("child_name", { length: 255 }).notNull(),
  dateOfBirth: timestamp("date_of_birth").notNull(),
  diagnosisDate: timestamp("diagnosis_date"),
  severity: varchar("severity", { length: 50 }),
  atecScore: integer("atec_score"),
  carsScore: integer("cars_score"),
  communicationLevel: varchar("communication_level", { length: 50 }),
  giSymptoms: text("gi_symptoms"),
  sleepIssues: text("sleep_issues"),
  sensoryProfile: text("sensory_profile"),
  behaviorChallenges: text("behavior_challenges"),
  familyResources: text("family_resources"),
  treatmentPriorities: text("treatment_priorities"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const autismProviders = pgTable("autismProviders", {
  id: integer("id").primaryKey().notNull(),
  providerType: varchar("provider_type", { length: 50 }),
  name: varchar("name", { length: 255 }).notNull(),
  location: varchar("location", { length: 255 }).notNull(),
  phone: varchar("phone", { length: 50 }),
  email: varchar("email", { length: 320 }),
  website: varchar("website", { length: 500 }),
  rating: integer("rating"),
  reviewCount: integer("review_count"),
  acceptsInsurance: varchar("accepts_insurance", { length: 50 }),
  costRange: varchar("cost_range", { length: 100 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const availabilityExceptions = pgTable("availabilityExceptions", {
  id: integer("id").primaryKey().notNull(),
  coachId: integer("coach_id").notNull(),
  startDate: timestamp("start_date").notNull(),
  endDate: timestamp("end_date").notNull(),
  reason: varchar("reason", { length: 255 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const availableIntegrations = pgTable("available_integrations", {
  id: varchar("id", { length: 255 }).notNull(),
  integrationName: varchar("integration_name", { length: 255 }).notNull(),
  description: text("description"),
  provider: varchar("provider", { length: 255 }).notNull(),
  category: varchar("category", { length: 50 }),
  authType: varchar("auth_type", { length: 50 }),
  capabilities: text("capabilities"),
  dataTypesSupported: text("data_types_supported"),
  supportsRealtime: boolean("supports_realtime").default(false),
  supportsBidirectional: boolean("supports_bidirectional").default(false),
  apiEndpoint: varchar("api_endpoint", { length: 500 }),
  apiDocumentation: varchar("api_documentation", { length: 500 }),
  rateLimitPerHour: integer("rate_limit_per_hour"),
  active: boolean("active").default(true),
  beta: boolean("beta").default(false),
  totalUsers: integer("total_users").default(0),
  avgSatisfactionRating: numeric("avg_satisfaction_rating"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const badges = pgTable("badges", {
  id: varchar("id", { length: 255 }).notNull(),
  badgeName: varchar("badge_name", { length: 255 }).notNull(),
  description: text("description"),
  icon: varchar("icon", { length: 255 }),
  category: varchar("category", { length: 100 }),
  rarity: varchar("rarity", { length: 50 }),
  howToEarn: text("how_to_earn"),
  totalAwarded: integer("total_awarded").default(0),
  createdAt: timestamp("created_at").defaultNow(),
});

export const behavioralPattern = pgTable("behavioral_pattern", {
  id: varchar("id", { length: 255 }).notNull(),
  clientProfileId: varchar("client_profile_id", { length: 255 }).notNull(),
  patternType: varchar("pattern_type", { length: 50 }).notNull(),
  patternData: json("pattern_data"),
  trend: varchar("trend", { length: 50 }),
  significance: varchar("significance", { length: 50 }),
  aiAnalysis: text("ai_analysis"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const bestPossibleSelfEntries = pgTable("best_possible_self_entries", {
  id: varchar("id", { length: 255 }).notNull(),
  journalEntryId: varchar("journal_entry_id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  timeframe: varchar("timeframe", { length: 50 }),
  personalLife: text("personal_life"),
  relationships: text("relationships"),
  career: text("career"),
  health: text("health"),
  contributions: text("contributions"),
  whoYouAre: text("who_you_are"),
  howYouFeel: text("how_you_feel"),
  entryDate: timestamp("entry_date").defaultNow(),
});

export const betaFeatures = pgTable("beta_features", {
  id: varchar("id", { length: 255 }).notNull(),
  featureName: varchar("feature_name", { length: 255 }).notNull(),
  description: text("description"),
  status: varchar("status", { length: 50 }),
  availableToAll: boolean("available_to_all").default(false),
  requiresOptIn: boolean("requires_opt_in").default(true),
  totalOptIns: integer("total_opt_ins").default(0),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const biomarkers = pgTable("biomarkers", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  testDate: timestamp("test_date").notNull(),
  fastingGlucose: numeric("fasting_glucose"),
  hba1c: numeric("hba1c"),
  fastingInsulin: numeric("fasting_insulin"),
  homaIr: numeric("homa_ir"),
  totalCholesterol: integer("total_cholesterol"),
  ldlCholesterol: integer("ldl_cholesterol"),
  hdlCholesterol: integer("hdl_cholesterol"),
  triglycerides: integer("triglycerides"),
  apoB: integer("apo_b"),
  lpA: integer("lp_a"),
  hsCrp: numeric("hs_crp"),
  alt: integer("alt"),
  ast: integer("ast"),
  ggt: integer("ggt"),
  creatinine: numeric("creatinine"),
  egfr: integer("egfr"),
  bun: integer("bun"),
  tsh: numeric("tsh"),
  freeT3: numeric("free_t3"),
  freeT4: numeric("free_t4"),
  testosterone: integer("testosterone"),
  estradiol: integer("estradiol"),
  cortisol: numeric("cortisol"),
  dhea: integer("dhea"),
  vitaminD: numeric("vitamin_d"),
  vitaminB12: integer("vitamin_b12"),
  folate: numeric("folate"),
  iron: integer("iron"),
  ferritin: integer("ferritin"),
  magnesium: numeric("magnesium"),
  wbc: numeric("wbc"),
  rbc: numeric("rbc"),
  hemoglobin: numeric("hemoglobin"),
  hematocrit: numeric("hematocrit"),
  platelets: integer("platelets"),
  homocysteine: numeric("homocysteine"),
  uricAcid: numeric("uric_acid"),
  testSource: varchar("test_source", { length: 255 }),
  notes: text("notes"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const blockedUsers = pgTable("blocked_users", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  blockedUserId: varchar("blocked_user_id", { length: 255 }).notNull(),
  reason: text("reason"),
  blockedAt: timestamp("blocked_at").defaultNow(),
});

export const bodyMeasurements = pgTable("body_measurements", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  measurementDate: timestamp("measurement_date").notNull(),
  weight: numeric("weight"),
  bodyFatPercentage: numeric("body_fat_percentage"),
  muscleMass: numeric("muscle_mass"),
  neck: numeric("neck"),
  chest: numeric("chest"),
  waist: numeric("waist"),
  hips: numeric("hips"),
  bicepLeft: numeric("bicep_left"),
  bicepRight: numeric("bicep_right"),
  thighLeft: numeric("thigh_left"),
  thighRight: numeric("thigh_right"),
  calfLeft: numeric("calf_left"),
  calfRight: numeric("calf_right"),
  frontPhoto: varchar("front_photo", { length: 255 }),
  sidePhoto: varchar("side_photo", { length: 255 }),
  backPhoto: varchar("back_photo", { length: 255 }),
  notes: text("notes"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const brainTrainingExercises = pgTable("brain_training_exercises", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  exerciseDate: timestamp("exercise_date").notNull(),
  exerciseType: varchar("exercise_type", { length: 50 }),
  exerciseName: varchar("exercise_name", { length: 255 }),
  score: integer("score"),
  accuracy: integer("accuracy"),
  speed: integer("speed"),
  difficultyLevel: integer("difficulty_level"),
  duration: integer("duration"),
  personalBest: boolean("personal_best"),
  improvementFromLast: integer("improvement_from_last"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const brandSafetyKeywords = pgTable("brand_safety_keywords", {
  id: varchar("id", { length: 255 }).notNull(),
  keyword: varchar("keyword", { length: 500 }).notNull(),
  keywordType: varchar("keyword_type", { length: 50 }),
  riskLevel: varchar("risk_level", { length: 50 }),
  alertTeam: boolean("alert_team").default(false),
  escalateToHuman: boolean("escalate_to_human").default(false),
  context: text("context"),
  active: boolean("active").default(true),
  createdAt: timestamp("created_at").defaultNow(),
});

export const breakupRecovery = pgTable("breakup_recovery", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  breakupDate: timestamp("breakup_date"),
  relationshipDuration: integer("relationship_duration"),
  initiator: varchar("initiator", { length: 50 }),
  reason: text("reason"),
  currentPhase: varchar("current_phase", { length: 50 }),
  noContactActive: boolean("no_contact_active").default(false),
  noContactStartDate: timestamp("no_contact_start_date"),
  noContactDuration: integer("no_contact_duration"),
  healingActivities: text("healing_activities"),
  supportSystem: text("support_system"),
  daysWithoutContact: integer("days_without_contact").default(0),
  goodDaysCount: integer("good_days_count").default(0),
  badDaysCount: integer("bad_days_count").default(0),
  lessonsLearned: text("lessons_learned"),
  personalGrowth: text("personal_growth"),
  futureGoals: text("future_goals"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const budgetCategories = pgTable("budget_categories", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  categoryType: varchar("category_type", { length: 50 }),
  categoryName: varchar("category_name", { length: 255 }).notNull(),
  plannedAmount: numeric("planned_amount").notNull(),
  actualAmount: numeric("actual_amount"),
  isEssential: boolean("is_essential").default(true),
  isVariable: boolean("is_variable").default(false),
  budgetMonth: varchar("budget_month", { length: 7 }),
  active: boolean("active").default(true),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const bugReports = pgTable("bug_reports", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }),
  title: varchar("title", { length: 500 }).notNull(),
  description: text("description").notNull(),
  stepsToReproduce: text("steps_to_reproduce"),
  expectedBehavior: text("expected_behavior"),
  actualBehavior: text("actual_behavior"),
  severity: varchar("severity", { length: 50 }),
  browser: varchar("browser", { length: 100 }),
  os: varchar("os", { length: 100 }),
  deviceType: varchar("device_type", { length: 100 }),
  screenshots: text("screenshots"),
  logs: text("logs"),
  status: varchar("status", { length: 50 }),
  assignedTo: varchar("assigned_to", { length: 255 }),
  fixedIn: varchar("fixed_in", { length: 100 }),
  fixedAt: timestamp("fixed_at"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const callLogs = pgTable("call_logs", {
  id: integer("id").primaryKey().notNull(),
  userId: integer("user_id").notNull(),
  subscriptionId: integer("subscription_id"),
  callType: varchar("call_type", { length: 50 }).notNull(),
  durationSeconds: integer("duration_seconds").default(0).notNull(),
  costCents: integer("cost_cents").default(0).notNull(),
  startedAt: timestamp("started_at").notNull(),
  endedAt: timestamp("ended_at"),
  status: varchar("status", { length: 50 }),
  metadata: jsonb("metadata"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const cardioSessions = pgTable("cardio_sessions", {
  id: varchar("id", { length: 255 }).notNull(),
  workoutId: varchar("workout_id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  sessionDate: timestamp("session_date").notNull(),
  activityType: varchar("activity_type", { length: 50 }),
  duration: integer("duration"),
  distance: numeric("distance"),
  avgHeartRate: integer("avg_heart_rate"),
  maxHeartRate: integer("max_heart_rate"),
  heartRateZones: text("heart_rate_zones"),
  avgPace: varchar("avg_pace", { length: 50 }),
  avgSpeed: numeric("avg_speed"),
  elevationGain: integer("elevation_gain"),
  caloriesBurned: integer("calories_burned"),
  performanceRating: integer("performance_rating"),
  recoveryHeartRate: integer("recovery_heart_rate"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const careerExperiments = pgTable("career_experiments", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  experimentType: varchar("experiment_type", { length: 50 }),
  experimentName: varchar("experiment_name", { length: 255 }).notNull(),
  description: text("description"),
  hypothesis: text("hypothesis"),
  successCriteria: text("success_criteria"),
  startDate: timestamp("start_date"),
  endDate: timestamp("end_date"),
  whatYouLearned: text("what_you_learned"),
  whatYouLiked: text("what_you_liked"),
  whatYouDisliked: text("what_you_disliked"),
  conclusion: text("conclusion"),
  nextSteps: text("next_steps"),
  status: varchar("status", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const careerMilestones = pgTable("career_milestones", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  milestoneType: varchar("milestone_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  targetDate: timestamp("target_date"),
  achievedDate: timestamp("achieved_date"),
  progress: integer("progress"),
  status: varchar("status", { length: 50 }),
  impact: text("impact"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const careerProfiles = pgTable("career_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  employmentStatus: varchar("employment_status", { length: 50 }),
  currentRole: varchar("current_role", { length: 255 }),
  currentIndustry: varchar("current_industry", { length: 255 }),
  yearsExperience: integer("years_experience"),
  primaryGoal: varchar("primary_goal", { length: 50 }),
  targetRole: varchar("target_role", { length: 255 }),
  targetIndustry: varchar("target_industry", { length: 255 }),
  targetTimeline: integer("target_timeline"),
  whatYouLove: text("what_you_love"),
  whatYoureGoodAt: text("what_youre_good_at"),
  whatWorldNeeds: text("what_world_needs"),
  whatYouCanBePaidFor: text("what_you_can_be_paid_for"),
  purposeStatement: text("purpose_statement"),
  coreValues: text("core_values"),
  currentSkills: text("current_skills"),
  skillsToLearn: text("skills_to_learn"),
  strengths: text("strengths"),
  mainBarriers: text("main_barriers"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const challengeCompletions = pgTable("challenge_completions", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  challengeCategory: varchar("challenge_category", { length: 50 }),
  challengeName: varchar("challenge_name", { length: 255 }).notNull(),
  description: text("description"),
  startDate: timestamp("start_date"),
  completionDate: timestamp("completion_date"),
  whatYouLearned: text("what_you_learned"),
  howYouGrew: text("how_you_grew"),
  badgeEarned: varchar("badge_earned", { length: 255 }),
  status: varchar("status", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
});

export const challengeParticipants = pgTable("challenge_participants", {
  id: varchar("id", { length: 255 }).notNull(),
  challengeId: varchar("challenge_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  currentStreak: integer("current_streak").default(0),
  longestStreak: integer("longest_streak").default(0),
  completionRate: numeric("completion_rate"),
  lastUpdate: timestamp("last_update"),
  completed: boolean("completed").default(false),
  joinedAt: timestamp("joined_at").defaultNow(),
});

export const challenges = pgTable("challenges", {
  id: varchar("id", { length: 255 }).notNull(),
  challengeName: varchar("challenge_name", { length: 255 }).notNull(),
  description: text("description"),
  challengeType: varchar("challenge_type", { length: 50 }),
  difficulty: integer("difficulty"),
  requirements: text("requirements"),
  experiencePoints: integer("experience_points"),
  badgeId: varchar("badge_id", { length: 255 }),
  startDate: timestamp("start_date"),
  endDate: timestamp("end_date"),
  totalAttempts: integer("total_attempts").default(0),
  totalCompletions: integer("total_completions").default(0),
  successRate: numeric("success_rate"),
  active: boolean("active").default(true),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const chartInteractions = pgTable("chart_interactions", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  widgetId: varchar("widget_id", { length: 255 }),
  interactionType: varchar("interaction_type", { length: 50 }),
  viewDuration: integer("view_duration"),
  actionTaken: boolean("action_taken").default(false),
  actionType: varchar("action_type", { length: 100 }),
  interactionTimestamp: timestamp("interaction_timestamp").defaultNow(),
});

export const clientPatterns = pgTable("clientPatterns", {
  id: integer("id").primaryKey().notNull(),
  clientId: integer("client_id").notNull(),
  patternType: varchar("pattern_type", { length: 50 }),
  patternName: varchar("pattern_name", { length: 255 }).notNull(),
  description: text("description").notNull(),
  frequency: integer("frequency").notNull(),
  confidence: integer("confidence").notNull(),
  firstDetected: timestamp("first_detected").notNull(),
  lastOccurred: timestamp("last_occurred").notNull(),
  relatedSessions: text("related_sessions"),
  actionable: text("actionable"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const clientPredictions = pgTable("clientPredictions", {
  id: integer("id").primaryKey().notNull(),
  clientId: integer("client_id").notNull(),
  predictionType: varchar("prediction_type", { length: 50 }),
  prediction: text("prediction").notNull(),
  confidence: integer("confidence").notNull(),
  reasoning: text("reasoning").notNull(),
  basedOnData: text("based_on_data"),
  validUntil: timestamp("valid_until").notNull(),
  wasAccurate: varchar("was_accurate", { length: 50 }),
  actualOutcome: text("actual_outcome"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const clientPreferences = pgTable("clientPreferences", {
  id: integer("id").primaryKey().notNull(),
  clientId: integer("client_id").notNull(),
  preferenceType: varchar("preference_type", { length: 50 }),
  preferenceName: varchar("preference_name", { length: 255 }).notNull(),
  preferenceValue: text("preference_value").notNull(),
  effectiveness: integer("effectiveness").notNull(),
  timesUsed: integer("times_used").notNull(),
  lastUsed: timestamp("last_used").notNull(),
  notes: text("notes"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const clientFeatures = pgTable("client_features", {
  id: integer("id").primaryKey().notNull(),
  userId: integer("user_id").notNull(),
  speechPatterns: jsonb("speech_patterns"),
  emotionalPatterns: jsonb("emotional_patterns"),
  communicationStyle: jsonb("communication_style"),
  preferredTopics: jsonb("preferred_topics"),
  avoidedTopics: jsonb("avoided_topics"),
  sessionPreferences: jsonb("session_preferences"),
  strengths: jsonb("strengths"),
  challenges: jsonb("challenges"),
  goals: jsonb("goals"),
  confidenceScore: integer("confidence_score").default(0),
  lastUpdatedFromSession: timestamp("last_updated_from_session"),
  totalSessionsAnalyzed: integer("total_sessions_analyzed").default(0),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const clientFiles = pgTable("client_files", {
  id: integer("id").primaryKey().notNull(),
  userId: integer("user_id").notNull(),
  conversationId: integer("conversation_id"),
  sessionId: integer("session_id"),
  fileName: varchar("file_name", { length: 255 }).notNull(),
  fileType: varchar("file_type", { length: 50 }),
  fileCategory: varchar("file_category", { length: 50 }),
  fileUrl: text("file_url").notNull(),
  fileKey: text("file_key").notNull(),
  mimeType: varchar("mime_type", { length: 100 }),
  fileSize: integer("file_size"),
  duration: integer("duration"),
  transcriptionText: text("transcription_text"),
  transcriptionStatus: varchar("transcription_status", { length: 50 }),
  coachNotes: text("coach_notes"),
  tags: text("tags"),
  uploadedAt: timestamp("uploaded_at").defaultNow().notNull(),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const clientProfile = pgTable("client_profile", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }),
  preferredName: varchar("preferred_name", { length: 255 }),
  pronouns: varchar("pronouns", { length: 50 }),
  age: integer("age"),
  location: varchar("location", { length: 255 }),
  communicationStyle: text("communication_style"),
  preferredChannel: varchar("preferred_channel", { length: 50 }),
  bestTimeToReach: varchar("best_time_to_reach", { length: 100 }),
  commonTriggers: json("common_triggers"),
  copingStrategies: json("coping_strategies"),
  emotionalPatterns: text("emotional_patterns"),
  currentGoals: json("current_goals"),
  pastWins: json("past_wins"),
  ongoingChallenges: json("ongoing_challenges"),
  crisisRiskLevel: varchar("crisis_risk_level", { length: 50 }),
  lastCrisisDate: timestamp("last_crisis_date"),
  crisisNotes: text("crisis_notes"),
  firstContactDate: timestamp("first_contact_date").defaultNow().notNull(),
  lastContactDate: timestamp("last_contact_date").defaultNow().notNull(),
  totalConversations: integer("total_conversations").default(0).notNull(),
  totalMessages: integer("total_messages").default(0).notNull(),
  totalPhoneCalls: integer("total_phone_calls").default(0).notNull(),
  totalSms: integer("total_sms").default(0).notNull(),
  aiSummary: text("ai_summary"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
  trialMessagesRemaining: integer("trial_messages_remaining").default(100).notNull(),
  trialStartDate: timestamp("trial_start_date").defaultNow().notNull(),
  trialEndDate: timestamp("trial_end_date"),
  subscriptionTier: varchar("subscription_tier", { length: 50 }),
});

export const clients = pgTable("clients", {
  id: integer("id").primaryKey().notNull(),
  coachId: integer("coach_id").notNull(),
  name: varchar("name", { length: 255 }).notNull(),
  email: varchar("email", { length: 320 }),
  phone: varchar("phone", { length: 50 }),
  dateOfBirth: timestamp("date_of_birth"),
  goals: text("goals"),
  notes: text("notes"),
  status: varchar("status", { length: 50 }),
  startDate: timestamp("start_date").defaultNow().notNull(),
  endDate: timestamp("end_date"),
  jobTitle: varchar("job_title", { length: 200 }),
  company: varchar("company", { length: 200 }),
  industry: varchar("industry", { length: 100 }),
  careerGoals: text("career_goals"),
  age: integer("age"),
  locationCity: varchar("location_city", { length: 100 }),
  locationState: varchar("location_state", { length: 100 }),
  locationCountry: varchar("location_country", { length: 100 }),
  relationshipStatus: varchar("relationship_status", { length: 50 }),
  hasChildren: varchar("has_children", { length: 50 }),
  primaryGoal: text("primary_goal"),
  goalTimeline: varchar("goal_timeline", { length: 100 }),
  motivation: text("motivation"),
  currentIdentity: text("current_identity"),
  targetIdentity: text("target_identity"),
  identityGap: text("identity_gap"),
  coreValues: text("core_values"),
  lifeMission: text("life_mission"),
  procrastinationTriggers: text("procrastination_triggers"),
  energyPattern: varchar("energy_pattern", { length: 50 }),
  stressResponses: text("stress_responses"),
  sleepHours: numeric("sleep_hours"),
  exerciseFrequency: varchar("exercise_frequency", { length: 50 }),
  dietPattern: varchar("diet_pattern", { length: 100 }),
  mentalHealthNotes: text("mental_health_notes"),
  savingsLevel: varchar("savings_level", { length: 50 }),
  hasDebt: varchar("has_debt", { length: 50 }),
  monthlyExpensesEstimate: integer("monthly_expenses_estimate"),
  preferredContact: varchar("preferred_contact", { length: 50 }),
  bestTimeToReach: varchar("best_time_to_reach", { length: 50 }),
  communicationStyle: varchar("communication_style", { length: 50 }),
  suicideRiskLevel: varchar("suicide_risk_level", { length: 20 }),
  crisisFlags: text("crisis_flags"),
  lastCrisisCheck: timestamp("last_crisis_check"),
  profileCompleteness: integer("profile_completeness").default(0),
  confidenceScores: text("confidence_scores"),
  lastProfileUpdate: timestamp("last_profile_update"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
  userId: integer("user_id"),
});

export const coachFeedback = pgTable("coachFeedback", {
  id: integer("id").primaryKey().notNull(),
  coachId: integer("coach_id").notNull(),
  sessionId: integer("session_id"),
  suggestionType: varchar("suggestion_type", { length: 100 }).notNull(),
  suggestionContent: text("suggestion_content").notNull(),
  feedbackType: varchar("feedback_type", { length: 50 }),
  rating: integer("rating"),
  notes: text("notes"),
  wasUsed: varchar("was_used", { length: 50 }),
  outcome: text("outcome"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const coachGuidance = pgTable("coachGuidance", {
  id: integer("id").primaryKey().notNull(),
  sessionId: integer("session_id").notNull(),
  guidanceType: varchar("guidance_type", { length: 50 }),
  priority: varchar("priority", { length: 50 }),
  message: text("message").notNull(),
  context: text("context"),
  timestamp: timestamp("timestamp").notNull(),
  wasFollowed: varchar("was_followed", { length: 50 }),
});

export const coachNotifications = pgTable("coachNotifications", {
  id: integer("id").primaryKey().notNull(),
  coachId: integer("coach_id").notNull(),
  notificationType: varchar("notification_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  message: text("message").notNull(),
  priority: varchar("priority", { length: 50 }),
  relatedId: integer("related_id"),
  isRead: varchar("is_read", { length: 50 }),
  readAt: timestamp("read_at"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const coachPrivateNotes = pgTable("coachPrivateNotes", {
  id: integer("id").primaryKey().notNull(),
  sessionId: integer("session_id").notNull(),
  coachId: integer("coach_id").notNull(),
  notes: text("notes").notNull(),
  aiPromptsReceived: text("ai_prompts_received"),
  supervisionQuestions: text("supervision_questions"),
  clinicalObservations: text("clinical_observations"),
  reminders: text("reminders"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const coachAvailability = pgTable("coach_availability", {
  id: integer("id").primaryKey().notNull(),
  coachId: integer("coach_id").notNull(),
  dayOfWeek: integer("day_of_week").notNull(),
  startTime: varchar("start_time", { length: 5 }).notNull(),
  endTime: varchar("end_time", { length: 5 }).notNull(),
  isActive: boolean("is_active").default(true).notNull(),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const coachAvailabilitySlots = pgTable("coach_availability_slots", {
  id: integer("id").primaryKey().notNull(),
  coachId: integer("coach_id").notNull(),
  dayOfWeek: integer("day_of_week").notNull(),
  startTime: varchar("start_time", { length: 5 }).notNull(),
  endTime: varchar("end_time", { length: 5 }).notNull(),
  isActive: boolean("is_active").default(true).notNull(),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const coaches = pgTable("coaches", {
  id: integer("id").primaryKey().notNull(),
  userId: integer("user_id").notNull(),
  specialization: text("specialization"),
  bio: text("bio"),
  certifications: text("certifications"),
  yearsExperience: integer("years_experience"),
  isActive: varchar("is_active", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const coachingConversations = pgTable("coaching_conversations", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  conversationTitle: varchar("conversation_title", { length: 255 }),
  conversationType: varchar("conversation_type", { length: 50 }),
  status: varchar("status", { length: 50 }),
  insightsGenerated: integer("insights_generated").default(0),
  actionsIdentified: integer("actions_identified").default(0),
  helpfulnessRating: integer("helpfulness_rating"),
  startedAt: timestamp("started_at").defaultNow(),
  completedAt: timestamp("completed_at"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const coachingEffectiveness = pgTable("coaching_effectiveness", {
  id: varchar("id", { length: 255 }).notNull(),
  elementType: varchar("element_type", { length: 100 }).notNull(),
  elementValue: varchar("element_value", { length: 255 }).notNull(),
  avgEngagementRate: numeric("avg_engagement_rate"),
  avgInsightRate: numeric("avg_insight_rate"),
  avgActionRate: numeric("avg_action_rate"),
  avgHelpfulnessRating: numeric("avg_helpfulness_rating"),
  avgBehaviorChange: numeric("avg_behavior_change"),
  optimalContext: text("optimal_context"),
  optimalUserType: text("optimal_user_type"),
  userCount: integer("user_count"),
  totalUses: integer("total_uses"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const coachingGoals = pgTable("coaching_goals", {
  id: varchar("id", { length: 255 }).notNull(),
  conversationId: varchar("conversation_id", { length: 255 }),
  goalId: varchar("goal_id", { length: 255 }),
  userId: varchar("user_id", { length: 255 }).notNull(),
  initialClarity: integer("initial_clarity"),
  finalClarity: integer("final_clarity"),
  aiContribution: text("ai_contribution"),
  obstaclesIdentified: text("obstacles_identified"),
  strategiesDeveloped: text("strategies_developed"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const coachingInsights = pgTable("coaching_insights", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  insightType: varchar("insight_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  evidence: text("evidence"),
  actionable: boolean("actionable").default(false),
  suggestedAction: text("suggested_action"),
  viewed: boolean("viewed").default(false),
  viewedAt: timestamp("viewed_at"),
  resonated: boolean("resonated"),
  actionTaken: boolean("action_taken").default(false),
  createdAt: timestamp("created_at").defaultNow(),
});

export const coachingQuestions = pgTable("coaching_questions", {
  id: varchar("id", { length: 255 }).notNull(),
  questionText: text("question_text").notNull(),
  questionType: varchar("question_type", { length: 50 }),
  category: varchar("category", { length: 100 }),
  bestFor: text("best_for"),
  researchBacked: boolean("research_backed").default(false),
  researchSource: text("research_source"),
  avgInsightRate: numeric("avg_insight_rate"),
  avgActionRate: numeric("avg_action_rate"),
  avgHelpfulnessRating: numeric("avg_helpfulness_rating"),
  totalUses: integer("total_uses").default(0),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const coachingResources = pgTable("coaching_resources", {
  id: varchar("id", { length: 255 }).notNull(),
  resourceName: varchar("resource_name", { length: 255 }).notNull(),
  description: text("description"),
  resourceType: varchar("resource_type", { length: 50 }),
  url: varchar("url", { length: 500 }),
  category: varchar("category", { length: 100 }),
  researchBacked: boolean("research_backed").default(false),
  recommendFor: text("recommend_for"),
  avgHelpfulnessRating: numeric("avg_helpfulness_rating"),
  totalRecommendations: integer("total_recommendations").default(0),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const cognitivePerformance = pgTable("cognitive_performance", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  assessmentDate: timestamp("assessment_date").notNull(),
  mentalClarity: integer("mental_clarity"),
  focusAbility: integer("focus_ability"),
  memorySharpness: integer("memory_sharpness"),
  processingSpeed: integer("processing_speed"),
  decisionQuality: integer("decision_quality"),
  creativity: integer("creativity"),
  brainFog: integer("brain_fog"),
  mentalFatigue: integer("mental_fatigue"),
  sleepQuality: integer("sleep_quality"),
  sleepHours: numeric("sleep_hours"),
  exerciseToday: boolean("exercise_today"),
  stressLevel: integer("stress_level"),
  hydration: varchar("hydration", { length: 50 }),
  nutrition: varchar("nutrition", { length: 50 }),
  caffeineIntake: integer("caffeine_intake"),
  alcoholYesterday: boolean("alcohol_yesterday"),
  notes: text("notes"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const communicationLogs = pgTable("communication_logs", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  logDate: timestamp("log_date").notNull(),
  conversationType: varchar("conversation_type", { length: 50 }),
  topic: varchar("topic", { length: 255 }).notNull(),
  context: text("context"),
  emotionBefore: varchar("emotion_before", { length: 255 }),
  intensityBefore: integer("intensity_before"),
  usedSoftStartup: boolean("used_soft_startup"),
  expressedNeeds: boolean("expressed_needs"),
  listenedActively: boolean("listened_actively"),
  validatedPartner: boolean("validated_partner"),
  foundCompromise: boolean("found_compromise"),
  usedCriticism: boolean("used_criticism"),
  usedContempt: boolean("used_contempt"),
  usedDefensiveness: boolean("used_defensiveness"),
  usedStonewalling: boolean("used_stonewalling"),
  outcome: varchar("outcome", { length: 50 }),
  emotionAfter: varchar("emotion_after", { length: 255 }),
  intensityAfter: integer("intensity_after"),
  whatWorked: text("what_worked"),
  whatToImprove: text("what_to_improve"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const communities = pgTable("communities", {
  id: varchar("id", { length: 255 }).notNull(),
  name: varchar("name", { length: 255 }).notNull(),
  description: text("description"),
  coverImage: varchar("cover_image", { length: 500 }),
  communityType: varchar("community_type", { length: 50 }),
  privacy: varchar("privacy", { length: 50 }),
  moderatorIds: text("moderator_ids"),
  guidelines: text("guidelines"),
  memberCount: integer("member_count").default(0),
  activeMembers: integer("active_members").default(0),
  totalPosts: integer("total_posts").default(0),
  active: boolean("active").default(true),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const communityAnalytics = pgTable("community_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  supportType: varchar("support_type", { length: 100 }).notNull(),
  avgUserRetention: numeric("avg_user_retention"),
  avgGoalAchievement: numeric("avg_goal_achievement"),
  avgSatisfaction: numeric("avg_satisfaction"),
  optimalCheckInFrequency: varchar("optimal_check_in_frequency", { length: 50 }),
  optimalGroupSize: integer("optimal_group_size"),
  mostEffectiveFor: text("most_effective_for"),
  userCount: integer("user_count"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const communityChallenges = pgTable("community_challenges", {
  id: varchar("id", { length: 255 }).notNull(),
  communityId: varchar("community_id", { length: 255 }),
  challengeName: varchar("challenge_name", { length: 255 }).notNull(),
  description: text("description"),
  challengeType: varchar("challenge_type", { length: 50 }),
  startDate: timestamp("start_date"),
  endDate: timestamp("end_date"),
  duration: integer("duration"),
  participantCount: integer("participant_count").default(0),
  status: varchar("status", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const communityComments = pgTable("community_comments", {
  id: varchar("id", { length: 255 }).notNull(),
  postId: varchar("post_id", { length: 255 }).notNull(),
  authorId: varchar("author_id", { length: 255 }).notNull(),
  content: text("content").notNull(),
  likesCount: integer("likes_count").default(0),
  flagged: boolean("flagged").default(false),
  visible: boolean("visible").default(true),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const communityDailyCheckIns = pgTable("community_daily_check_ins", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  checkInDate: timestamp("check_in_date").notNull(),
  mood: varchar("mood", { length: 100 }),
  energy: integer("energy"),
  todayGoals: text("today_goals"),
  gratefulFor: text("grateful_for"),
  strugglingWith: text("struggling_with"),
  needSupport: boolean("need_support").default(false),
  winsToday: text("wins_today"),
  shareWithCommunity: boolean("share_with_community").default(true),
  supportsReceived: integer("supports_received").default(0),
  commentsReceived: integer("comments_received").default(0),
  createdAt: timestamp("created_at").defaultNow(),
});

export const communityMemberships = pgTable("community_memberships", {
  id: varchar("id", { length: 255 }).notNull(),
  communityId: varchar("community_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  role: varchar("role", { length: 50 }),
  lastActiveAt: timestamp("last_active_at"),
  postsCount: integer("posts_count").default(0),
  commentsCount: integer("comments_count").default(0),
  notificationsEnabled: boolean("notifications_enabled").default(true),
  joinedAt: timestamp("joined_at").defaultNow(),
});

export const communityPosts = pgTable("community_posts", {
  id: varchar("id", { length: 255 }).notNull(),
  communityId: varchar("community_id", { length: 255 }).notNull(),
  authorId: varchar("author_id", { length: 255 }).notNull(),
  postType: varchar("post_type", { length: 50 }),
  title: varchar("title", { length: 255 }),
  content: text("content").notNull(),
  images: text("images"),
  tags: text("tags"),
  likesCount: integer("likes_count").default(0),
  commentsCount: integer("comments_count").default(0),
  supportsCount: integer("supports_count").default(0),
  flagged: boolean("flagged").default(false),
  flagReason: text("flag_reason"),
  visible: boolean("visible").default(true),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const communityProfiles = pgTable("community_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  displayName: varchar("display_name", { length: 100 }).notNull(),
  bio: text("bio"),
  profilePhoto: varchar("profile_photo", { length: 500 }),
  shareProgress: boolean("share_progress").default(true),
  shareStruggles: boolean("share_struggles").default(true),
  shareWins: boolean("share_wins").default(true),
  primaryChallenges: text("primary_challenges"),
  primaryGoals: text("primary_goals"),
  role: varchar("role", { length: 50 }),
  availableAsMentor: boolean("available_as_mentor").default(false),
  mentorshipAreas: text("mentorship_areas"),
  totalPosts: integer("total_posts").default(0),
  totalComments: integer("total_comments").default(0),
  totalSupportsGiven: integer("total_supports_given").default(0),
  totalSupportsReceived: integer("total_supports_received").default(0),
  helpfulnessScore: integer("helpfulness_score").default(0),
  active: boolean("active").default(true),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const comparativeAnalytics = pgTable("comparative_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  comparisonType: varchar("comparison_type", { length: 50 }),
  metric: varchar("metric", { length: 255 }).notNull(),
  currentValue: numeric("current_value"),
  comparisonValue: numeric("comparison_value"),
  absoluteChange: numeric("absolute_change"),
  percentChange: numeric("percent_change"),
  trend: varchar("trend", { length: 50 }),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
});

export const comparisonViews = pgTable("comparison_views", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  comparisonType: varchar("comparison_type", { length: 50 }),
  metric: varchar("metric", { length: 255 }).notNull(),
  currentPeriodStart: timestamp("current_period_start").notNull(),
  currentPeriodEnd: timestamp("current_period_end").notNull(),
  currentValue: numeric("current_value"),
  comparisonPeriodStart: timestamp("comparison_period_start").notNull(),
  comparisonPeriodEnd: timestamp("comparison_period_end").notNull(),
  comparisonValue: numeric("comparison_value"),
  absoluteChange: numeric("absolute_change"),
  percentChange: numeric("percent_change"),
  interpretation: varchar("interpretation", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
});

export const compassionPractices = pgTable("compassion_practices", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  practiceDate: timestamp("practice_date").notNull(),
  practiceType: varchar("practice_type", { length: 50 }),
  duration: integer("duration"),
  target: varchar("target", { length: 255 }),
  emotionBefore: varchar("emotion_before", { length: 255 }),
  emotionAfter: varchar("emotion_after", { length: 255 }),
  warmthLevel: integer("warmth_level"),
  resistanceLevel: integer("resistance_level"),
  insights: text("insights"),
  actionTaken: text("action_taken"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const complianceFlags = pgTable("complianceFlags", {
  id: integer("id").primaryKey().notNull(),
  conversationId: integer("conversation_id").notNull(),
  messageId: integer("message_id").notNull(),
  flagType: varchar("flag_type", { length: 50 }),
  severity: varchar("severity", { length: 50 }),
  flaggedContent: text("flagged_content").notNull(),
  aiResponse: text("ai_response"),
  reviewStatus: varchar("review_status", { length: 50 }),
  reviewedBy: integer("reviewed_by"),
  reviewNotes: text("review_notes"),
  reviewedAt: timestamp("reviewed_at"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const complianceCheckpoints = pgTable("compliance_checkpoints", {
  id: varchar("id", { length: 255 }).notNull(),
  checkpointName: varchar("checkpoint_name", { length: 255 }).notNull(),
  complianceFramework: varchar("compliance_framework", { length: 50 }),
  requirement: text("requirement").notNull(),
  validationCriteria: text("validation_criteria"),
  mandatory: boolean("mandatory").default(true),
  violationSeverity: varchar("violation_severity", { length: 50 }),
  violationAction: text("violation_action"),
  legalReference: text("legal_reference"),
  documentationRequired: text("documentation_required"),
  lastAuditDate: timestamp("last_audit_date"),
  nextAuditDate: timestamp("next_audit_date"),
  auditFrequency: varchar("audit_frequency", { length: 50 }),
  active: boolean("active").default(true),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const complianceReports = pgTable("compliance_reports", {
  id: varchar("id", { length: 255 }).notNull(),
  reportType: varchar("report_type", { length: 50 }),
  reportPeriodStart: timestamp("report_period_start").notNull(),
  reportPeriodEnd: timestamp("report_period_end").notNull(),
  status: varchar("status", { length: 50 }),
  findings: text("findings"),
  filePath: varchar("file_path", { length: 500 }),
  generatedBy: varchar("generated_by", { length: 255 }),
  generatedAt: timestamp("generated_at").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
});

export const connectionBids = pgTable("connection_bids", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  bidDate: timestamp("bid_date").notNull(),
  bidType: varchar("bid_type", { length: 50 }),
  bidDescription: text("bid_description"),
  response: varchar("response", { length: 50 }),
  responseDescription: text("response_description"),
  emotionalImpact: integer("emotional_impact"),
  connectionStrength: integer("connection_strength"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const consentRecords = pgTable("consent_records", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  consentType: varchar("consent_type", { length: 50 }),
  consented: boolean("consented").notNull(),
  policyVersion: varchar("policy_version", { length: 50 }),
  ipAddress: varchar("ip_address", { length: 50 }),
  userAgent: text("user_agent"),
  consentedAt: timestamp("consented_at").defaultNow(),
});

export const contentModerationLogs = pgTable("content_moderation_logs", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }),
  sessionId: varchar("session_id", { length: 255 }),
  originalContent: text("original_content").notNull(),
  contentHash: varchar("content_hash", { length: 255 }),
  detectedViolations: text("detected_violations"),
  matchedRules: text("matched_rules"),
  riskScore: integer("risk_score"),
  riskCategory: varchar("risk_category", { length: 100 }),
  severityLevel: varchar("severity_level", { length: 50 }),
  actionTaken: varchar("action_taken", { length: 50 }),
  userResponse: text("user_response"),
  conversationContext: text("conversation_context"),
  userIntent: text("user_intent"),
  requiresHumanReview: boolean("requires_human_review").default(false),
  reviewedBy: varchar("reviewed_by", { length: 255 }),
  reviewedAt: timestamp("reviewed_at"),
  reviewDecision: varchar("review_decision", { length: 50 }),
  reviewNotes: text("review_notes"),
  feedbackProvided: boolean("feedback_provided").default(false),
  improvedAccuracy: boolean("improved_accuracy").default(false),
  detectedAt: timestamp("detected_at").defaultNow(),
});

export const conversation = pgTable("conversation", {
  id: varchar("id", { length: 255 }).notNull(),
  clientProfileId: varchar("client_profile_id", { length: 255 }),
  userId: varchar("user_id", { length: 255 }),
  channel: varchar("channel", { length: 50 }).notNull(),
  mood: varchar("mood", { length: 50 }),
  topic: varchar("topic", { length: 255 }),
  sentiment: varchar("sentiment", { length: 50 }),
  crisisDetected: boolean("crisis_detected").default(false).notNull(),
  crisisLevel: varchar("crisis_level", { length: 50 }),
  messageCount: integer("message_count").default(0).notNull(),
  duration: integer("duration"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
  endedAt: timestamp("ended_at"),
});

export const conversationMessages = pgTable("conversation_messages", {
  id: varchar("id", { length: 255 }).notNull(),
  conversationId: varchar("conversation_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  sender: varchar("sender", { length: 50 }),
  messageText: text("message_text").notNull(),
  messageType: varchar("message_type", { length: 50 }),
  coachingTechnique: varchar("coaching_technique", { length: 50 }),
  contextData: text("context_data"),
  userEngaged: boolean("user_engaged"),
  userInsight: boolean("user_insight"),
  userAction: boolean("user_action"),
  sentAt: timestamp("sent_at").defaultNow(),
});

export const copingStrategies = pgTable("copingStrategies", {
  id: integer("id").primaryKey().notNull(),
  clientId: integer("client_id").notNull(),
  strategyName: varchar("strategy_name", { length: 255 }).notNull(),
  description: text("description"),
  category: varchar("category", { length: 100 }),
  timesUsed: integer("times_used").default(0).notNull(),
  averageEffectiveness: integer("average_effectiveness"),
  lastUsed: timestamp("last_used"),
  isRecommended: varchar("is_recommended", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const correlations = pgTable("correlations", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  variable1: varchar("variable1", { length: 255 }).notNull(),
  variable2: varchar("variable2", { length: 255 }).notNull(),
  correlationCoefficient: numeric("correlation_coefficient"),
  pValue: numeric("p_value"),
  relationship: varchar("relationship", { length: 50 }),
  insight: text("insight"),
  actionable: boolean("actionable").default(false),
  dataPoints: integer("data_points"),
  confidenceLevel: numeric("confidence_level"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const crisisInterventionLogs = pgTable("crisis_intervention_logs", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  crisisType: varchar("crisis_type", { length: 50 }),
  detectedContent: text("detected_content"),
  crisisIndicators: text("crisis_indicators"),
  riskLevel: varchar("risk_level", { length: 50 }),
  responseProvided: text("response_provided"),
  resourcesOffered: text("resources_offered"),
  escalated: boolean("escalated").default(false),
  escalatedTo: varchar("escalated_to", { length: 255 }),
  escalatedAt: timestamp("escalated_at"),
  followUpRequired: boolean("follow_up_required").default(true),
  followUpCompleted: boolean("follow_up_completed").default(false),
  followUpNotes: text("follow_up_notes"),
  outcome: varchar("outcome", { length: 50 }),
  detectedAt: timestamp("detected_at").defaultNow(),
  resolvedAt: timestamp("resolved_at"),
});

export const crisisLog = pgTable("crisis_log", {
  id: varchar("id", { length: 255 }).notNull(),
  clientProfileId: varchar("client_profile_id", { length: 255 }).notNull(),
  conversationId: varchar("conversation_id", { length: 255 }),
  crisisLevel: varchar("crisis_level", { length: 50 }).notNull(),
  indicators: json("indicators"),
  transcript: text("transcript"),
  escalated: boolean("escalated").default(false).notNull(),
  escalatedTo: varchar("escalated_to", { length: 255 }),
  escalationTime: timestamp("escalation_time"),
  resolved: boolean("resolved").default(false).notNull(),
  resolution: text("resolution"),
  resolvedAt: timestamp("resolved_at"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const customReports = pgTable("custom_reports", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  reportName: varchar("report_name", { length: 255 }).notNull(),
  description: text("description"),
  reportType: varchar("report_type", { length: 50 }),
  metrics: text("metrics"),
  timeRange: text("time_range"),
  visualizations: text("visualizations"),
  scheduled: boolean("scheduled").default(false),
  scheduleFrequency: varchar("schedule_frequency", { length: 50 }),
  exportFormat: varchar("export_format", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const dailyCheckins = pgTable("dailyCheckins", {
  id: integer("id").primaryKey().notNull(),
  clientId: integer("client_id").notNull(),
  checkinDate: timestamp("checkin_date").defaultNow().notNull(),
  sleptWell: varchar("slept_well", { length: 50 }),
  ateWell: varchar("ate_well", { length: 50 }),
  movedBody: varchar("moved_body", { length: 50 }),
  emotionalState: integer("emotional_state").notNull(),
  followedPlan: varchar("followed_plan", { length: 50 }),
  controlledImpulses: varchar("controlled_impulses", { length: 50 }),
  actedLikeTargetIdentity: varchar("acted_like_target_identity", { length: 50 }),
  notes: text("notes"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const dailyAffirmations = pgTable("daily_affirmations", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  affirmationDate: timestamp("affirmation_date").notNull(),
  affirmations: text("affirmations"),
  practiceMethod: varchar("practice_method", { length: 50 }),
  repetitions: integer("repetitions"),
  beliefLevel: integer("belief_level"),
  impactOnMood: integer("impact_on_mood"),
  impactOnBehavior: integer("impact_on_behavior"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const dailyCheckIns = pgTable("daily_check_ins", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  type: varchar("type", { length: 20 }).notNull(),
  gratitude: text("gratitude"),
  intention: text("intention"),
  reflection: text("reflection"),
  wins: text("wins"),
  lessons: text("lessons"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const dailyHealthMetrics = pgTable("daily_health_metrics", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  metricDate: timestamp("metric_date").notNull(),
  restingHeartRate: integer("resting_heart_rate"),
  hrv: integer("hrv"),
  bloodPressureSystolic: integer("blood_pressure_systolic"),
  bloodPressureDiastolic: integer("blood_pressure_diastolic"),
  oxygenSaturation: integer("oxygen_saturation"),
  bodyTemperature: numeric("body_temperature"),
  weight: numeric("weight"),
  bodyFat: numeric("body_fat"),
  sleepDuration: numeric("sleep_duration"),
  sleepQuality: integer("sleep_quality"),
  deepSleepMinutes: integer("deep_sleep_minutes"),
  remSleepMinutes: integer("rem_sleep_minutes"),
  energyLevel: integer("energy_level"),
  mentalClarity: integer("mental_clarity"),
  physicalPerformance: integer("physical_performance"),
  stressLevel: integer("stress_level"),
  recoveryScore: integer("recovery_score"),
  symptoms: text("symptoms"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const dailyNutritionSummary = pgTable("daily_nutrition_summary", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  summaryDate: timestamp("summary_date").notNull(),
  totalCalories: integer("total_calories"),
  totalProtein: numeric("total_protein"),
  totalCarbs: numeric("total_carbs"),
  totalFat: numeric("total_fat"),
  totalFiber: numeric("total_fiber"),
  waterIntake: numeric("water_intake"),
  calorieAdherence: integer("calorie_adherence"),
  proteinAdherence: integer("protein_adherence"),
  vegetableServings: integer("vegetable_servings"),
  fruitServings: integer("fruit_servings"),
  processedFoodServings: integer("processed_food_servings"),
  nutritionQuality: integer("nutrition_quality"),
  adherenceRating: integer("adherence_rating"),
  avgEnergyLevel: integer("avg_energy_level"),
  sleepQuality: integer("sleep_quality"),
  workoutPerformance: integer("workout_performance"),
  bowelMovements: integer("bowel_movements"),
  digestiveComfort: integer("digestive_comfort"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const dailyReviews = pgTable("daily_reviews", {
  id: varchar("id", { length: 255 }).notNull(),
  journalEntryId: varchar("journal_entry_id", { length: 255 }),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  reviewDate: timestamp("review_date").notNull(),
  wentWell: text("went_well"),
  whyItWentWell: text("why_it_went_well"),
  didntGoWell: text("didnt_go_well"),
  whyItDidntGoWell: text("why_it_didnt_go_well"),
  lessonsLearned: text("lessons_learned"),
  tomorrowFocus: text("tomorrow_focus"),
  dayRating: integer("day_rating"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const dailyRewards = pgTable("daily_rewards", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  rewardDate: timestamp("reward_date").notNull(),
  consecutiveDays: integer("consecutive_days"),
  streakBonus: integer("streak_bonus"),
  tasksCompleted: integer("tasks_completed"),
  completionBonus: integer("completion_bonus"),
  totalExperiencePoints: integer("total_experience_points"),
  claimed: boolean("claimed").default(false),
  claimedAt: timestamp("claimed_at"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const dailySnapshots = pgTable("daily_snapshots", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  snapshotDate: timestamp("snapshot_date").notNull(),
  overallWellnessScore: integer("overall_wellness_score"),
  physicalScore: integer("physical_score"),
  mentalScore: integer("mental_score"),
  emotionalScore: integer("emotional_score"),
  spiritualScore: integer("spiritual_score"),
  habitsCompleted: integer("habits_completed"),
  habitsTotal: integer("habits_total"),
  habitCompletionRate: numeric("habit_completion_rate"),
  sleepDuration: numeric("sleep_duration"),
  sleepQuality: integer("sleep_quality"),
  avgMood: integer("avg_mood"),
  avgEnergy: integer("avg_energy"),
  productivityScore: integer("productivity_score"),
  stressLevel: integer("stress_level"),
  recoveryScore: integer("recovery_score"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const dailyStressLogs = pgTable("daily_stress_logs", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  logDate: timestamp("log_date").notNull(),
  avgStressLevel: integer("avg_stress_level"),
  peakStressLevel: integer("peak_stress_level"),
  morningHrv: numeric("morning_hrv"),
  avgHrv: numeric("avg_hrv"),
  hrvTrend: varchar("hrv_trend", { length: 50 }),
  avgRestingHr: integer("avg_resting_hr"),
  peakHr: integer("peak_hr"),
  morningCortisol: varchar("morning_cortisol", { length: 50 }),
  eveningCortisol: varchar("evening_cortisol", { length: 50 }),
  cortisolRhythm: varchar("cortisol_rhythm", { length: 50 }),
  symptoms: text("symptoms"),
  symptomSeverity: integer("symptom_severity"),
  sleepQuality: integer("sleep_quality"),
  sleepDuration: numeric("sleep_duration"),
  irritability: integer("irritability"),
  concentration: integer("concentration"),
  appetite: varchar("appetite", { length: 50 }),
  interventionsUsed: text("interventions_used"),
  interventionEffectiveness: integer("intervention_effectiveness"),
  recoveryQuality: integer("recovery_quality"),
  notes: text("notes"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const dashboardConfigurations = pgTable("dashboard_configurations", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  dashboardName: varchar("dashboard_name", { length: 255 }).notNull(),
  description: text("description"),
  layout: text("layout"),
  widgets: text("widgets"),
  isDefault: boolean("is_default").default(false),
  isPublic: boolean("is_public").default(false),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const dataAccessLogs = pgTable("data_access_logs", {
  id: varchar("id", { length: 255 }).notNull(),
  accessedBy: varchar("accessed_by", { length: 255 }).notNull(),
  accessedByType: varchar("accessed_by_type", { length: 50 }),
  dataType: varchar("data_type", { length: 100 }).notNull(),
  dataId: varchar("data_id", { length: 255 }),
  dataOwnerId: varchar("data_owner_id", { length: 255 }),
  accessMethod: varchar("access_method", { length: 100 }),
  purpose: varchar("purpose", { length: 255 }),
  ipAddress: varchar("ip_address", { length: 50 }),
  accessedAt: timestamp("accessed_at").defaultNow(),
});

export const dataMappingRules = pgTable("data_mapping_rules", {
  id: varchar("id", { length: 255 }).notNull(),
  integrationId: varchar("integration_id", { length: 255 }).notNull(),
  sourceField: varchar("source_field", { length: 255 }).notNull(),
  sourceDataType: varchar("source_data_type", { length: 100 }),
  destinationTable: varchar("destination_table", { length: 255 }).notNull(),
  destinationField: varchar("destination_field", { length: 255 }).notNull(),
  transformationRule: text("transformation_rule"),
  validationRule: text("validation_rule"),
  required: boolean("required").default(false),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const dataSettings = pgTable("data_settings", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  autoBackupEnabled: boolean("auto_backup_enabled").default(true),
  backupFrequency: varchar("backup_frequency", { length: 50 }),
  lastBackupAt: timestamp("last_backup_at"),
  dataRetentionPeriod: varchar("data_retention_period", { length: 50 }),
  exportFormat: varchar("export_format", { length: 50 }),
  storageUsed: integer("storage_used").default(0),
  storageLimit: integer("storage_limit").default(1073741824),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const dbtSkillsPractice = pgTable("dbt_skills_practice", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  practiceDate: timestamp("practice_date").notNull(),
  dbtModule: varchar("dbt_module", { length: 50 }),
  skillUsed: varchar("skill_used", { length: 50 }).notNull(),
  situation: text("situation"),
  emotionBefore: varchar("emotion_before", { length: 100 }),
  intensityBefore: integer("intensity_before"),
  howUsed: text("how_used"),
  emotionAfter: varchar("emotion_after", { length: 100 }),
  intensityAfter: integer("intensity_after"),
  effectiveness: integer("effectiveness"),
  wouldUseAgain: boolean("would_use_again"),
  challenges: text("challenges"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const debtAccounts = pgTable("debt_accounts", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  debtType: varchar("debt_type", { length: 50 }),
  creditorName: varchar("creditor_name", { length: 255 }).notNull(),
  originalBalance: numeric("original_balance").notNull(),
  currentBalance: numeric("current_balance").notNull(),
  interestRate: numeric("interest_rate"),
  minimumPayment: numeric("minimum_payment"),
  payoffMethod: varchar("payoff_method", { length: 50 }),
  payoffPriority: integer("payoff_priority"),
  lastPaymentDate: timestamp("last_payment_date"),
  lastPaymentAmount: numeric("last_payment_amount"),
  projectedPayoffDate: timestamp("projected_payoff_date"),
  totalInterestPaid: numeric("total_interest_paid"),
  status: varchar("status", { length: 50 }),
  paidOffDate: timestamp("paid_off_date"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const debtPayments = pgTable("debt_payments", {
  id: varchar("id", { length: 255 }).notNull(),
  debtAccountId: varchar("debt_account_id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  paymentDate: timestamp("payment_date").notNull(),
  paymentAmount: numeric("payment_amount").notNull(),
  principalPaid: numeric("principal_paid"),
  interestPaid: numeric("interest_paid"),
  balanceAfterPayment: numeric("balance_after_payment"),
  emotionalImpact: integer("emotional_impact"),
  motivationBoost: integer("motivation_boost"),
  notes: text("notes"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const developmentalAssets = pgTable("developmental_assets", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  familySupport: integer("family_support"),
  positiveFamilyCommunication: integer("positive_family_communication"),
  otherAdultRelationships: integer("other_adult_relationships"),
  caringNeighborhood: integer("caring_neighborhood"),
  communityValuesYouth: integer("community_values_youth"),
  youthAsResources: integer("youth_as_resources"),
  serviceToOthers: integer("service_to_others"),
  safety: integer("safety"),
  familyBoundaries: integer("family_boundaries"),
  schoolBoundaries: integer("school_boundaries"),
  neighborhoodBoundaries: integer("neighborhood_boundaries"),
  adultRoleModels: integer("adult_role_models"),
  positivePeerInfluence: integer("positive_peer_influence"),
  highExpectations: integer("high_expectations"),
  creativeActivities: integer("creative_activities"),
  youthPrograms: integer("youth_programs"),
  religiousCommunity: integer("religious_community"),
  timeAtHome: integer("time_at_home"),
  achievementMotivation: integer("achievement_motivation"),
  schoolEngagement: integer("school_engagement"),
  homework: integer("homework"),
  bondingToSchool: integer("bonding_to_school"),
  readingForPleasure: integer("reading_for_pleasure"),
  caring: integer("caring"),
  equality: integer("equality"),
  socialJustice: integer("social_justice"),
  integrity: integer("integrity"),
  honesty: integer("honesty"),
  responsibility: integer("responsibility"),
  restraint: integer("restraint"),
  planningDecisionMaking: integer("planning_decision_making"),
  interpersonalCompetence: integer("interpersonal_competence"),
  culturalCompetence: integer("cultural_competence"),
  resistanceSkills: integer("resistance_skills"),
  peacefulConflictResolution: integer("peaceful_conflict_resolution"),
  personalPower: integer("personal_power"),
  selfEsteem: integer("self_esteem"),
  senseOfPurpose: integer("sense_of_purpose"),
  positiveViewOfFuture: integer("positive_view_of_future"),
  totalAssets: integer("total_assets"),
  assessmentDate: timestamp("assessment_date").notNull(),
  createdAt: timestamp("created_at").defaultNow(),
});

export const dietaryInterventions = pgTable("dietaryInterventions", {
  id: integer("id").primaryKey().notNull(),
  profileId: integer("profile_id").notNull(),
  dietType: varchar("diet_type", { length: 50 }),
  startDate: timestamp("start_date").notNull(),
  endDate: timestamp("end_date"),
  adherence: integer("adherence"),
  giSymptomChanges: text("gi_symptom_changes"),
  behaviorChanges: text("behavior_changes"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const disciplineEvents = pgTable("disciplineEvents", {
  id: integer("id").primaryKey().notNull(),
  clientId: integer("client_id").notNull(),
  eventDate: timestamp("event_date").defaultNow().notNull(),
  eventType: varchar("event_type", { length: 50 }),
  situation: text("situation"),
  response: text("response"),
  outcome: text("outcome"),
  reinforcedIdentity: varchar("reinforced_identity", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const discountCodeUsage = pgTable("discountCodeUsage", {
  id: integer("id").primaryKey().notNull(),
  discountCodeId: integer("discount_code_id").notNull(),
  userId: integer("user_id"),
  sessionId: integer("session_id"),
  usedAt: timestamp("used_at").defaultNow().notNull(),
});

export const discountCodes = pgTable("discountCodes", {
  id: integer("id").primaryKey().notNull(),
  code: varchar("code", { length: 50 }).notNull(),
  discountPercent: integer("discount_percent").notNull(),
  discountAmount: integer("discount_amount"),
  maxUses: integer("max_uses"),
  usedCount: integer("used_count").default(0).notNull(),
  expiresAt: timestamp("expires_at"),
  isActive: varchar("is_active", { length: 50 }),
  createdBy: integer("created_by"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const emailLogs = pgTable("email_logs", {
  id: integer("id").primaryKey().notNull(),
  userId: integer("user_id").notNull(),
  emailType: varchar("email_type", { length: 50 }),
  sentAt: timestamp("sent_at").defaultNow().notNull(),
  subject: varchar("subject", { length: 255 }).notNull(),
  status: varchar("status", { length: 50 }),
  metadata: text("metadata"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const emailQueue = pgTable("email_queue", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  notificationId: varchar("notification_id", { length: 255 }),
  toEmail: varchar("to_email", { length: 255 }).notNull(),
  subject: varchar("subject", { length: 500 }).notNull(),
  body: text("body").notNull(),
  bodyHtml: text("body_html"),
  priority: varchar("priority", { length: 50 }),
  status: varchar("status", { length: 50 }),
  sentAt: timestamp("sent_at"),
  deliveredAt: timestamp("delivered_at"),
  opened: boolean("opened").default(false),
  openedAt: timestamp("opened_at"),
  clicked: boolean("clicked").default(false),
  clickedAt: timestamp("clicked_at"),
  errorMessage: text("error_message"),
  retryCount: integer("retry_count").default(0),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const emotionLogs = pgTable("emotionLogs", {
  id: integer("id").primaryKey().notNull(),
  clientId: integer("client_id").notNull(),
  journalEntryId: integer("journal_entry_id"),
  logDate: timestamp("log_date").defaultNow().notNull(),
  emotionType: varchar("emotion_type", { length: 100 }).notNull(),
  intensity: integer("intensity").notNull(),
  trigger: text("trigger"),
  physicalSensations: text("physical_sensations"),
  thoughts: text("thoughts"),
  behaviors: text("behaviors"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const emotionEntries = pgTable("emotion_entries", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  entryDate: timestamp("entry_date").notNull(),
  primaryEmotion: varchar("primary_emotion", { length: 100 }).notNull(),
  secondaryEmotions: text("secondary_emotions"),
  intensity: integer("intensity"),
  valence: integer("valence"),
  arousal: integer("arousal"),
  trigger: text("trigger"),
  situation: text("situation"),
  thoughts: text("thoughts"),
  physicalSensations: text("physical_sensations"),
  urge: text("urge"),
  actualBehavior: text("actual_behavior"),
  durationMinutes: integer("duration_minutes"),
  regulationUsed: boolean("regulation_used"),
  regulationStrategy: varchar("regulation_strategy", { length: 255 }),
  regulationEffectiveness: integer("regulation_effectiveness"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const emotionRegulationStrategies = pgTable("emotion_regulation_strategies", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  useDate: timestamp("use_date").notNull(),
  strategyType: varchar("strategy_type", { length: 50 }).notNull(),
  emotion: varchar("emotion", { length: 100 }).notNull(),
  intensityBefore: integer("intensity_before"),
  trigger: text("trigger"),
  whatYouDid: text("what_you_did"),
  duration: integer("duration"),
  intensityAfter: integer("intensity_after"),
  emotionChanged: boolean("emotion_changed"),
  newEmotion: varchar("new_emotion", { length: 100 }),
  immediateEffectiveness: integer("immediate_effectiveness"),
  longTermHelpful: boolean("long_term_helpful"),
  sideEffects: text("side_effects"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const emotionalEngineAnalytics = pgTable("emotional_engine_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  strategyType: varchar("strategy_type", { length: 100 }).notNull(),
  emotionType: varchar("emotion_type", { length: 100 }).notNull(),
  avgIntensityReduction: numeric("avg_intensity_reduction"),
  avgEffectivenessRating: numeric("avg_effectiveness_rating"),
  successRate: numeric("success_rate"),
  optimalDuration: integer("optimal_duration"),
  mostEffectiveFor: text("most_effective_for"),
  useCount: integer("use_count"),
  userCount: integer("user_count"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const emotionalPatterns = pgTable("emotional_patterns", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  patternType: varchar("pattern_type", { length: 50 }).notNull(),
  patternName: varchar("pattern_name", { length: 255 }).notNull(),
  description: text("description"),
  occurrenceCount: integer("occurrence_count").default(0),
  firstDetected: timestamp("first_detected"),
  lastDetected: timestamp("last_detected"),
  associatedEmotions: text("associated_emotions"),
  associatedTriggers: text("associated_triggers"),
  associatedContexts: text("associated_contexts"),
  insight: text("insight"),
  actionable: boolean("actionable").default(false),
  suggestedAction: text("suggested_action"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const emotionalProcessing = pgTable("emotional_processing", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  processingDate: timestamp("processing_date").notNull(),
  emotionToProcess: varchar("emotion_to_process", { length: 100 }).notNull(),
  relatedEvent: text("related_event"),
  processingMethod: varchar("processing_method", { length: 50 }),
  whatCameUp: text("what_came_up"),
  physicalSensations: text("physical_sensations"),
  processingDepth: varchar("processing_depth", { length: 50 }),
  feelingAfter: varchar("feeling_after", { length: 100 }),
  resolutionLevel: integer("resolution_level"),
  insights: text("insights"),
  actionSteps: text("action_steps"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const emotionalProfiles = pgTable("emotional_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  baselineEmotionalState: varchar("baseline_emotional_state", { length: 100 }),
  emotionalRange: varchar("emotional_range", { length: 50 }),
  emotionalIntensity: varchar("emotional_intensity", { length: 50 }),
  regulationSkillLevel: integer("regulation_skill_level"),
  awarenessLevel: integer("awareness_level"),
  primaryChallenges: text("primary_challenges"),
  primaryGoal: varchar("primary_goal", { length: 50 }),
  commonTriggers: text("common_triggers"),
  commonEmotions: text("common_emotions"),
  emotionalCycles: text("emotional_cycles"),
  mostEffectiveStrategies: text("most_effective_strategies"),
  leastEffectiveStrategies: text("least_effective_strategies"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const emotionalWins = pgTable("emotional_wins", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  winDate: timestamp("win_date").notNull(),
  winType: varchar("win_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  significance: text("significance"),
  howYouGrew: text("how_you_grew"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const encryptionKeys = pgTable("encryption_keys", {
  id: varchar("id", { length: 255 }).notNull(),
  keyId: varchar("key_id", { length: 255 }).notNull(),
  keyType: varchar("key_type", { length: 50 }),
  algorithm: varchar("algorithm", { length: 100 }).notNull(),
  active: boolean("active").default(true),
  rotationSchedule: varchar("rotation_schedule", { length: 50 }),
  lastRotatedAt: timestamp("last_rotated_at"),
  nextRotationAt: timestamp("next_rotation_at"),
  createdAt: timestamp("created_at").defaultNow(),
  retiredAt: timestamp("retired_at"),
});

export const escalationQueue = pgTable("escalationQueue", {
  id: integer("id").primaryKey().notNull(),
  conversationId: integer("conversation_id").notNull(),
  userId: integer("user_id").notNull(),
  clientId: integer("client_id"),
  escalationType: varchar("escalation_type", { length: 50 }),
  priority: varchar("priority", { length: 50 }),
  reason: text("reason").notNull(),
  context: text("context"),
  status: varchar("status", { length: 50 }),
  assignedTo: integer("assigned_to"),
  assignedAt: timestamp("assigned_at"),
  resolvedAt: timestamp("resolved_at"),
  resolutionNotes: text("resolution_notes"),
  notificationSent: varchar("notification_sent", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const exercises = pgTable("exercises", {
  id: varchar("id", { length: 255 }).notNull(),
  workoutId: varchar("workout_id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  exerciseName: varchar("exercise_name", { length: 255 }).notNull(),
  exerciseType: varchar("exercise_type", { length: 50 }),
  muscleGroup: varchar("muscle_group", { length: 255 }),
  sets: integer("sets"),
  reps: text("reps"),
  weight: text("weight"),
  restBetweenSets: integer("rest_between_sets"),
  tempo: varchar("tempo", { length: 50 }),
  rangeOfMotion: varchar("range_of_motion", { length: 50 }),
  formQuality: integer("form_quality"),
  difficulty: integer("difficulty"),
  progressionFromLast: varchar("progression_from_last", { length: 255 }),
  painDuring: boolean("pain_during"),
  painLocation: varchar("pain_location", { length: 255 }),
  painLevel: integer("pain_level"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const expenses = pgTable("expenses", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  expenseDate: timestamp("expense_date").notNull(),
  amount: numeric("amount").notNull(),
  categoryId: varchar("category_id", { length: 255 }),
  categoryName: varchar("category_name", { length: 255 }).notNull(),
  description: varchar("description", { length: 255 }),
  merchant: varchar("merchant", { length: 255 }),
  wasPlanned: boolean("was_planned"),
  wasNecessary: boolean("was_necessary"),
  wasImpulse: boolean("was_impulse"),
  emotionalState: varchar("emotional_state", { length: 100 }),
  trigger: varchar("trigger", { length: 255 }),
  satisfactionLevel: integer("satisfaction_level"),
  regretLevel: integer("regret_level"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const experiencePointsLog = pgTable("experience_points_log", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  source: varchar("source", { length: 50 }),
  sourceId: varchar("source_id", { length: 255 }),
  pointsEarned: integer("points_earned").notNull(),
  description: varchar("description", { length: 255 }),
  earnedAt: timestamp("earned_at").defaultNow(),
});

export const exportRequests = pgTable("export_requests", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  exportType: varchar("export_type", { length: 50 }),
  exportFormat: varchar("export_format", { length: 50 }),
  filters: text("filters"),
  status: varchar("status", { length: 50 }),
  filePath: varchar("file_path", { length: 500 }),
  fileSize: integer("file_size"),
  downloadUrl: varchar("download_url", { length: 500 }),
  expiresAt: timestamp("expires_at"),
  errorMessage: text("error_message"),
  requestedAt: timestamp("requested_at").defaultNow(),
  completedAt: timestamp("completed_at"),
});

export const exportedData = pgTable("exported_data", {
  id: varchar("id", { length: 255 }).notNull(),
  userIntegrationId: varchar("user_integration_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  dataType: varchar("data_type", { length: 100 }).notNull(),
  sourceId: varchar("source_id", { length: 255 }).notNull(),
  sourceType: varchar("source_type", { length: 100 }).notNull(),
  dataPayload: text("data_payload"),
  destinationId: varchar("destination_id", { length: 255 }),
  status: varchar("status", { length: 50 }),
  errorMessage: text("error_message"),
  exportedAt: timestamp("exported_at").defaultNow(),
  confirmedAt: timestamp("confirmed_at"),
});

export const faceEmbeddings = pgTable("face_embeddings", {
  id: integer("id").primaryKey().notNull(),
  userId: integer("user_id").notNull(),
  faceEmbedding: text("face_embedding").notNull(),
  faceEmbeddingVersion: varchar("face_embedding_version", { length: 20 }),
  enrollmentPhotos: integer("enrollment_photos").default(3),
  enrollmentQuality: varchar("enrollment_quality", { length: 20 }),
  lightingConditions: varchar("lighting_conditions", { length: 50 }),
  verificationCount: integer("verification_count").default(0),
  lastVerifiedAt: timestamp("last_verified_at"),
  verificationAccuracy: integer("verification_accuracy").default(0),
  isActive: varchar("is_active", { length: 10 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const featureFlags = pgTable("feature_flags", {
  id: varchar("id", { length: 255 }).notNull(),
  flagName: varchar("flag_name", { length: 255 }).notNull(),
  description: text("description"),
  enabled: boolean("enabled").default(false),
  rolloutPercentage: integer("rollout_percentage").default(0),
  targetUserIds: text("target_user_ids"),
  targetRoles: text("target_roles"),
  environments: text("environments"),
  lastModifiedBy: varchar("last_modified_by", { length: 255 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const financialEducation = pgTable("financial_education", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  topic: varchar("topic", { length: 50 }),
  resourceType: varchar("resource_type", { length: 50 }),
  resourceName: varchar("resource_name", { length: 255 }),
  resourceUrl: text("resource_url"),
  completedDate: timestamp("completed_date"),
  keyTakeaways: text("key_takeaways"),
  appliedLearning: text("applied_learning"),
  status: varchar("status", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
});

export const financialProfiles = pgTable("financial_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  employmentStatus: varchar("employment_status", { length: 50 }),
  monthlyIncome: numeric("monthly_income"),
  incomeStability: varchar("income_stability", { length: 50 }),
  totalDebt: numeric("total_debt"),
  debtTypes: text("debt_types"),
  hasEmergencyFund: boolean("has_emergency_fund").default(false),
  emergencyFundMonths: integer("emergency_fund_months"),
  hasBudget: boolean("has_budget").default(false),
  tracksSpending: boolean("tracks_spending").default(false),
  financialStressLevel: integer("financial_stress_level"),
  primaryGoal: varchar("primary_goal", { length: 50 }),
  specificGoals: text("specific_goals"),
  moneyScripts: text("money_scripts"),
  financialTrauma: text("financial_trauma"),
  impulseBuyingTriggers: text("impulse_buying_triggers"),
  emotionalSpendingTriggers: text("emotional_spending_triggers"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const financialWins = pgTable("financial_wins", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  winDate: timestamp("win_date").notNull(),
  winType: varchar("win_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  amountInvolved: numeric("amount_involved"),
  emotionalImpact: integer("emotional_impact"),
  whatYouLearned: text("what_you_learned"),
  whoYouBecame: text("who_you_became"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const focusSessions = pgTable("focus_sessions", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  sessionDate: timestamp("session_date").notNull(),
  sessionType: varchar("session_type", { length: 50 }),
  task: varchar("task", { length: 255 }).notNull(),
  taskType: varchar("task_type", { length: 50 }),
  plannedDuration: integer("planned_duration"),
  actualDuration: integer("actual_duration"),
  location: varchar("location", { length: 255 }),
  noiseLevel: varchar("noise_level", { length: 50 }),
  usedNoiseBlocking: boolean("used_noise_blocking"),
  energyBefore: integer("energy_before"),
  focusBefore: integer("focus_before"),
  stressBefore: integer("stress_before"),
  focusQuality: integer("focus_quality"),
  flowState: boolean("flow_state"),
  distractionCount: integer("distraction_count"),
  distractionTypes: text("distraction_types"),
  energyAfter: integer("energy_after"),
  focusAfter: integer("focus_after"),
  satisfactionLevel: integer("satisfaction_level"),
  productivityRating: integer("productivity_rating"),
  outputQuality: integer("output_quality"),
  whatHelped: text("what_helped"),
  whatHindered: text("what_hindered"),
  effectiveness: integer("effectiveness"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const foodReactions = pgTable("food_reactions", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  reactionDate: timestamp("reaction_date").notNull(),
  suspectedFood: varchar("suspected_food", { length: 255 }).notNull(),
  reactionType: varchar("reaction_type", { length: 50 }),
  symptoms: text("symptoms"),
  severity: varchar("severity", { length: 50 }),
  onsetTime: integer("onset_time"),
  duration: integer("duration"),
  consistentReaction: boolean("consistent_reaction"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const forbiddenContentDictionary = pgTable("forbidden_content_dictionary", {
  id: varchar("id", { length: 255 }).notNull(),
  contentType: varchar("content_type", { length: 50 }),
  content: text("content").notNull(),
  pattern: text("pattern"),
  riskCategory: varchar("risk_category", { length: 50 }),
  severityLevel: varchar("severity_level", { length: 50 }),
  action: varchar("action", { length: 50 }),
  source: varchar("source", { length: 50 }),
  detectionCount: integer("detection_count").default(0),
  falsePositiveCount: integer("false_positive_count").default(0),
  truePositiveCount: integer("true_positive_count").default(0),
  accuracy: numeric("accuracy"),
  active: boolean("active").default(true),
  description: text("description"),
  legalBasis: text("legal_basis"),
  redirectMessage: text("redirect_message"),
  version: integer("version").default(1),
  replacedBy: varchar("replaced_by", { length: 255 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
  createdBy: varchar("created_by", { length: 255 }),
});

export const gamificationAnalytics = pgTable("gamification_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  elementType: varchar("element_type", { length: 100 }).notNull(),
  avgEngagementIncrease: numeric("avg_engagement_increase"),
  avgRetentionImpact: numeric("avg_retention_impact"),
  avgGoalCompletionImpact: numeric("avg_goal_completion_impact"),
  optimalDifficulty: integer("optimal_difficulty"),
  optimalRewardTiming: varchar("optimal_reward_timing", { length: 100 }),
  mostEffectiveFor: text("most_effective_for"),
  userCount: integer("user_count"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const gamificationProfiles = pgTable("gamification_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  totalExperiencePoints: integer("total_experience_points").default(0),
  currentLevel: integer("current_level").default(1),
  experienceToNextLevel: integer("experience_to_next_level").default(100),
  currentStreak: integer("current_streak").default(0),
  longestStreak: integer("longest_streak").default(0),
  totalDaysActive: integer("total_days_active").default(0),
  totalAchievements: integer("total_achievements").default(0),
  totalBadges: integer("total_badges").default(0),
  totalMilestones: integer("total_milestones").default(0),
  motivationType: varchar("motivation_type", { length: 50 }),
  likesCompetition: boolean("likes_competition").default(false),
  likesCollaboration: boolean("likes_collaboration").default(true),
  likesChallenges: boolean("likes_challenges").default(true),
  likesRewards: boolean("likes_rewards").default(true),
  mostMotivatingRewards: text("most_motivating_rewards"),
  optimalChallengeDifficulty: integer("optimal_challenge_difficulty"),
  motivationPatterns: text("motivation_patterns"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const goalAccountability = pgTable("goal_accountability", {
  id: varchar("id", { length: 255 }).notNull(),
  goalId: varchar("goal_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  accountabilityType: varchar("accountability_type", { length: 50 }),
  partnerId: varchar("partner_id", { length: 255 }),
  checkInFrequency: varchar("check_in_frequency", { length: 50 }),
  lastCheckIn: timestamp("last_check_in"),
  nextCheckIn: timestamp("next_check_in"),
  adherenceRate: numeric("adherence_rate"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const goalAnalytics = pgTable("goal_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  goalType: varchar("goal_type", { length: 100 }).notNull(),
  avgAchievementRate: numeric("avg_achievement_rate"),
  avgTimeToCompletion: integer("avg_time_to_completion"),
  avgAbandonmentRate: numeric("avg_abandonment_rate"),
  optimalDifficulty: integer("optimal_difficulty"),
  optimalTimeframe: integer("optimal_timeframe"),
  optimalAccountabilityType: varchar("optimal_accountability_type", { length: 100 }),
  successFactors: text("success_factors"),
  failureFactors: text("failure_factors"),
  userCount: integer("user_count"),
  totalGoals: integer("total_goals"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const goalMilestones = pgTable("goal_milestones", {
  id: varchar("id", { length: 255 }).notNull(),
  goalId: varchar("goal_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  milestoneName: varchar("milestone_name", { length: 255 }).notNull(),
  description: text("description"),
  targetValue: numeric("target_value"),
  targetDate: timestamp("target_date"),
  achieved: boolean("achieved").default(false),
  achievedAt: timestamp("achieved_at"),
  sequenceOrder: integer("sequence_order"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const goalObstacles = pgTable("goal_obstacles", {
  id: varchar("id", { length: 255 }).notNull(),
  goalId: varchar("goal_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  obstacleName: varchar("obstacle_name", { length: 255 }).notNull(),
  description: text("description"),
  obstacleType: varchar("obstacle_type", { length: 50 }),
  severity: integer("severity"),
  occurrenceCount: integer("occurrence_count").default(0),
  lastOccurrence: timestamp("last_occurrence"),
  solution: text("solution"),
  solutionEffective: boolean("solution_effective"),
  overcome: boolean("overcome").default(false),
  overcameAt: timestamp("overcame_at"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const goalPredictions = pgTable("goal_predictions", {
  id: varchar("id", { length: 255 }).notNull(),
  goalId: varchar("goal_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  predictionType: varchar("prediction_type", { length: 50 }),
  prediction: text("prediction"),
  confidence: numeric("confidence"),
  factors: text("factors"),
  recommendation: text("recommendation"),
  actualOutcome: text("actual_outcome"),
  predictionAccurate: boolean("prediction_accurate"),
  createdAt: timestamp("created_at").defaultNow(),
  validatedAt: timestamp("validated_at"),
});

export const goalProfiles = pgTable("goal_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  totalGoalsSet: integer("total_goals_set").default(0),
  totalGoalsAchieved: integer("total_goals_achieved").default(0),
  totalGoalsAbandoned: integer("total_goals_abandoned").default(0),
  achievementRate: numeric("achievement_rate"),
  preferredFramework: varchar("preferred_framework", { length: 50 }),
  optimalGoalDifficulty: integer("optimal_goal_difficulty"),
  optimalTimeframe: varchar("optimal_timeframe", { length: 100 }),
  optimalGoalCount: integer("optimal_goal_count"),
  motivationType: varchar("motivation_type", { length: 50 }),
  needsAccountability: boolean("needs_accountability").default(false),
  preferredAccountabilityType: varchar("preferred_accountability_type", { length: 50 }),
  successPatterns: text("success_patterns"),
  failurePatterns: text("failure_patterns"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const goalProgressLogs = pgTable("goal_progress_logs", {
  id: varchar("id", { length: 255 }).notNull(),
  goalId: varchar("goal_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  currentValue: numeric("current_value").notNull(),
  progressPercent: numeric("progress_percent"),
  notes: text("notes"),
  momentum: varchar("momentum", { length: 50 }),
  logDate: timestamp("log_date").defaultNow(),
});

export const goalReflections = pgTable("goal_reflections", {
  id: varchar("id", { length: 255 }).notNull(),
  goalId: varchar("goal_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  reflectionType: varchar("reflection_type", { length: 50 }),
  whatWorked: text("what_worked"),
  whatDidntWork: text("what_didnt_work"),
  lessonsLearned: text("lessons_learned"),
  adjustmentsNeeded: text("adjustments_needed"),
  confidenceLevel: integer("confidence_level"),
  motivationLevel: integer("motivation_level"),
  reflectionDate: timestamp("reflection_date").defaultNow(),
});

export const goals = pgTable("goals", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  goalName: varchar("goal_name", { length: 255 }).notNull(),
  description: text("description"),
  goalType: varchar("goal_type", { length: 50 }),
  framework: varchar("framework", { length: 50 }),
  specific: boolean("specific").default(false),
  measurable: boolean("measurable").default(false),
  achievable: boolean("achievable").default(false),
  relevant: boolean("relevant").default(false),
  timeBound: boolean("time_bound").default(false),
  category: varchar("category", { length: 50 }),
  difficulty: integer("difficulty"),
  startDate: timestamp("start_date"),
  targetDate: timestamp("target_date"),
  metricType: varchar("metric_type", { length: 50 }),
  currentValue: numeric("current_value"),
  targetValue: numeric("target_value"),
  unit: varchar("unit", { length: 50 }),
  progressPercent: numeric("progress_percent"),
  status: varchar("status", { length: 50 }),
  priority: varchar("priority", { length: 50 }),
  isPublic: boolean("is_public").default(false),
  relatedHabitId: varchar("related_habit_id", { length: 255 }),
  relatedGoalId: varchar("related_goal_id", { length: 255 }),
  completedAt: timestamp("completed_at"),
  abandonedAt: timestamp("abandoned_at"),
  abandonReason: text("abandon_reason"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const gratitudeEntries = pgTable("gratitude_entries", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  entryDate: timestamp("entry_date").notNull(),
  gratitude1: text("gratitude_1").notNull(),
  gratitude2: text("gratitude_2"),
  gratitude3: text("gratitude_3"),
  gratitude4: text("gratitude_4"),
  gratitude5: text("gratitude_5"),
  gratitudeDepth: varchar("gratitude_depth", { length: 50 }),
  emotionalImpact: integer("emotional_impact"),
  savoringTime: integer("savoring_time"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const habitCompletions = pgTable("habit_completions", {
  id: varchar("id", { length: 255 }).notNull(),
  habitId: varchar("habit_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  completedAt: timestamp("completed_at").defaultNow().notNull(),
  date: varchar("date", { length: 10 }).notNull(),
  notes: text("notes"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const habitFormationAnalytics = pgTable("habit_formation_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  strategy: varchar("strategy", { length: 100 }).notNull(),
  habitCategory: varchar("habit_category", { length: 100 }),
  avgSuccessRate: numeric("avg_success_rate"),
  avgTimeToAutomaticity: integer("avg_time_to_automaticity"),
  avgStreakLength: integer("avg_streak_length"),
  optimalCueType: varchar("optimal_cue_type", { length: 100 }),
  optimalTimeOfDay: varchar("optimal_time_of_day", { length: 50 }),
  mostEffectiveFor: text("most_effective_for"),
  habitCount: integer("habit_count"),
  userCount: integer("user_count"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const habitFormationHabits = pgTable("habit_formation_habits", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  habitName: varchar("habit_name", { length: 255 }).notNull(),
  habitDescription: text("habit_description"),
  identityStatement: varchar("identity_statement", { length: 255 }),
  habitType: varchar("habit_type", { length: 50 }),
  category: varchar("category", { length: 50 }),
  tinyVersion: varchar("tiny_version", { length: 255 }),
  fullVersion: varchar("full_version", { length: 255 }),
  cue: varchar("cue", { length: 255 }).notNull(),
  cueType: varchar("cue_type", { length: 50 }),
  routine: varchar("routine", { length: 255 }).notNull(),
  reward: varchar("reward", { length: 255 }),
  anchorHabit: varchar("anchor_habit", { length: 255 }),
  stackingFormula: varchar("stacking_formula", { length: 255 }),
  implementationIntention: varchar("implementation_intention", { length: 255 }),
  environmentChanges: text("environment_changes"),
  targetFrequency: varchar("target_frequency", { length: 50 }),
  customFrequency: text("custom_frequency"),
  targetDuration: integer("target_duration"),
  difficulty: integer("difficulty"),
  currentStreak: integer("current_streak").default(0),
  longestStreak: integer("longest_streak").default(0),
  totalCompletions: integer("total_completions").default(0),
  successRate: numeric("success_rate"),
  automaticityLevel: integer("automaticity_level"),
  status: varchar("status", { length: 50 }),
  startDate: timestamp("start_date").notNull(),
  masteredDate: timestamp("mastered_date"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const habitMilestones = pgTable("habit_milestones", {
  id: varchar("id", { length: 255 }).notNull(),
  habitId: varchar("habit_id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  milestoneType: varchar("milestone_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  achievedDate: timestamp("achieved_date"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const habitObstacles = pgTable("habit_obstacles", {
  id: varchar("id", { length: 255 }).notNull(),
  habitId: varchar("habit_id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  obstacleDescription: text("obstacle_description").notNull(),
  obstacleType: varchar("obstacle_type", { length: 50 }),
  frequency: varchar("frequency", { length: 50 }),
  ifThenPlan: text("if_then_plan"),
  solutionEffectiveness: integer("solution_effectiveness"),
  resolved: boolean("resolved").default(false),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const habitProfiles = pgTable("habit_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  totalActiveHabits: integer("total_active_habits").default(0),
  totalMasteredHabits: integer("total_mastered_habits").default(0),
  longestStreak: integer("longest_streak").default(0),
  preferredHabitTime: varchar("preferred_habit_time", { length: 50 }),
  mostSuccessfulCues: text("most_successful_cues"),
  optimalHabitStackSequence: text("optimal_habit_stack_sequence"),
  personalSuccessFactors: text("personal_success_factors"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const habitStacks = pgTable("habit_stacks", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  stackName: varchar("stack_name", { length: 255 }).notNull(),
  description: text("description"),
  timeOfDay: varchar("time_of_day", { length: 50 }),
  habitSequence: text("habit_sequence"),
  estimatedDuration: integer("estimated_duration"),
  totalCompletions: integer("total_completions").default(0),
  currentStreak: integer("current_streak").default(0),
  successRate: numeric("success_rate"),
  active: boolean("active").default(true),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const habitTracking = pgTable("habit_tracking", {
  id: varchar("id", { length: 255 }).notNull(),
  habitId: varchar("habit_id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  trackingDate: timestamp("tracking_date").notNull(),
  completed: boolean("completed").notNull(),
  duration: integer("duration"),
  intensity: integer("intensity"),
  timeOfDay: varchar("time_of_day", { length: 50 }),
  location: varchar("location", { length: 255 }),
  cuePresent: boolean("cue_present"),
  cueEffectiveness: integer("cue_effectiveness"),
  resistanceLevel: integer("resistance_level"),
  easeOfCompletion: integer("ease_of_completion"),
  rewardExperienced: boolean("reward_experienced"),
  rewardSatisfaction: integer("reward_satisfaction"),
  feltAutomatic: boolean("felt_automatic"),
  moodBefore: varchar("mood_before", { length: 100 }),
  moodAfter: varchar("mood_after", { length: 100 }),
  energyBefore: integer("energy_before"),
  energyAfter: integer("energy_after"),
  notes: text("notes"),
  challenges: text("challenges"),
  wins: text("wins"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const habits = pgTable("habits", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  name: varchar("name", { length: 255 }).notNull(),
  description: text("description"),
  category: varchar("category", { length: 50 }),
  icon: varchar("icon", { length: 50 }),
  color: varchar("color", { length: 50 }),
  frequency: varchar("frequency", { length: 20 }).notNull(),
  targetDays: varchar("target_days", { length: 255 }),
  currentStreak: integer("current_streak").default(0),
  longestStreak: integer("longest_streak").default(0),
  totalCompletions: integer("total_completions").default(0),
  isActive: boolean("is_active").default(true),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const healthMilestones = pgTable("health_milestones", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  milestoneType: varchar("milestone_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  achievedDate: timestamp("achieved_date"),
  significance: text("significance"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const healthOptimizationAnalytics = pgTable("health_optimization_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  interventionType: varchar("intervention_type", { length: 100 }).notNull(),
  targetBiomarker: varchar("target_biomarker", { length: 100 }),
  avgBiomarkerImprovement: numeric("avg_biomarker_improvement"),
  successRate: numeric("success_rate"),
  optimalDuration: integer("optimal_duration"),
  optimalDosage: varchar("optimal_dosage", { length: 255 }),
  mostEffectiveFor: text("most_effective_for"),
  protocolCount: integer("protocol_count"),
  userCount: integer("user_count"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const healthOptimizationProfiles = pgTable("health_optimization_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  overallHealth: integer("overall_health"),
  chronologicalAge: integer("chronological_age"),
  estimatedBiologicalAge: integer("estimated_biological_age"),
  primaryGoal: varchar("primary_goal", { length: 50 }),
  familyHistory: text("family_history"),
  currentConditions: text("current_conditions"),
  riskFactors: text("risk_factors"),
  currentMedications: text("current_medications"),
  smokingStatus: varchar("smoking_status", { length: 50 }),
  alcoholConsumption: varchar("alcohol_consumption", { length: 50 }),
  activeProtocols: text("active_protocols"),
  mostEffectiveInterventions: text("most_effective_interventions"),
  biomarkerTrends: text("biomarker_trends"),
  healthTrajectory: varchar("health_trajectory", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const healthProtocols = pgTable("health_protocols", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  protocolName: varchar("protocol_name", { length: 255 }).notNull(),
  protocolType: varchar("protocol_type", { length: 50 }),
  description: text("description"),
  protocol: text("protocol"),
  targetBiomarker: varchar("target_biomarker", { length: 255 }),
  targetCondition: varchar("target_condition", { length: 255 }),
  startDate: timestamp("start_date"),
  plannedDuration: integer("planned_duration"),
  endDate: timestamp("end_date"),
  baselineMeasurement: text("baseline_measurement"),
  endMeasurement: text("end_measurement"),
  effectiveness: integer("effectiveness"),
  sideEffects: text("side_effects"),
  willContinue: boolean("will_continue"),
  status: varchar("status", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const healthScreenings = pgTable("health_screenings", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  screeningDate: timestamp("screening_date").notNull(),
  screeningType: varchar("screening_type", { length: 50 }),
  screeningName: varchar("screening_name", { length: 255 }),
  results: text("results"),
  abnormalFindings: text("abnormal_findings"),
  followUpNeeded: boolean("follow_up_needed"),
  followUpDate: timestamp("follow_up_date"),
  provider: varchar("provider", { length: 255 }),
  resultsFile: varchar("results_file", { length: 255 }),
  createdAt: timestamp("created_at").defaultNow(),
});

export const heatmapData = pgTable("heatmap_data", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  heatmapType: varchar("heatmap_type", { length: 50 }),
  date: timestamp("date").notNull(),
  intensity: integer("intensity"),
  dayOfWeek: integer("day_of_week"),
  hourOfDay: integer("hour_of_day"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const hrvMeasurements = pgTable("hrv_measurements", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  measurementTime: timestamp("measurement_time").notNull(),
  measurementType: varchar("measurement_type", { length: 50 }),
  rmssd: numeric("rmssd"),
  sdnn: numeric("sdnn"),
  pnn50: numeric("pnn50"),
  avgHeartRate: integer("avg_heart_rate"),
  hrvScore: integer("hrv_score"),
  recoveryStatus: varchar("recovery_status", { length: 50 }),
  sleepQualityPriorNight: integer("sleep_quality_prior_night"),
  stressLevelPriorDay: integer("stress_level_prior_day"),
  exerciseIntensityPriorDay: varchar("exercise_intensity_prior_day", { length: 50 }),
  measurementDevice: varchar("measurement_device", { length: 100 }),
  createdAt: timestamp("created_at").defaultNow(),
});

export const humanSessionBookings = pgTable("human_session_bookings", {
  id: integer("id").primaryKey().notNull(),
  userId: integer("user_id").notNull(),
  coachId: integer("coach_id").notNull(),
  subscriptionId: integer("subscription_id").notNull(),
  sessionDate: timestamp("session_date").notNull(),
  duration: integer("duration").default(30).notNull(),
  status: varchar("status", { length: 50 }),
  zoomLink: text("zoom_link"),
  aiPreSessionBrief: text("ai_pre_session_brief"),
  coachNotes: text("coach_notes"),
  recordingUrl: text("recording_url"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const hydrationLogs = pgTable("hydration_logs", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  logDate: timestamp("log_date").notNull(),
  waterIntake: numeric("water_intake"),
  coffee: integer("coffee"),
  tea: integer("tea"),
  alcohol: integer("alcohol"),
  urineColor: varchar("urine_color", { length: 50 }),
  headache: boolean("headache"),
  fatigue: boolean("fatigue"),
  dryMouth: boolean("dry_mouth"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const identityProfiles = pgTable("identityProfiles", {
  id: integer("id").primaryKey().notNull(),
  clientId: integer("client_id").notNull(),
  currentIdentity: text("current_identity"),
  targetIdentity: text("target_identity"),
  identityGaps: text("identity_gaps"),
  coreValues: text("core_values"),
  lifeMission: text("life_mission"),
  longTermVision: text("long_term_vision"),
  identityWins: text("identity_wins"),
  identityContradictions: text("identity_contradictions"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const identityHabitCompletions = pgTable("identity_habit_completions", {
  id: integer("id").primaryKey().notNull(),
  habitId: integer("habit_id").notNull(),
  completionDate: timestamp("completion_date").defaultNow().notNull(),
  completed: varchar("completed", { length: 50 }),
  notes: text("notes"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const identityTransformations = pgTable("identity_transformations", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  oldIdentityStatement: text("old_identity_statement"),
  oldBehaviors: text("old_behaviors"),
  oldBeliefs: text("old_beliefs"),
  newIdentityStatement: text("new_identity_statement"),
  newBehaviors: text("new_behaviors"),
  newBeliefs: text("new_beliefs"),
  supportingPrinciples: text("supporting_principles"),
  transformationProgress: integer("transformation_progress"),
  evidenceOfChange: text("evidence_of_change"),
  startDate: timestamp("start_date"),
  targetDate: timestamp("target_date"),
  status: varchar("status", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const implementationIntentions = pgTable("implementation_intentions", {
  id: varchar("id", { length: 255 }).notNull(),
  goalId: varchar("goal_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  ifCondition: text("if_condition").notNull(),
  thenAction: text("then_action").notNull(),
  intentionType: varchar("intention_type", { length: 50 }),
  timesTriggered: integer("times_triggered").default(0),
  timesExecuted: integer("times_executed").default(0),
  executionRate: numeric("execution_rate"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const importedData = pgTable("imported_data", {
  id: varchar("id", { length: 255 }).notNull(),
  userIntegrationId: varchar("user_integration_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  dataType: varchar("data_type", { length: 50 }),
  sourceId: varchar("source_id", { length: 255 }),
  dataPayload: text("data_payload"),
  dataTimestamp: timestamp("data_timestamp").notNull(),
  mappedToId: varchar("mapped_to_id", { length: 255 }),
  mappedToType: varchar("mapped_to_type", { length: 100 }),
  dataQuality: varchar("data_quality", { length: 50 }),
  validationErrors: text("validation_errors"),
  importedAt: timestamp("imported_at").defaultNow(),
});

export const incomeEntries = pgTable("income_entries", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  incomeDate: timestamp("income_date").notNull(),
  amount: numeric("amount").notNull(),
  incomeType: varchar("income_type", { length: 50 }),
  source: varchar("source", { length: 255 }),
  description: text("description"),
  isRecurring: boolean("is_recurring").default(false),
  createdAt: timestamp("created_at").defaultNow(),
});

export const insights = pgTable("insights", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  insightType: varchar("insight_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  supportingData: text("supporting_data"),
  actionable: boolean("actionable").default(false),
  suggestedAction: text("suggested_action"),
  priority: varchar("priority", { length: 50 }),
  viewed: boolean("viewed").default(false),
  viewedAt: timestamp("viewed_at"),
  actionTaken: boolean("action_taken").default(false),
  actionTakenAt: timestamp("action_taken_at"),
  helpful: boolean("helpful"),
  expiresAt: timestamp("expires_at"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const integrationAnalytics = pgTable("integration_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  integrationId: varchar("integration_id", { length: 255 }).notNull(),
  totalUsers: integer("total_users").default(0),
  activeUsers: integer("active_users").default(0),
  avgSyncsPerDay: numeric("avg_syncs_per_day"),
  avgRecordsPerSync: numeric("avg_records_per_sync"),
  successRate: numeric("success_rate"),
  avgDataQuality: numeric("avg_data_quality"),
  avgSatisfactionRating: numeric("avg_satisfaction_rating"),
  avgBehaviorImpact: numeric("avg_behavior_impact"),
  optimalSyncFrequency: varchar("optimal_sync_frequency", { length: 100 }),
  commonErrors: text("common_errors"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const integrationProfiles = pgTable("integration_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  autoSyncEnabled: boolean("auto_sync_enabled").default(true),
  syncFrequency: varchar("sync_frequency", { length: 50 }),
  dataSharing: varchar("data_sharing", { length: 50 }),
  totalIntegrations: integer("total_integrations").default(0),
  activeIntegrations: integer("active_integrations").default(0),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const integrationRecommendations = pgTable("integration_recommendations", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  integrationId: varchar("integration_id", { length: 255 }).notNull(),
  reason: text("reason"),
  potentialValue: text("potential_value"),
  confidence: numeric("confidence"),
  status: varchar("status", { length: 50 }),
  userFeedback: text("user_feedback"),
  createdAt: timestamp("created_at").defaultNow(),
  respondedAt: timestamp("responded_at"),
});

export const interactionLog = pgTable("interaction_log", {
  id: varchar("id", { length: 255 }).notNull(),
  clientProfileId: varchar("client_profile_id", { length: 255 }),
  interactionType: varchar("interaction_type", { length: 50 }).notNull(),
  target: varchar("target", { length: 255 }),
  duration: integer("duration"),
  metadata: json("metadata"),
  timestamp: timestamp("timestamp").defaultNow().notNull(),
});

export const interventionPlans = pgTable("interventionPlans", {
  id: integer("id").primaryKey().notNull(),
  profileId: integer("profile_id").notNull(),
  tier1Interventions: text("tier1_interventions").notNull(),
  tier2Interventions: text("tier2_interventions"),
  tier3Interventions: text("tier3_interventions"),
  tier4Interventions: text("tier4_interventions"),
  currentPhase: varchar("current_phase", { length: 50 }),
  startDate: timestamp("start_date").notNull(),
  providerDirectory: text("provider_directory"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const jobSearchActivities = pgTable("job_search_activities", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  activityDate: timestamp("activity_date").notNull(),
  activityType: varchar("activity_type", { length: 50 }),
  companyName: varchar("company_name", { length: 255 }),
  jobTitle: varchar("job_title", { length: 255 }),
  jobUrl: text("job_url"),
  applicationMethod: varchar("application_method", { length: 255 }),
  referralSource: varchar("referral_source", { length: 255 }),
  interviewType: varchar("interview_type", { length: 50 }),
  interviewRound: integer("interview_round"),
  interviewNotes: text("interview_notes"),
  status: varchar("status", { length: 50 }),
  nextSteps: text("next_steps"),
  followUpDate: timestamp("follow_up_date"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const journalEntries = pgTable("journalEntries", {
  id: integer("id").primaryKey().notNull(),
  clientId: integer("client_id").notNull(),
  entryDate: timestamp("entry_date").defaultNow().notNull(),
  content: text("content").notNull(),
  mood: varchar("mood", { length: 50 }),
  moodIntensity: integer("mood_intensity"),
  emotions: text("emotions"),
  triggers: text("triggers"),
  copingStrategies: text("coping_strategies"),
  copingEffectiveness: integer("coping_effectiveness"),
  resilienceScore: integer("resilience_score"),
  isPrivate: varchar("is_private", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const journalAnalytics = pgTable("journal_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  entryType: varchar("entry_type", { length: 100 }).notNull(),
  avgMoodImprovement: numeric("avg_mood_improvement"),
  avgInsightsGenerated: numeric("avg_insights_generated"),
  avgBehaviorChange: numeric("avg_behavior_change"),
  optimalWordCount: integer("optimal_word_count"),
  optimalDuration: integer("optimal_duration"),
  optimalTimeOfDay: varchar("optimal_time_of_day", { length: 100 }),
  mostEffectiveFor: text("most_effective_for"),
  userCount: integer("user_count"),
  totalEntries: integer("total_entries"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const journalInsights = pgTable("journal_insights", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  insightType: varchar("insight_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  supportingEntries: text("supporting_entries"),
  actionable: boolean("actionable").default(false),
  suggestedAction: text("suggested_action"),
  viewed: boolean("viewed").default(false),
  viewedAt: timestamp("viewed_at"),
  helpful: boolean("helpful"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const journalProfiles = pgTable("journal_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  totalEntries: integer("total_entries").default(0),
  currentStreak: integer("current_streak").default(0),
  longestStreak: integer("longest_streak").default(0),
  preferredJournalType: varchar("preferred_journal_type", { length: 50 }),
  preferredTime: varchar("preferred_time", { length: 50 }),
  defaultPrivacy: varchar("default_privacy", { length: 50 }),
  enableAiInsights: boolean("enable_ai_insights").default(true),
  enableEmotionDetection: boolean("enable_emotion_detection").default(true),
  enablePatternRecognition: boolean("enable_pattern_recognition").default(true),
  mostBeneficialPrompts: text("most_beneficial_prompts"),
  emotionalPatterns: text("emotional_patterns"),
  growthAreas: text("growth_areas"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const journalPrompts = pgTable("journal_prompts", {
  id: varchar("id", { length: 255 }).notNull(),
  promptText: text("prompt_text").notNull(),
  description: text("description"),
  category: varchar("category", { length: 50 }),
  researchBacked: boolean("research_backed").default(false),
  researchSource: text("research_source"),
  bestFor: text("best_for"),
  difficulty: varchar("difficulty", { length: 50 }),
  avgHelpfulnessRating: numeric("avg_helpfulness_rating"),
  totalUses: integer("total_uses").default(0),
  active: boolean("active").default(true),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const journalReflections = pgTable("journal_reflections", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  periodType: varchar("period_type", { length: 50 }),
  periodStart: timestamp("period_start").notNull(),
  periodEnd: timestamp("period_end").notNull(),
  overallThemes: text("overall_themes"),
  emotionalJourney: text("emotional_journey"),
  growthAreas: text("growth_areas"),
  challengeAreas: text("challenge_areas"),
  surprises: text("surprises"),
  gratitudes: text("gratitudes"),
  intentionsForward: text("intentions_forward"),
  reflectionDate: timestamp("reflection_date").defaultNow(),
});

export const keyResults = pgTable("key_results", {
  id: varchar("id", { length: 255 }).notNull(),
  okrId: varchar("okr_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  keyResult: text("key_result").notNull(),
  currentValue: numeric("current_value"),
  targetValue: numeric("target_value"),
  unit: varchar("unit", { length: 50 }),
  progressPercent: numeric("progress_percent"),
  status: varchar("status", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const knowledgeBaseArticles = pgTable("knowledge_base_articles", {
  id: varchar("id", { length: 255 }).notNull(),
  title: varchar("title", { length: 500 }).notNull(),
  content: text("content").notNull(),
  summary: text("summary"),
  category: varchar("category", { length: 100 }),
  tags: text("tags"),
  slug: varchar("slug", { length: 500 }).notNull(),
  metaDescription: text("meta_description"),
  status: varchar("status", { length: 50 }),
  authorId: varchar("author_id", { length: 255 }),
  public: boolean("public").default(true),
  helpfulCount: integer("helpful_count").default(0),
  notHelpfulCount: integer("not_helpful_count").default(0),
  viewCount: integer("view_count").default(0),
  publishedAt: timestamp("published_at"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const languagePatternPractice = pgTable("language_pattern_practice", {
  id: varchar("id", { length: 255 }).notNull(),
  patternId: varchar("pattern_id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  practiceDate: timestamp("practice_date").notNull(),
  situation: text("situation"),
  caughtOldPattern: boolean("caught_old_pattern"),
  usedNewPattern: boolean("used_new_pattern"),
  impactOnMood: integer("impact_on_mood"),
  impactOnAction: integer("impact_on_action"),
  notes: text("notes"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const languagePatterns = pgTable("language_patterns", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  patternType: varchar("pattern_type", { length: 50 }),
  originalStatement: text("original_statement"),
  reframedStatement: text("reframed_statement"),
  context: varchar("context", { length: 255 }),
  relatedHabitId: varchar("related_habit_id", { length: 255 }),
  beliefInOld: integer("belief_in_old"),
  beliefInNew: integer("belief_in_new"),
  impactOnBehavior: integer("impact_on_behavior"),
  status: varchar("status", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const leaderboardEntries = pgTable("leaderboard_entries", {
  id: varchar("id", { length: 255 }).notNull(),
  leaderboardId: varchar("leaderboard_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  rank: integer("rank"),
  score: integer("score"),
  optedIn: boolean("opted_in").default(false),
  lastUpdated: timestamp("last_updated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
});

export const leaderboards = pgTable("leaderboards", {
  id: varchar("id", { length: 255 }).notNull(),
  leaderboardName: varchar("leaderboard_name", { length: 255 }).notNull(),
  description: text("description"),
  leaderboardType: varchar("leaderboard_type", { length: 50 }),
  timePeriod: varchar("time_period", { length: 50 }),
  optInOnly: boolean("opt_in_only").default(true),
  active: boolean("active").default(true),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const learningSessions = pgTable("learning_sessions", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  sessionDate: timestamp("session_date").notNull(),
  topic: varchar("topic", { length: 255 }).notNull(),
  subject: varchar("subject", { length: 255 }),
  learningMethod: varchar("learning_method", { length: 50 }),
  duration: integer("duration"),
  engagementLevel: integer("engagement_level"),
  comprehensionLevel: integer("comprehension_level"),
  techniquesUsed: text("techniques_used"),
  notesCreated: boolean("notes_created"),
  practiceCompleted: boolean("practice_completed"),
  taughtToSomeone: boolean("taught_to_someone"),
  immediateRecall: integer("immediate_recall"),
  willReview: boolean("will_review"),
  nextReviewDate: timestamp("next_review_date"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const lifeSkillsDevelopment = pgTable("life_skills_development", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  skillCategory: varchar("skill_category", { length: 50 }),
  skillName: varchar("skill_name", { length: 255 }).notNull(),
  currentLevel: varchar("current_level", { length: 50 }),
  targetLevel: varchar("target_level", { length: 50 }),
  learningMethod: varchar("learning_method", { length: 50 }),
  resources: text("resources"),
  practiceCount: integer("practice_count").default(0),
  lastPracticed: timestamp("last_practiced"),
  masteryAchieved: boolean("mastery_achieved").default(false),
  masteryDate: timestamp("mastery_date"),
  status: varchar("status", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const liveSessionTranscripts = pgTable("liveSessionTranscripts", {
  id: integer("id").primaryKey().notNull(),
  sessionId: integer("session_id").notNull(),
  speaker: varchar("speaker", { length: 50 }),
  text: text("text").notNull(),
  timestamp: timestamp("timestamp").notNull(),
});

export const loginHistory = pgTable("login_history", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  loginMethod: varchar("login_method", { length: 50 }),
  success: boolean("success").notNull(),
  failureReason: varchar("failure_reason", { length: 255 }),
  ipAddress: varchar("ip_address", { length: 50 }),
  country: varchar("country", { length: 100 }),
  city: varchar("city", { length: 100 }),
  userAgent: text("user_agent"),
  mfaRequired: boolean("mfa_required").default(false),
  mfaCompleted: boolean("mfa_completed").default(false),
  riskScore: integer("risk_score"),
  riskFactors: text("risk_factors"),
  loginAt: timestamp("login_at").defaultNow(),
});

export const longevityPractices = pgTable("longevity_practices", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  practiceDate: timestamp("practice_date").notNull(),
  practiceType: varchar("practice_type", { length: 50 }),
  duration: integer("duration"),
  intensity: varchar("intensity", { length: 50 }),
  specificMetrics: text("specific_metrics"),
  howItFelt: text("how_it_felt"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const loveLanguageActions = pgTable("love_language_actions", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  actionDate: timestamp("action_date").notNull(),
  actionType: varchar("action_type", { length: 50 }),
  loveLanguage: varchar("love_language", { length: 50 }),
  actionDescription: text("action_description").notNull(),
  emotionalImpact: integer("emotional_impact"),
  connectionFelt: integer("connection_felt"),
  partnerResponse: text("partner_response"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const loveMaps = pgTable("love_maps", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  partnerDreams: text("partner_dreams"),
  partnerFears: text("partner_fears"),
  partnerStressors: text("partner_stressors"),
  partnerJoys: text("partner_joys"),
  partnerDailyRoutine: text("partner_daily_routine"),
  partnerFavorites: text("partner_favorites"),
  partnerPetPeeves: text("partner_pet_peeves"),
  howWeMet: text("how_we_met"),
  bestMemories: text("best_memories"),
  hardestMoments: text("hardest_moments"),
  sharedGoals: text("shared_goals"),
  individualGoals: text("individual_goals"),
  lastUpdated: timestamp("last_updated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
});

export const masculinityReflections = pgTable("masculinity_reflections", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  reflectionDate: timestamp("reflection_date").notNull(),
  promptType: varchar("prompt_type", { length: 50 }),
  reflection: text("reflection").notNull(),
  insights: text("insights"),
  actionSteps: text("action_steps"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const mealPlans = pgTable("meal_plans", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  planName: varchar("plan_name", { length: 255 }).notNull(),
  startDate: timestamp("start_date"),
  endDate: timestamp("end_date"),
  meals: text("meals"),
  shoppingList: text("shopping_list"),
  prepNotes: text("prep_notes"),
  active: boolean("active").default(true),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const meals = pgTable("meals", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  mealDate: timestamp("meal_date").notNull(),
  mealType: varchar("meal_type", { length: 50 }),
  foods: text("foods"),
  totalCalories: integer("total_calories"),
  totalProtein: numeric("total_protein"),
  totalCarbs: numeric("total_carbs"),
  totalFat: numeric("total_fat"),
  totalFiber: numeric("total_fiber"),
  totalSugar: numeric("total_sugar"),
  location: varchar("location", { length: 255 }),
  socialContext: varchar("social_context", { length: 50 }),
  eatingSpeed: varchar("eating_speed", { length: 50 }),
  mindfulEating: boolean("mindful_eating"),
  distractions: text("distractions"),
  hungerBefore: integer("hunger_before"),
  hungerAfter: integer("hunger_after"),
  satisfactionLevel: integer("satisfaction_level"),
  emotionBefore: varchar("emotion_before", { length: 100 }),
  emotionalEating: boolean("emotional_eating"),
  energyAfter: integer("energy_after"),
  digestionQuality: integer("digestion_quality"),
  bloating: integer("bloating"),
  mealPhoto: varchar("meal_photo", { length: 255 }),
  createdAt: timestamp("created_at").defaultNow(),
});

export const meditationSessions = pgTable("meditation_sessions", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  sessionDate: timestamp("session_date").notNull(),
  practiceType: varchar("practice_type", { length: 50 }),
  guidedOrSilent: varchar("guided_or_silent", { length: 50 }),
  guideSource: varchar("guide_source", { length: 255 }),
  plannedDuration: integer("planned_duration"),
  actualDuration: integer("actual_duration"),
  focusLevel: integer("focus_level"),
  distractionLevel: integer("distraction_level"),
  peaceLevel: integer("peace_level"),
  insightLevel: integer("insight_level"),
  emotionBefore: varchar("emotion_before", { length: 255 }),
  stressLevelBefore: integer("stress_level_before"),
  emotionAfter: varchar("emotion_after", { length: 255 }),
  stressLevelAfter: integer("stress_level_after"),
  experiences: text("experiences"),
  insights: text("insights"),
  challenges: text("challenges"),
  completed: boolean("completed").default(true),
  effectiveness: integer("effectiveness"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const memoryChallenges = pgTable("memory_challenges", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  challengeName: varchar("challenge_name", { length: 255 }).notNull(),
  challengeType: varchar("challenge_type", { length: 50 }),
  itemCount: integer("item_count"),
  timeLimit: integer("time_limit"),
  itemsRecalled: integer("items_recalled"),
  accuracy: numeric("accuracy"),
  timeUsed: integer("time_used"),
  score: integer("score"),
  personalBest: boolean("personal_best"),
  attemptDate: timestamp("attempt_date"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const memoryItems = pgTable("memory_items", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  itemType: varchar("item_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  content: text("content"),
  category: varchar("category", { length: 255 }),
  tags: text("tags"),
  encodingTechnique: varchar("encoding_technique", { length: 50 }),
  palaceLocation: varchar("palace_location", { length: 255 }),
  visualImage: text("visual_image"),
  mnemonicDevice: text("mnemonic_device"),
  relatedItems: text("related_items"),
  existingKnowledge: text("existing_knowledge"),
  importance: integer("importance"),
  easeFactor: numeric("ease_factor"),
  interval: integer("interval").default(1),
  repetitions: integer("repetitions").default(0),
  nextReviewDate: timestamp("next_review_date"),
  totalReviews: integer("total_reviews").default(0),
  successfulRecalls: integer("successful_recalls").default(0),
  retentionRate: numeric("retention_rate"),
  mastered: boolean("mastered").default(false),
  masteredDate: timestamp("mastered_date"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const memoryMasteryAnalytics = pgTable("memory_mastery_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  technique: varchar("technique", { length: 100 }).notNull(),
  itemType: varchar("item_type", { length: 100 }),
  avgRetentionRate: numeric("avg_retention_rate"),
  avgRecallSpeed: numeric("avg_recall_speed"),
  optimalReviewInterval: integer("optimal_review_interval"),
  optimalSessionDuration: integer("optimal_session_duration"),
  mostEffectiveFor: text("most_effective_for"),
  reviewCount: integer("review_count"),
  userCount: integer("user_count"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const memoryMasteryProfiles = pgTable("memory_mastery_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  selfAssessedMemory: integer("self_assessed_memory"),
  primaryGoal: varchar("primary_goal", { length: 50 }),
  preferredTechniques: text("preferred_techniques"),
  learningStyle: varchar("learning_style", { length: 50 }),
  dailyReviewTime: varchar("daily_review_time", { length: 10 }),
  weeklyGoalMinutes: integer("weekly_goal_minutes"),
  optimalReviewTime: varchar("optimal_review_time", { length: 100 }),
  personalForgettingCurve: text("personal_forgetting_curve"),
  mostEffectiveTechniques: text("most_effective_techniques"),
  optimalReviewIntervals: text("optimal_review_intervals"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const memoryMilestones = pgTable("memory_milestones", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  milestoneType: varchar("milestone_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  achievedDate: timestamp("achieved_date"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const memoryPalaces = pgTable("memory_palaces", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  palaceName: varchar("palace_name", { length: 255 }).notNull(),
  description: text("description"),
  locations: text("locations"),
  purpose: varchar("purpose", { length: 255 }),
  itemCount: integer("item_count").default(0),
  avgRecallRate: numeric("avg_recall_rate"),
  active: boolean("active").default(true),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const memoryPractices = pgTable("memory_practices", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  practiceDate: timestamp("practice_date").notNull(),
  practiceType: varchar("practice_type", { length: 50 }),
  contentType: varchar("content_type", { length: 50 }),
  topic: varchar("topic", { length: 255 }),
  duration: integer("duration"),
  itemsReviewed: integer("items_reviewed"),
  itemsRecalled: integer("items_recalled"),
  recallAccuracy: integer("recall_accuracy"),
  confidenceLevel: integer("confidence_level"),
  difficulty: varchar("difficulty", { length: 50 }),
  nextReviewDate: timestamp("next_review_date"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const memoryReviews = pgTable("memory_reviews", {
  id: varchar("id", { length: 255 }).notNull(),
  itemId: varchar("item_id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  reviewDate: timestamp("review_date").notNull(),
  reviewType: varchar("review_type", { length: 50 }),
  recalled: boolean("recalled").notNull(),
  recallSpeed: varchar("recall_speed", { length: 50 }),
  confidence: integer("confidence"),
  difficultyRating: varchar("difficulty_rating", { length: 50 }).notNull(),
  timeToRecall: integer("time_to_recall"),
  reviewContext: varchar("review_context", { length: 255 }),
  distractions: boolean("distractions"),
  nextInterval: integer("next_interval"),
  nextReviewDate: timestamp("next_review_date"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const memoryTechniquePractice = pgTable("memory_technique_practice", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  practiceDate: timestamp("practice_date").notNull(),
  technique: varchar("technique", { length: 50 }),
  practiceType: varchar("practice_type", { length: 255 }),
  duration: integer("duration"),
  itemsAttempted: integer("items_attempted"),
  itemsRecalled: integer("items_recalled"),
  accuracyRate: numeric("accuracy_rate"),
  difficulty: integer("difficulty"),
  improvementFromLast: numeric("improvement_from_last"),
  notes: text("notes"),
  challengesFaced: text("challenges_faced"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const mentalBreaks = pgTable("mental_breaks", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  breakDate: timestamp("break_date").notNull(),
  breakType: varchar("break_type", { length: 50 }),
  duration: integer("duration"),
  activity: varchar("activity", { length: 255 }),
  mentalFatigueBefore: integer("mental_fatigue_before"),
  mentalFatigueAfter: integer("mental_fatigue_after"),
  restorationLevel: integer("restoration_level"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const mentalEngineAnalytics = pgTable("mental_engine_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  techniqueType: varchar("technique_type", { length: 100 }).notNull(),
  avgFocusImprovement: numeric("avg_focus_improvement"),
  avgProductivityScore: numeric("avg_productivity_score"),
  avgFlowStateRate: numeric("avg_flow_state_rate"),
  optimalDuration: integer("optimal_duration"),
  optimalTimeOfDay: varchar("optimal_time_of_day", { length: 50 }),
  optimalBreakFrequency: integer("optimal_break_frequency"),
  mostEffectiveFor: text("most_effective_for"),
  sessionCount: integer("session_count"),
  userCount: integer("user_count"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const mentalHealthProfiles = pgTable("mental_health_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  primaryDiagnosis: varchar("primary_diagnosis", { length: 255 }),
  secondaryDiagnoses: text("secondary_diagnoses"),
  diagnosisDate: timestamp("diagnosis_date"),
  treatmentHistory: text("treatment_history"),
  currentSeverity: varchar("current_severity", { length: 50 }),
  inTreatment: boolean("in_treatment").default(false),
  medicationList: text("medication_list"),
  therapyType: varchar("therapy_type", { length: 255 }),
  suicidalIdeation: boolean("suicidal_ideation").default(false),
  selfHarmRisk: varchar("self_harm_risk", { length: 50 }),
  crisisContactInfo: text("crisis_contact_info"),
  recoveryGoals: text("recovery_goals"),
  currentPhase: varchar("current_phase", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const mentalProfiles = pgTable("mental_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  mentalClarity: integer("mental_clarity"),
  focusAbility: integer("focus_ability"),
  memoryQuality: integer("memory_quality"),
  cognitiveEnergy: integer("cognitive_energy"),
  primaryChallenges: text("primary_challenges"),
  primaryGoal: varchar("primary_goal", { length: 50 }),
  learningStyle: text("learning_style"),
  bestLearningTime: varchar("best_learning_time", { length: 50 }),
  sleepQuality: integer("sleep_quality"),
  exerciseFrequency: varchar("exercise_frequency", { length: 50 }),
  screenTimeHours: integer("screen_time_hours"),
  cognitiveSupplements: text("cognitive_supplements"),
  medications: text("medications"),
  peakFocusHours: text("peak_focus_hours"),
  optimalWorkDuration: integer("optimal_work_duration"),
  mostEffectiveTechniques: text("most_effective_techniques"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const mentorshipConnections = pgTable("mentorship_connections", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  mentorType: varchar("mentor_type", { length: 50 }),
  mentorName: varchar("mentor_name", { length: 255 }),
  mentorArea: varchar("mentor_area", { length: 255 }),
  connectionDate: timestamp("connection_date"),
  meetingFrequency: varchar("meeting_frequency", { length: 50 }),
  focusAreas: text("focus_areas"),
  sessionsCompleted: integer("sessions_completed").default(0),
  lastMeeting: timestamp("last_meeting"),
  nextMeeting: timestamp("next_meeting"),
  impactRating: integer("impact_rating"),
  keyLearnings: text("key_learnings"),
  status: varchar("status", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const mentorships = pgTable("mentorships", {
  id: varchar("id", { length: 255 }).notNull(),
  mentorId: varchar("mentor_id", { length: 255 }).notNull(),
  menteeId: varchar("mentee_id", { length: 255 }).notNull(),
  focusArea: varchar("focus_area", { length: 255 }).notNull(),
  meetingFrequency: varchar("meeting_frequency", { length: 50 }),
  totalSessions: integer("total_sessions").default(0),
  lastSession: timestamp("last_session"),
  menteeProgress: integer("mentee_progress"),
  menteeSatisfaction: integer("mentee_satisfaction"),
  status: varchar("status", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const message = pgTable("message", {
  id: varchar("id", { length: 255 }).notNull(),
  conversationId: varchar("conversation_id", { length: 255 }).notNull(),
  role: varchar("role", { length: 50 }).notNull(),
  content: text("content").notNull(),
  mood: varchar("mood", { length: 50 }),
  sentiment: varchar("sentiment", { length: 50 }),
  crisisKeywords: json("crisis_keywords"),
  audioUrl: text("audio_url"),
  transcriptionConfidence: real("transcription_confidence"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const microHabits = pgTable("microHabits", {
  id: integer("id").primaryKey().notNull(),
  clientId: integer("client_id").notNull(),
  microHabitName: varchar("micro_habit_name", { length: 255 }).notNull(),
  trigger: varchar("trigger", { length: 255 }).notNull(),
  action: varchar("action", { length: 255 }).notNull(),
  identityReinforcement: text("identity_reinforcement"),
  isActive: varchar("is_active", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const milestoneVisualizations = pgTable("milestone_visualizations", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  timelineType: varchar("timeline_type", { length: 50 }),
  relatedId: varchar("related_id", { length: 255 }),
  milestones: text("milestones"),
  currentPosition: numeric("current_position"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const milestones = pgTable("milestones", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  milestoneType: varchar("milestone_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  experiencePoints: integer("experience_points"),
  relatedTo: varchar("related_to", { length: 255 }),
  achievedAt: timestamp("achieved_at").defaultNow(),
});

export const mindfulnessPractices = pgTable("mindfulness_practices", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  practiceDate: timestamp("practice_date").notNull(),
  practiceType: varchar("practice_type", { length: 50 }),
  duration: integer("duration"),
  activity: varchar("activity", { length: 255 }),
  location: varchar("location", { length: 255 }),
  presenceLevel: integer("presence_level"),
  awarenessLevel: integer("awareness_level"),
  whatYouNoticed: text("what_you_noticed"),
  howItFelt: text("how_it_felt"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const mobilityWork = pgTable("mobility_work", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  sessionDate: timestamp("session_date").notNull(),
  sessionType: varchar("session_type", { length: 50 }),
  areasWorked: text("areas_worked"),
  duration: integer("duration"),
  rangeOfMotionBefore: integer("range_of_motion_before"),
  rangeOfMotionAfter: integer("range_of_motion_after"),
  painBefore: integer("pain_before"),
  painAfter: integer("pain_after"),
  techniquesUsed: text("techniques_used"),
  effectiveness: integer("effectiveness"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const modulePreferences = pgTable("module_preferences", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  moduleName: varchar("module_name", { length: 100 }).notNull(),
  enabled: boolean("enabled").default(true),
  showInDashboard: boolean("show_in_dashboard").default(true),
  dashboardOrder: integer("dashboard_order"),
  moduleSettings: text("module_settings"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const moneyMindsetReflections = pgTable("money_mindset_reflections", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  reflectionDate: timestamp("reflection_date").notNull(),
  promptType: varchar("prompt_type", { length: 50 }),
  reflection: text("reflection").notNull(),
  insights: text("insights"),
  limitingBeliefs: text("limiting_beliefs"),
  empoweringBeliefs: text("empowering_beliefs"),
  actionSteps: text("action_steps"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const monthlyReports = pgTable("monthly_reports", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  monthStartDate: timestamp("month_start_date").notNull(),
  transformationScore: integer("transformation_score"),
  habitsStarted: integer("habits_started"),
  habitsMastered: integer("habits_mastered"),
  habitsAbandoned: integer("habits_abandoned"),
  avgHabitSuccessRate: numeric("avg_habit_success_rate"),
  goalsSet: integer("goals_set"),
  goalsAchieved: integer("goals_achieved"),
  goalAchievementRate: numeric("goal_achievement_rate"),
  physicalTrend: varchar("physical_trend", { length: 50 }),
  mentalTrend: varchar("mental_trend", { length: 50 }),
  emotionalTrend: varchar("emotional_trend", { length: 50 }),
  spiritualTrend: varchar("spiritual_trend", { length: 50 }),
  communityEngagement: integer("community_engagement"),
  supportsGiven: integer("supports_given"),
  supportsReceived: integer("supports_received"),
  achievementsUnlocked: integer("achievements_unlocked"),
  milestonesReached: integer("milestones_reached"),
  identityShiftScore: integer("identity_shift_score"),
  monthSummary: text("month_summary"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const moodLogs = pgTable("mood_logs", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  logDate: timestamp("log_date").notNull(),
  overallMood: integer("overall_mood"),
  anxiety: integer("anxiety"),
  depression: integer("depression"),
  irritability: integer("irritability"),
  energy: integer("energy"),
  sleepQuality: integer("sleep_quality"),
  symptoms: text("symptoms"),
  selfCareCompleted: boolean("self_care_completed"),
  socialInteraction: boolean("social_interaction"),
  physicalActivity: boolean("physical_activity"),
  substanceUse: boolean("substance_use"),
  triggers: text("triggers"),
  copingStrategiesUsed: text("coping_strategies_used"),
  copingEffectiveness: integer("coping_effectiveness"),
  notes: text("notes"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const motivationBoosts = pgTable("motivation_boosts", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  triggerType: varchar("trigger_type", { length: 50 }),
  boostType: varchar("boost_type", { length: 50 }),
  message: text("message"),
  actionSuggested: varchar("action_suggested", { length: 255 }),
  opened: boolean("opened").default(false),
  actionTaken: boolean("action_taken").default(false),
  sentAt: timestamp("sent_at").defaultNow(),
});

export const nameFaceMemory = pgTable("name_face_memory", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  personName: varchar("person_name", { length: 255 }).notNull(),
  firstName: varchar("first_name", { length: 255 }),
  lastName: varchar("last_name", { length: 255 }),
  facePhoto: varchar("face_photo", { length: 255 }),
  outstandingFeature: text("outstanding_feature"),
  nameAssociation: text("name_association"),
  substituteWord: varchar("substitute_word", { length: 255 }),
  mentalLink: text("mental_link"),
  whereMet: varchar("where_met", { length: 255 }),
  whenMet: timestamp("when_met"),
  relationship: varchar("relationship", { length: 255 }),
  occupation: varchar("occupation", { length: 255 }),
  interests: text("interests"),
  mutualConnections: text("mutual_connections"),
  conversationTopics: text("conversation_topics"),
  totalEncounters: integer("total_encounters").default(1),
  successfulRecalls: integer("successful_recalls").default(0),
  lastEncounter: timestamp("last_encounter"),
  importance: integer("importance"),
  mastered: boolean("mastered").default(false),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const nameRecallPractice = pgTable("name_recall_practice", {
  id: varchar("id", { length: 255 }).notNull(),
  nameFaceId: varchar("name_face_id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  practiceDate: timestamp("practice_date").notNull(),
  practiceType: varchar("practice_type", { length: 50 }),
  recalled: boolean("recalled"),
  recallSpeed: varchar("recall_speed", { length: 50 }),
  confidence: integer("confidence"),
  timeToRecall: integer("time_to_recall"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const networkingContacts = pgTable("networking_contacts", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  name: varchar("name", { length: 255 }).notNull(),
  title: varchar("title", { length: 255 }),
  company: varchar("company", { length: 255 }),
  industry: varchar("industry", { length: 255 }),
  howMet: text("how_met"),
  connectionStrength: varchar("connection_strength", { length: 50 }),
  email: varchar("email", { length: 255 }),
  linkedin: varchar("linkedin", { length: 255 }),
  phone: varchar("phone", { length: 50 }),
  lastContact: timestamp("last_contact"),
  contactFrequency: varchar("contact_frequency", { length: 50 }),
  howTheyCanHelp: text("how_they_can_help"),
  howYouCanHelp: text("how_you_can_help"),
  notes: text("notes"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const notificationAnalytics = pgTable("notification_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  notificationType: varchar("notification_type", { length: 100 }).notNull(),
  avgViewRate: numeric("avg_view_rate"),
  avgClickRate: numeric("avg_click_rate"),
  avgActionRate: numeric("avg_action_rate"),
  avgDismissRate: numeric("avg_dismiss_rate"),
  optimalTimeOfDay: varchar("optimal_time_of_day", { length: 100 }),
  optimalDayOfWeek: varchar("optimal_day_of_week", { length: 100 }),
  bestChannel: varchar("best_channel", { length: 100 }),
  channelPerformance: text("channel_performance"),
  avgBehaviorChange: numeric("avg_behavior_change"),
  fatigueThreshold: integer("fatigue_threshold"),
  userCount: integer("user_count"),
  totalSent: integer("total_sent"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const notificationBatches = pgTable("notification_batches", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  batchType: varchar("batch_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  summary: text("summary"),
  notificationCount: integer("notification_count").default(0),
  scheduledFor: timestamp("scheduled_for"),
  sentAt: timestamp("sent_at"),
  status: varchar("status", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
});

export const notificationPreferences = pgTable("notification_preferences", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  notificationType: varchar("notification_type", { length: 50 }),
  enabled: boolean("enabled").default(true),
  emailEnabled: boolean("email_enabled").default(true),
  pushEnabled: boolean("push_enabled").default(true),
  smsEnabled: boolean("sms_enabled").default(false),
  inAppEnabled: boolean("in_app_enabled").default(true),
  frequency: varchar("frequency", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const notificationProfiles = pgTable("notification_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  notificationsEnabled: boolean("notifications_enabled").default(true),
  quietHoursEnabled: boolean("quiet_hours_enabled").default(true),
  quietHoursStart: varchar("quiet_hours_start", { length: 10 }),
  quietHoursEnd: varchar("quiet_hours_end", { length: 10 }),
  emailEnabled: boolean("email_enabled").default(true),
  pushEnabled: boolean("push_enabled").default(true),
  smsEnabled: boolean("sms_enabled").default(false),
  inAppEnabled: boolean("in_app_enabled").default(true),
  batchingEnabled: boolean("batching_enabled").default(true),
  batchingWindow: integer("batching_window").default(60),
  maxNotificationsPerDay: integer("max_notifications_per_day").default(10),
  optimalTimes: text("optimal_times"),
  effectiveChannels: text("effective_channels"),
  notificationFatigueRisk: integer("notification_fatigue_risk"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const notifications = pgTable("notifications", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  notificationType: varchar("notification_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  body: text("body"),
  actionUrl: varchar("action_url", { length: 500 }),
  actionText: varchar("action_text", { length: 100 }),
  priority: varchar("priority", { length: 50 }),
  channels: text("channels"),
  scheduledFor: timestamp("scheduled_for"),
  status: varchar("status", { length: 50 }),
  sentAt: timestamp("sent_at"),
  deliveredAt: timestamp("delivered_at"),
  viewed: boolean("viewed").default(false),
  viewedAt: timestamp("viewed_at"),
  clicked: boolean("clicked").default(false),
  clickedAt: timestamp("clicked_at"),
  dismissed: boolean("dismissed").default(false),
  dismissedAt: timestamp("dismissed_at"),
  actionTaken: boolean("action_taken").default(false),
  relatedId: varchar("related_id", { length: 255 }),
  relatedType: varchar("related_type", { length: 100 }),
  batchId: varchar("batch_id", { length: 255 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const numberMemory = pgTable("number_memory", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  number: varchar("number", { length: 255 }).notNull(),
  numberType: varchar("number_type", { length: 50 }),
  label: varchar("label", { length: 255 }),
  phoneticWords: text("phonetic_words"),
  visualStory: text("visual_story"),
  chunks: text("chunks"),
  totalRecalls: integer("total_recalls").default(0),
  successfulRecalls: integer("successful_recalls").default(0),
  mastered: boolean("mastered").default(false),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const nutritionEngineAnalytics = pgTable("nutrition_engine_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  foodCategory: varchar("food_category", { length: 100 }).notNull(),
  avgEnergyImpact: numeric("avg_energy_impact"),
  avgDigestiveImpact: numeric("avg_digestive_impact"),
  avgWorkoutImpact: numeric("avg_workout_impact"),
  optimalMealTiming: varchar("optimal_meal_timing", { length: 100 }),
  mostBeneficialFor: text("most_beneficial_for"),
  mealCount: integer("meal_count"),
  userCount: integer("user_count"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const nutritionExperiments = pgTable("nutrition_experiments", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  experimentName: varchar("experiment_name", { length: 255 }).notNull(),
  experimentType: varchar("experiment_type", { length: 50 }),
  hypothesis: text("hypothesis"),
  startDate: timestamp("start_date"),
  endDate: timestamp("end_date"),
  protocol: text("protocol"),
  baselineWeight: numeric("baseline_weight"),
  baselineEnergy: integer("baseline_energy"),
  baselineDigestion: integer("baseline_digestion"),
  endWeight: numeric("end_weight"),
  endEnergy: integer("end_energy"),
  endDigestion: integer("end_digestion"),
  findings: text("findings"),
  conclusion: text("conclusion"),
  willContinue: boolean("will_continue"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const nutritionProfiles = pgTable("nutrition_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  currentWeight: numeric("current_weight"),
  targetWeight: numeric("target_weight"),
  height: integer("height"),
  primaryGoal: varchar("primary_goal", { length: 50 }),
  dietaryApproach: varchar("dietary_approach", { length: 50 }),
  allergies: text("allergies"),
  intolerances: text("intolerances"),
  restrictions: text("restrictions"),
  healthConditions: text("health_conditions"),
  medications: text("medications"),
  targetCalories: integer("target_calories"),
  targetProtein: integer("target_protein"),
  targetCarbs: integer("target_carbs"),
  targetFat: integer("target_fat"),
  targetFiber: integer("target_fiber"),
  mealsPerDay: integer("meals_per_day"),
  fastingWindow: integer("fasting_window"),
  eatingWindow: integer("eating_window"),
  optimalMacroRatio: text("optimal_macro_ratio"),
  energyOptimalFoods: text("energy_optimal_foods"),
  triggerFoods: text("trigger_foods"),
  bestMealTiming: text("best_meal_timing"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const okrs = pgTable("okrs", {
  id: varchar("id", { length: 255 }).notNull(),
  goalId: varchar("goal_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  objective: text("objective").notNull(),
  timePeriod: varchar("time_period", { length: 50 }),
  startDate: timestamp("start_date"),
  endDate: timestamp("end_date"),
  overallProgress: numeric("overall_progress"),
  status: varchar("status", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const partnerCheckIns = pgTable("partner_check_ins", {
  id: varchar("id", { length: 255 }).notNull(),
  partnershipId: varchar("partnership_id", { length: 255 }).notNull(),
  initiatorId: varchar("initiator_id", { length: 255 }).notNull(),
  checkInDate: timestamp("check_in_date").notNull(),
  user1Progress: text("user1_progress"),
  user1Struggles: text("user1_struggles"),
  user1Wins: text("user1_wins"),
  user1NextSteps: text("user1_next_steps"),
  user2Progress: text("user2_progress"),
  user2Struggles: text("user2_struggles"),
  user2Wins: text("user2_wins"),
  user2NextSteps: text("user2_next_steps"),
  encouragementGiven: text("encouragement_given"),
  helpfulness: integer("helpfulness"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const patternLearning = pgTable("pattern_learning", {
  id: varchar("id", { length: 255 }).notNull(),
  patternType: varchar("pattern_type", { length: 50 }),
  patternSignature: text("pattern_signature"),
  detectionAlgorithm: text("detection_algorithm"),
  occurrences: integer("occurrences").default(0),
  accuracy: numeric("accuracy"),
  confidence: numeric("confidence"),
  learnedFrom: text("learned_from"),
  improvedBy: text("improved_by"),
  validated: boolean("validated").default(false),
  active: boolean("active").default(false),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const physicalEngineAnalytics = pgTable("physical_engine_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  workoutType: varchar("workout_type", { length: 100 }).notNull(),
  avgRecoveryScore: numeric("avg_recovery_score"),
  avgProgressionRate: numeric("avg_progression_rate"),
  injuryRate: numeric("injury_rate"),
  optimalFrequency: integer("optimal_frequency"),
  optimalDuration: integer("optimal_duration"),
  optimalIntensity: varchar("optimal_intensity", { length: 50 }),
  avgRecoveryTime: integer("avg_recovery_time"),
  mostEffectiveFor: text("most_effective_for"),
  workoutCount: integer("workout_count"),
  userCount: integer("user_count"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const physicalProfiles = pgTable("physical_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  fitnessLevel: varchar("fitness_level", { length: 50 }),
  height: integer("height"),
  weight: numeric("weight"),
  bodyFatPercentage: numeric("body_fat_percentage"),
  primaryGoal: varchar("primary_goal", { length: 50 }),
  specificGoals: text("specific_goals"),
  injuries: text("injuries"),
  injuryHistory: text("injury_history"),
  limitations: text("limitations"),
  experienceLevel: text("experience_level"),
  preferredExerciseTypes: text("preferred_exercise_types"),
  availableEquipment: text("available_equipment"),
  timeAvailable: integer("time_available"),
  optimalTrainingFrequency: integer("optimal_training_frequency"),
  optimalSessionDuration: integer("optimal_session_duration"),
  bestRecoveryStrategies: text("best_recovery_strategies"),
  injuryRiskFactors: text("injury_risk_factors"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const platformAnalytics = pgTable("platformAnalytics", {
  id: integer("id").primaryKey().notNull(),
  metricType: varchar("metric_type", { length: 50 }),
  metricName: varchar("metric_name", { length: 255 }).notNull(),
  metricValue: text("metric_value").notNull(),
  sampleSize: integer("sample_size").notNull(),
  confidence: integer("confidence").notNull(),
  timeframe: varchar("timeframe", { length: 100 }).notNull(),
  demographics: text("demographics"),
  insights: text("insights"),
  actionable: varchar("actionable", { length: 50 }),
  implemented: varchar("implemented", { length: 50 }),
  calculatedAt: timestamp("calculated_at").notNull(),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const platformSettings = pgTable("platformSettings", {
  id: integer("id").primaryKey().notNull(),
  aiCoachingEnabled: varchar("ai_coaching_enabled", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const platformMetrics = pgTable("platform_metrics", {
  id: varchar("id", { length: 255 }).notNull(),
  metricDate: timestamp("metric_date").notNull(),
  totalUsers: integer("total_users"),
  activeUsers: integer("active_users"),
  newUsers: integer("new_users"),
  churnedUsers: integer("churned_users"),
  avgSessionDuration: numeric("avg_session_duration"),
  avgDailyActiveUsers: integer("avg_daily_active_users"),
  avgWeeklyActiveUsers: integer("avg_weekly_active_users"),
  avgMonthlyActiveUsers: integer("avg_monthly_active_users"),
  totalGoals: integer("total_goals"),
  totalHabits: integer("total_habits"),
  totalJournalEntries: integer("total_journal_entries"),
  openTickets: integer("open_tickets"),
  avgTicketResolutionTime: numeric("avg_ticket_resolution_time"),
  avgSatisfactionRating: numeric("avg_satisfaction_rating"),
  apiRequests: integer("api_requests"),
  avgResponseTime: numeric("avg_response_time"),
  errorRate: numeric("error_rate"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const platformRecommendations = pgTable("platform_recommendations", {
  id: varchar("id", { length: 255 }).notNull(),
  recommendationType: varchar("recommendation_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description").notNull(),
  howToImplement: text("how_to_implement"),
  evidenceLevel: varchar("evidence_level", { length: 50 }),
  primaryResearchId: varchar("primary_research_id", { length: 255 }).notNull(),
  supportingResearchIds: text("supporting_research_ids"),
  confidenceScore: integer("confidence_score"),
  domain: varchar("domain", { length: 100 }).notNull(),
  targetAudience: text("target_audience"),
  contraindications: text("contraindications"),
  totalUses: integer("total_uses").default(0),
  successRate: numeric("success_rate"),
  avgEffectivenessRating: numeric("avg_effectiveness_rating"),
  status: varchar("status", { length: 50 }),
  supersededBy: varchar("superseded_by", { length: 255 }),
  supersededReason: text("superseded_reason"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
  createdBy: varchar("created_by", { length: 255 }),
});

export const predictions = pgTable("predictions", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  predictionType: varchar("prediction_type", { length: 50 }),
  targetId: varchar("target_id", { length: 255 }),
  targetName: varchar("target_name", { length: 255 }),
  prediction: text("prediction"),
  confidence: numeric("confidence"),
  timeframe: varchar("timeframe", { length: 100 }),
  keyFactors: text("key_factors"),
  recommendation: text("recommendation"),
  actualOutcome: text("actual_outcome"),
  predictionAccurate: boolean("prediction_accurate"),
  createdAt: timestamp("created_at").defaultNow(),
  validatedAt: timestamp("validated_at"),
});

export const principleGoals = pgTable("principle_goals", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  goalTitle: varchar("goal_title", { length: 255 }).notNull(),
  goalDescription: text("goal_description"),
  primaryPrinciple: varchar("primary_principle", { length: 255 }).notNull(),
  supportingPrinciples: text("supporting_principles"),
  identityStatement: text("identity_statement"),
  targetDate: timestamp("target_date"),
  milestones: text("milestones"),
  progress: integer("progress"),
  whyItMatters: text("why_it_matters"),
  status: varchar("status", { length: 50 }),
  achievedDate: timestamp("achieved_date"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const principlePractices = pgTable("principle_practices", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  practiceDate: timestamp("practice_date").notNull(),
  principleId: varchar("principle_id", { length: 255 }).notNull(),
  principleNumber: integer("principle_number").notNull(),
  practiceType: varchar("practice_type", { length: 50 }),
  timeSpent: integer("time_spent"),
  completed: boolean("completed").default(true),
  reflectionNotes: text("reflection_notes"),
  insights: text("insights"),
  actionsTaken: text("actions_taken"),
  challengesFaced: text("challenges_faced"),
  winsAchieved: text("wins_achieved"),
  impactOnDay: integer("impact_on_day"),
  embodimentLevel: integer("embodiment_level"),
  moodBefore: varchar("mood_before", { length: 100 }),
  moodAfter: varchar("mood_after", { length: 100 }),
  createdAt: timestamp("created_at").defaultNow(),
});

export const principleProgress = pgTable("principle_progress", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  principleId: varchar("principle_id", { length: 255 }).notNull(),
  masteryLevel: integer("mastery_level"),
  totalPractices: integer("total_practices"),
  currentStreak: integer("current_streak"),
  longestStreak: integer("longest_streak"),
  avgEmbodimentLevel: numeric("avg_embodiment_level"),
  avgLifeImpact: numeric("avg_life_impact"),
  lifeAreasImproved: text("life_areas_improved"),
  milestones: text("milestones"),
  lastPracticed: timestamp("last_practiced"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const principles = pgTable("principles", {
  id: varchar("id", { length: 255 }).notNull(),
  principleNumber: integer("principle_number").notNull(),
  principleName: varchar("principle_name", { length: 255 }).notNull(),
  identityStatement: varchar("identity_statement", { length: 255 }).notNull(),
  coreTeaching: text("core_teaching"),
  whyItMatters: text("why_it_matters"),
  dailyPractice: text("daily_practice"),
  reflectionPrompts: text("reflection_prompts"),
  keyHabits: text("key_habits"),
  lifeApplications: text("life_applications"),
  researchBasis: text("research_basis"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const privacySettings = pgTable("privacy_settings", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  profileVisibility: varchar("profile_visibility", { length: 50 }),
  shareDataForResearch: boolean("share_data_for_research").default(false),
  shareDataForAi: boolean("share_data_for_ai").default(true),
  shareProgressWithCommunity: boolean("share_progress_with_community").default(false),
  showActivityFeed: boolean("show_activity_feed").default(false),
  showGoals: boolean("show_goals").default(false),
  showAchievements: boolean("show_achievements").default(true),
  showStats: boolean("show_stats").default(false),
  allowFriendRequests: boolean("allow_friend_requests").default(true),
  allowMessages: boolean("allow_messages").default(true),
  searchable: boolean("searchable").default(false),
  allowAnalyticsCookies: boolean("allow_analytics_cookies").default(true),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const proactiveCheckIns = pgTable("proactive_check_ins", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  checkInType: varchar("check_in_type", { length: 50 }),
  triggerType: varchar("trigger_type", { length: 50 }),
  message: text("message"),
  responded: boolean("responded").default(false),
  respondedAt: timestamp("responded_at"),
  responseQuality: varchar("response_quality", { length: 50 }),
  helpful: boolean("helpful"),
  sentAt: timestamp("sent_at").defaultNow(),
});

export const professionalBoundaryViolations = pgTable("professional_boundary_violations", {
  id: varchar("id", { length: 255 }).notNull(),
  violationType: varchar("violation_type", { length: 50 }),
  conversationId: varchar("conversation_id", { length: 255 }),
  userId: varchar("user_id", { length: 255 }),
  coachId: varchar("coach_id", { length: 255 }),
  violatingContent: text("violating_content"),
  context: text("context"),
  detectedBy: varchar("detected_by", { length: 50 }),
  severity: varchar("severity", { length: 50 }),
  correctionProvided: text("correction_provided"),
  educationProvided: text("education_provided"),
  coachNotified: boolean("coach_notified").default(false),
  trainingRequired: boolean("training_required").default(false),
  detectedAt: timestamp("detected_at").defaultNow(),
  resolvedAt: timestamp("resolved_at"),
});

export const progressCelebrations = pgTable("progress_celebrations", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  celebrationType: varchar("celebration_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  icon: varchar("icon", { length: 255 }),
  color: varchar("color", { length: 50 }),
  animation: varchar("animation", { length: 100 }),
  relatedId: varchar("related_id", { length: 255 }),
  relatedType: varchar("related_type", { length: 100 }),
  displayed: boolean("displayed").default(false),
  displayedAt: timestamp("displayed_at"),
  celebrationDate: timestamp("celebration_date").defaultNow(),
});

export const progressMilestones = pgTable("progress_milestones", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  milestoneType: varchar("milestone_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  metric: varchar("metric", { length: 255 }),
  baselineValue: numeric("baseline_value"),
  currentValue: numeric("current_value"),
  improvementPercent: numeric("improvement_percent"),
  relatedTo: varchar("related_to", { length: 255 }),
  achievedAt: timestamp("achieved_at").defaultNow(),
});

export const progressSnapshots = pgTable("progress_snapshots", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  snapshotDate: timestamp("snapshot_date").notNull(),
  overallScore: integer("overall_score"),
  physicalScore: integer("physical_score"),
  mentalScore: integer("mental_score"),
  emotionalScore: integer("emotional_score"),
  spiritualScore: integer("spiritual_score"),
  habitCompletionRate: numeric("habit_completion_rate"),
  activeHabits: integer("active_habits"),
  goalsOnTrack: integer("goals_on_track"),
  goalsAtRisk: integer("goals_at_risk"),
  goalsAchievedThisPeriod: integer("goals_achieved_this_period"),
  avgSleepDuration: numeric("avg_sleep_duration"),
  avgSleepQuality: numeric("avg_sleep_quality"),
  avgStressLevel: numeric("avg_stress_level"),
  avgHrv: numeric("avg_hrv"),
  avgMood: numeric("avg_mood"),
  avgEnergy: numeric("avg_energy"),
  daysActive: integer("days_active"),
  journalEntries: integer("journal_entries"),
  achievementsUnlocked: integer("achievements_unlocked"),
  experiencePoints: integer("experience_points"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const promptEffectiveness = pgTable("prompt_effectiveness", {
  id: varchar("id", { length: 255 }).notNull(),
  promptId: varchar("prompt_id", { length: 255 }).notNull(),
  totalUses: integer("total_uses").default(0),
  avgWordCount: numeric("avg_word_count"),
  avgWritingDuration: numeric("avg_writing_duration"),
  avgMoodImprovement: numeric("avg_mood_improvement"),
  avgHelpfulnessRating: numeric("avg_helpfulness_rating"),
  avgInsightsGenerated: numeric("avg_insights_generated"),
  mostEffectiveForEmotions: text("most_effective_for_emotions"),
  mostEffectiveForSituations: text("most_effective_for_situations"),
  userCount: integer("user_count"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const pseudoscienceBlocklist = pgTable("pseudoscience_blocklist", {
  id: varchar("id", { length: 255 }).notNull(),
  claim: text("claim").notNull(),
  category: varchar("category", { length: 50 }),
  reason: text("reason").notNull(),
  evidenceAgainst: text("evidence_against"),
  severity: varchar("severity", { length: 50 }),
  action: varchar("action", { length: 50 }),
  detectionCount: integer("detection_count").default(0),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
  createdBy: varchar("created_by", { length: 255 }),
});

export const purposeActivities = pgTable("purpose_activities", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  activityDate: timestamp("activity_date").notNull(),
  activityType: varchar("activity_type", { length: 50 }),
  insights: text("insights"),
  patterns: text("patterns"),
  emotions: text("emotions"),
  passions: text("passions"),
  strengths: text("strengths"),
  values: text("values"),
  impact: text("impact"),
  actionSteps: text("action_steps"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const purposeExplorations = pgTable("purpose_explorations", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  explorationDate: timestamp("exploration_date").notNull(),
  explorationType: varchar("exploration_type", { length: 50 }),
  prompt: text("prompt"),
  reflection: text("reflection").notNull(),
  insights: text("insights"),
  patterns: text("patterns"),
  passions: text("passions"),
  strengths: text("strengths"),
  values: text("values"),
  contribution: text("contribution"),
  clarityLevel: integer("clarity_level"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const pushTokens = pgTable("push_tokens", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  token: varchar("token", { length: 500 }).notNull(),
  platform: varchar("platform", { length: 50 }),
  deviceId: varchar("device_id", { length: 255 }),
  deviceName: varchar("device_name", { length: 255 }),
  active: boolean("active").default(true),
  lastUsedAt: timestamp("last_used_at"),
  registeredAt: timestamp("registered_at").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const rateLimits = pgTable("rate_limits", {
  id: varchar("id", { length: 255 }).notNull(),
  identifier: varchar("identifier", { length: 255 }).notNull(),
  identifierType: varchar("identifier_type", { length: 50 }),
  endpoint: varchar("endpoint", { length: 500 }),
  requestsPerMinute: integer("requests_per_minute"),
  requestsPerHour: integer("requests_per_hour"),
  requestsPerDay: integer("requests_per_day"),
  requestsThisMinute: integer("requests_this_minute").default(0),
  requestsThisHour: integer("requests_this_hour").default(0),
  requestsToday: integer("requests_today").default(0),
  minuteResetAt: timestamp("minute_reset_at"),
  hourResetAt: timestamp("hour_reset_at"),
  dayResetAt: timestamp("day_reset_at"),
  throttled: boolean("throttled").default(false),
  throttledUntil: timestamp("throttled_until"),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const readingSessions = pgTable("reading_sessions", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  sessionDate: timestamp("session_date").notNull(),
  contentType: varchar("content_type", { length: 50 }),
  title: varchar("title", { length: 255 }),
  author: varchar("author", { length: 255 }),
  pagesRead: integer("pages_read"),
  duration: integer("duration"),
  wordsPerMinute: integer("words_per_minute"),
  comprehensionLevel: integer("comprehension_level"),
  retentionLevel: integer("retention_level"),
  activeReading: boolean("active_reading"),
  speedReading: boolean("speed_reading"),
  skimming: boolean("skimming"),
  notesTaken: boolean("notes_taken"),
  summaryWritten: boolean("summary_written"),
  valueRating: integer("value_rating"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const recognitionEvents = pgTable("recognition_events", {
  id: integer("id").primaryKey().notNull(),
  userId: integer("user_id"),
  sessionId: integer("session_id"),
  recognitionType: varchar("recognition_type", { length: 20 }).notNull(),
  recognitionResult: varchar("recognition_result", { length: 20 }).notNull(),
  confidenceScore: integer("confidence_score"),
  attemptedUserId: integer("attempted_user_id"),
  actualUserId: integer("actual_user_id"),
  metadata: jsonb("metadata"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const recommendationFeedback = pgTable("recommendationFeedback", {
  id: integer("id").primaryKey().notNull(),
  clientId: integer("client_id").notNull(),
  recommendationType: varchar("recommendation_type", { length: 100 }).notNull(),
  recommendationContent: text("recommendation_content").notNull(),
  context: text("context"),
  wasUsed: varchar("was_used", { length: 50 }),
  wasHelpful: varchar("was_helpful", { length: 50 }),
  rating: integer("rating"),
  feedbackNotes: text("feedback_notes"),
  problemResolved: varchar("problem_resolved", { length: 50 }),
  timeToResolution: integer("time_to_resolution"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const recoveryMilestones = pgTable("recovery_milestones", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  milestoneType: varchar("milestone_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  targetDate: timestamp("target_date"),
  achievedDate: timestamp("achieved_date"),
  progress: integer("progress"),
  status: varchar("status", { length: 50 }),
  notes: text("notes"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const recoveryTracking = pgTable("recovery_tracking", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  trackingDate: timestamp("tracking_date").notNull(),
  recoveryScore: integer("recovery_score"),
  restingHeartRate: integer("resting_heart_rate"),
  hrv: integer("hrv"),
  sleepQuality: integer("sleep_quality"),
  sleepHours: numeric("sleep_hours"),
  overallSoreness: integer("overall_soreness"),
  soreAreas: text("sore_areas"),
  energyLevel: integer("energy_level"),
  readinessToTrain: integer("readiness_to_train"),
  stressLevel: integer("stress_level"),
  recoveryStrategies: text("recovery_strategies"),
  recommendedAction: varchar("recommended_action", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
});

export const relationshipProfiles = pgTable("relationship_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  relationshipType: varchar("relationship_type", { length: 50 }),
  relationshipStatus: varchar("relationship_status", { length: 50 }),
  relationshipDuration: integer("relationship_duration"),
  partnerInvolved: boolean("partner_involved").default(false),
  partnerUserId: varchar("partner_user_id", { length: 255 }),
  attachmentStyle: varchar("attachment_style", { length: 50 }),
  partnerAttachmentStyle: varchar("partner_attachment_style", { length: 50 }),
  primaryLoveLanguage: varchar("primary_love_language", { length: 50 }),
  secondaryLoveLanguage: varchar("secondary_love_language", { length: 50 }),
  partnerPrimaryLoveLanguage: varchar("partner_primary_love_language", { length: 50 }),
  partnerSecondaryLoveLanguage: varchar("partner_secondary_love_language", { length: 50 }),
  primaryGoal: varchar("primary_goal", { length: 50 }),
  specificGoals: text("specific_goals"),
  mainChallenges: text("main_challenges"),
  conflictFrequency: varchar("conflict_frequency", { length: 50 }),
  criticismLevel: integer("criticism_level"),
  contemptLevel: integer("contempt_level"),
  defensivenessLevel: integer("defensiveness_level"),
  stonewallingLevel: integer("stonewalling_level"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const relationshipRituals = pgTable("relationship_rituals", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  ritualType: varchar("ritual_type", { length: 50 }),
  ritualName: varchar("ritual_name", { length: 255 }).notNull(),
  description: text("description"),
  frequency: varchar("frequency", { length: 50 }),
  lastCompleted: timestamp("last_completed"),
  completionCount: integer("completion_count").default(0),
  currentStreak: integer("current_streak").default(0),
  longestStreak: integer("longest_streak").default(0),
  connectionImpact: integer("connection_impact"),
  active: boolean("active").default(true),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const reminderOccurrences = pgTable("reminder_occurrences", {
  id: varchar("id", { length: 255 }).notNull(),
  reminderId: varchar("reminder_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  scheduledFor: timestamp("scheduled_for").notNull(),
  status: varchar("status", { length: 50 }),
  snoozedUntil: timestamp("snoozed_until"),
  snoozeCount: integer("snooze_count").default(0),
  completedAt: timestamp("completed_at"),
  notificationId: varchar("notification_id", { length: 255 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const reminders = pgTable("reminders", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  reminderType: varchar("reminder_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  relatedId: varchar("related_id", { length: 255 }),
  relatedType: varchar("related_type", { length: 100 }),
  scheduleType: varchar("schedule_type", { length: 50 }),
  reminderTime: varchar("reminder_time", { length: 10 }),
  daysOfWeek: text("days_of_week"),
  dayOfMonth: integer("day_of_month"),
  customRecurrence: text("custom_recurrence"),
  leadTimeMinutes: integer("lead_time_minutes"),
  snoozeEnabled: boolean("snooze_enabled").default(true),
  snoozeDurationMinutes: integer("snooze_duration_minutes").default(10),
  active: boolean("active").default(true),
  nextOccurrence: timestamp("next_occurrence"),
  totalSent: integer("total_sent").default(0),
  totalCompleted: integer("total_completed").default(0),
  totalSnoozed: integer("total_snoozed").default(0),
  completionRate: numeric("completion_rate"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const repairAttempts = pgTable("repair_attempts", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  attemptDate: timestamp("attempt_date").notNull(),
  conflictDescription: text("conflict_description"),
  repairStrategy: varchar("repair_strategy", { length: 50 }),
  repairDetails: text("repair_details"),
  partnerResponse: varchar("partner_response", { length: 50 }),
  conflictResolved: boolean("conflict_resolved"),
  connectionRestored: boolean("connection_restored"),
  effectiveness: integer("effectiveness"),
  whatLearned: text("what_learned"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const reportGenerations = pgTable("report_generations", {
  id: varchar("id", { length: 255 }).notNull(),
  reportId: varchar("report_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  generatedAt: timestamp("generated_at").defaultNow(),
  reportData: text("report_data"),
  filePath: varchar("file_path", { length: 500 }),
  status: varchar("status", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
});

export const researchMonitoring = pgTable("research_monitoring", {
  id: varchar("id", { length: 255 }).notNull(),
  topic: varchar("topic", { length: 255 }).notNull(),
  keywords: text("keywords"),
  domain: varchar("domain", { length: 100 }),
  monitoringFrequency: varchar("monitoring_frequency", { length: 50 }),
  alertOnHighQuality: boolean("alert_on_high_quality").default(true),
  alertOnContradiction: boolean("alert_on_contradiction").default(true),
  lastCheckedAt: timestamp("last_checked_at"),
  newStudiesFound: integer("new_studies_found").default(0),
  active: boolean("active").default(true),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const researchQualityReviews = pgTable("research_quality_reviews", {
  id: varchar("id", { length: 255 }).notNull(),
  researchId: varchar("research_id", { length: 255 }).notNull(),
  reviewerId: varchar("reviewer_id", { length: 255 }).notNull(),
  reviewerName: varchar("reviewer_name", { length: 255 }),
  reviewerCredentials: text("reviewer_credentials"),
  methodologyScore: integer("methodology_score"),
  sampleSizeAdequate: boolean("sample_size_adequate"),
  statisticalRigor: integer("statistical_rigor"),
  clinicalRelevance: integer("clinical_relevance"),
  replicationStatus: varchar("replication_status", { length: 50 }),
  selectionBias: boolean("selection_bias"),
  publicationBias: boolean("publication_bias"),
  confirmationBias: boolean("confirmation_bias"),
  overallQuality: varchar("overall_quality", { length: 50 }),
  recommendForPlatform: boolean("recommend_for_platform").notNull(),
  recommendedEvidenceLevel: varchar("recommended_evidence_level", { length: 50 }),
  reviewNotes: text("review_notes"),
  concerns: text("concerns"),
  reviewedAt: timestamp("reviewed_at").defaultNow(),
});

export const resilienceActivities = pgTable("resilience_activities", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  activityDate: timestamp("activity_date").notNull(),
  activityType: varchar("activity_type", { length: 50 }),
  activity: varchar("activity", { length: 255 }).notNull(),
  description: text("description"),
  duration: integer("duration"),
  resilienceImpact: integer("resilience_impact"),
  emotionalImpact: integer("emotional_impact"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const safetyAnalytics = pgTable("safety_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  periodStart: timestamp("period_start").notNull(),
  periodEnd: timestamp("period_end").notNull(),
  totalInteractions: integer("total_interactions"),
  violationsDetected: integer("violations_detected"),
  violationRate: numeric("violation_rate"),
  legalViolations: integer("legal_violations"),
  ethicalViolations: integer("ethical_violations"),
  brandSafetyIssues: integer("brand_safety_issues"),
  crisisInterventions: integer("crisis_interventions"),
  contentBlocked: integer("content_blocked"),
  contentFlagged: integer("content_flagged"),
  usersEscalated: integer("users_escalated"),
  falsePositiveRate: numeric("false_positive_rate"),
  falseNegativeRate: numeric("false_negative_rate"),
  newPatternsDetected: integer("new_patterns_detected"),
  rulesUpdated: integer("rules_updated"),
  dictionaryExpanded: integer("dictionary_expanded"),
  generatedAt: timestamp("generated_at").defaultNow(),
});

export const safetyPlans = pgTable("safety_plans", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  warningSigns: text("warning_signs"),
  internalCopingStrategies: text("internal_coping_strategies"),
  socialDistractions: text("social_distractions"),
  supportContacts: text("support_contacts"),
  professionalContacts: text("professional_contacts"),
  crisisHotlines: text("crisis_hotlines"),
  emergencyServices: text("emergency_services"),
  meansRestriction: text("means_restriction"),
  reasonsForLiving: text("reasons_for_living"),
  lastReviewed: timestamp("last_reviewed"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const savingsGoals = pgTable("savings_goals", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  goalType: varchar("goal_type", { length: 50 }),
  goalName: varchar("goal_name", { length: 255 }).notNull(),
  description: text("description"),
  targetAmount: numeric("target_amount").notNull(),
  currentAmount: numeric("current_amount"),
  startDate: timestamp("start_date"),
  targetDate: timestamp("target_date"),
  monthlyContribution: numeric("monthly_contribution"),
  percentComplete: integer("percent_complete").default(0),
  whyItMatters: text("why_it_matters"),
  visualReminder: varchar("visual_reminder", { length: 255 }),
  status: varchar("status", { length: 50 }),
  completedDate: timestamp("completed_date"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const securityAlerts = pgTable("security_alerts", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }),
  alertType: varchar("alert_type", { length: 50 }),
  severity: varchar("severity", { length: 50 }),
  message: text("message"),
  actionRequired: boolean("action_required").default(false),
  actionUrl: varchar("action_url", { length: 500 }),
  acknowledged: boolean("acknowledged").default(false),
  acknowledgedAt: timestamp("acknowledged_at"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const securityIncidents = pgTable("security_incidents", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }),
  incidentType: varchar("incident_type", { length: 50 }),
  severity: varchar("severity", { length: 50 }),
  description: text("description"),
  detectedBy: varchar("detected_by", { length: 100 }),
  detectionMethod: varchar("detection_method", { length: 255 }),
  status: varchar("status", { length: 50 }),
  responseActions: text("response_actions"),
  impactAssessment: text("impact_assessment"),
  affectedUsers: integer("affected_users"),
  dataCompromised: boolean("data_compromised").default(false),
  resolvedBy: varchar("resolved_by", { length: 255 }),
  resolutionNotes: text("resolution_notes"),
  detectedAt: timestamp("detected_at").defaultNow(),
  resolvedAt: timestamp("resolved_at"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const securityProfiles = pgTable("security_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  mfaEnabled: boolean("mfa_enabled").default(false),
  mfaMethod: varchar("mfa_method", { length: 50 }),
  mfaSecret: varchar("mfa_secret", { length: 500 }),
  mfaBackupCodes: text("mfa_backup_codes"),
  passwordHash: varchar("password_hash", { length: 500 }).notNull(),
  passwordSalt: varchar("password_salt", { length: 255 }),
  passwordLastChanged: timestamp("password_last_changed"),
  passwordExpiresAt: timestamp("password_expires_at"),
  requirePasswordChange: boolean("require_password_change").default(false),
  securityQuestions: text("security_questions"),
  accountLocked: boolean("account_locked").default(false),
  accountLockedUntil: timestamp("account_locked_until"),
  accountLockedReason: text("account_locked_reason"),
  failedLoginAttempts: integer("failed_login_attempts").default(0),
  lastFailedLoginAt: timestamp("last_failed_login_at"),
  suspiciousActivityDetected: boolean("suspicious_activity_detected").default(false),
  suspiciousActivityCount: integer("suspicious_activity_count").default(0),
  ipWhitelistEnabled: boolean("ip_whitelist_enabled").default(false),
  ipWhitelist: text("ip_whitelist"),
  maxActiveSessions: integer("max_active_sessions").default(5),
  sessionTimeout: integer("session_timeout").default(3600),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const sessionRecordings = pgTable("sessionRecordings", {
  id: integer("id").primaryKey().notNull(),
  sessionId: integer("session_id").notNull(),
  clientId: integer("client_id").notNull(),
  coachId: integer("coach_id").notNull(),
  videoUrl: text("video_url"),
  videoKey: varchar("video_key", { length: 500 }),
  audioUrl: text("audio_url"),
  audioKey: varchar("audio_key", { length: 500 }),
  transcriptUrl: text("transcript_url"),
  transcriptKey: varchar("transcript_key", { length: 500 }),
  duration: integer("duration"),
  fileSize: integer("file_size"),
  status: varchar("status", { length: 50 }),
  clientCanAccess: varchar("client_can_access", { length: 50 }),
  consentGiven: varchar("consent_given", { length: 50 }),
  recordedAt: timestamp("recorded_at").notNull(),
  expiresAt: timestamp("expires_at"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const sessionReminders = pgTable("sessionReminders", {
  id: integer("id").primaryKey().notNull(),
  sessionId: integer("session_id").notNull(),
  reminderType: varchar("reminder_type", { length: 50 }),
  sentAt: timestamp("sent_at").defaultNow().notNull(),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const sessionSummaries = pgTable("sessionSummaries", {
  id: integer("id").primaryKey().notNull(),
  sessionId: integer("session_id").notNull(),
  recordingId: integer("recording_id"),
  summary: text("summary").notNull(),
  goals: text("goals"),
  homework: text("homework"),
  keyMoments: text("key_moments"),
  emotionTimeline: text("emotion_timeline"),
  techniquesUsed: text("techniques_used"),
  nextSteps: text("next_steps"),
  clientProgress: text("client_progress"),
  generatedAt: timestamp("generated_at").notNull(),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const sessionTypes = pgTable("sessionTypes", {
  id: integer("id").primaryKey().notNull(),
  coachId: integer("coach_id").notNull(),
  name: varchar("name", { length: 100 }).notNull(),
  description: text("description"),
  duration: integer("duration").notNull(),
  price: integer("price").notNull(),
  stripePriceId: varchar("stripe_price_id", { length: 255 }),
  oneTimePriceId: varchar("one_time_price_id", { length: 255 }),
  subscriptionPrice: integer("subscription_price"),
  isActive: varchar("is_active", { length: 50 }),
  displayOrder: integer("display_order").default(0).notNull(),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const sessionDurationOptions = pgTable("session_duration_options", {
  id: integer("id").primaryKey().notNull(),
  coachId: integer("coach_id").notNull(),
  duration: integer("duration").notNull(),
  label: varchar("label", { length: 100 }).notNull(),
  isActive: boolean("is_active").default(true).notNull(),
  displayOrder: integer("display_order").default(0).notNull(),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const sessionPreferences = pgTable("session_preferences", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  sessionId: varchar("session_id", { length: 255 }).notNull(),
  preferences: text("preferences"),
  expiresAt: timestamp("expires_at"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const sessions = pgTable("sessions", {
  id: integer("id").primaryKey().notNull(),
  coachId: integer("coach_id").notNull(),
  clientId: integer("client_id"),
  sessionTypeId: integer("session_type_id"),
  scheduledDate: timestamp("scheduled_date").notNull(),
  duration: integer("duration").notNull(),
  price: integer("price"),
  sessionType: varchar("session_type", { length: 100 }),
  notes: text("notes"),
  status: varchar("status", { length: 50 }),
  paymentStatus: varchar("payment_status", { length: 50 }),
  stripePaymentIntentId: varchar("stripe_payment_intent_id", { length: 255 }),
  stripeSessionId: varchar("stripe_session_id", { length: 255 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
  videoUrl: text("video_url"),
  videoDuration: integer("video_duration"),
  videoFileSize: integer("video_file_size"),
  startTime: timestamp("start_time"),
  endTime: timestamp("end_time"),
});

export const settingsChangeLog = pgTable("settings_change_log", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  settingCategory: varchar("setting_category", { length: 100 }).notNull(),
  settingName: varchar("setting_name", { length: 100 }).notNull(),
  oldValue: text("old_value"),
  newValue: text("new_value"),
  changedBy: varchar("changed_by", { length: 100 }),
  ipAddress: varchar("ip_address", { length: 50 }),
  changedAt: timestamp("changed_at").defaultNow(),
});

export const similarCases = pgTable("similarCases", {
  id: integer("id").primaryKey().notNull(),
  caseTitle: varchar("case_title", { length: 255 }).notNull(),
  caseDescription: text("case_description").notNull(),
  clientIssues: text("client_issues").notNull(),
  interventions: text("interventions").notNull(),
  outcome: text("outcome").notNull(),
  successRating: integer("success_rating").notNull(),
  timeToResolution: integer("time_to_resolution"),
  coachNotes: text("coach_notes"),
  tags: text("tags"),
  isPublic: varchar("is_public", { length: 50 }),
  createdBy: integer("created_by").notNull(),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const simpleBookings = pgTable("simple_bookings", {
  id: integer("id").primaryKey().notNull(),
  coachId: integer("coach_id").notNull(),
  clientName: varchar("client_name", { length: 255 }).notNull(),
  clientEmail: varchar("client_email", { length: 255 }).notNull(),
  clientPhone: varchar("client_phone", { length: 50 }),
  bookingDateTime: timestamp("booking_date_time").notNull(),
  duration: integer("duration").default(15).notNull(),
  status: varchar("status", { length: 50 }).notNull(),
  notes: text("notes"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const skillDevelopment = pgTable("skill_development", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  skillName: varchar("skill_name", { length: 255 }).notNull(),
  skillCategory: varchar("skill_category", { length: 50 }),
  currentLevel: varchar("current_level", { length: 50 }),
  targetLevel: varchar("target_level", { length: 50 }),
  learningResources: text("learning_resources"),
  practiceActivities: text("practice_activities"),
  hoursInvested: numeric("hours_invested"),
  completedMilestones: text("completed_milestones"),
  projectsUsed: text("projects_used"),
  certificationsEarned: text("certifications_earned"),
  startDate: timestamp("start_date"),
  targetCompletionDate: timestamp("target_completion_date"),
  completionDate: timestamp("completion_date"),
  status: varchar("status", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const sleepAnalytics = pgTable("sleep_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  practice: varchar("practice", { length: 100 }).notNull(),
  avgSleepQualityImprovement: numeric("avg_sleep_quality_improvement"),
  avgSleepDurationImprovement: numeric("avg_sleep_duration_improvement"),
  optimalImplementationTime: varchar("optimal_implementation_time", { length: 100 }),
  mostEffectiveFor: text("most_effective_for"),
  userCount: integer("user_count"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const sleepExperiments = pgTable("sleep_experiments", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  experimentName: varchar("experiment_name", { length: 255 }).notNull(),
  hypothesis: text("hypothesis"),
  variable: varchar("variable", { length: 255 }).notNull(),
  startDate: timestamp("start_date"),
  endDate: timestamp("end_date"),
  duration: integer("duration"),
  baselineSleepQuality: numeric("baseline_sleep_quality"),
  baselineSleepDuration: numeric("baseline_sleep_duration"),
  avgSleepQualityDuringExperiment: numeric("avg_sleep_quality_during_experiment"),
  avgSleepDurationDuringExperiment: numeric("avg_sleep_duration_during_experiment"),
  improvement: numeric("improvement"),
  conclusion: text("conclusion"),
  keepPractice: boolean("keep_practice"),
  status: varchar("status", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const sleepHygienePractices = pgTable("sleep_hygiene_practices", {
  id: varchar("id", { length: 255 }).notNull(),
  sleepTrackingId: varchar("sleep_tracking_id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  practiceDate: timestamp("practice_date").notNull(),
  noScreens1HourBefore: boolean("no_screens_1_hour_before"),
  dimLightsEvening: boolean("dim_lights_evening"),
  coolRoomTemp: boolean("cool_room_temp"),
  darkRoom: boolean("dark_room"),
  quietEnvironment: boolean("quiet_environment"),
  consistentBedtime: boolean("consistent_bedtime"),
  consistentWakeTime: boolean("consistent_wake_time"),
  noCaffeineAfter2Pm: boolean("no_caffeine_after_2pm"),
  noAlcohol: boolean("no_alcohol"),
  noHeavyMealBefore3Hours: boolean("no_heavy_meal_before_3_hours"),
  morningLightExposure: boolean("morning_light_exposure"),
  exercisedToday: boolean("exercised_today"),
  noNapsAfter3Pm: boolean("no_naps_after_3pm"),
  relaxationPractice: varchar("relaxation_practice", { length: 50 }),
  supplements: text("supplements"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const sleepInsights = pgTable("sleep_insights", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  insightType: varchar("insight_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  supportingData: text("supporting_data"),
  actionRecommended: text("action_recommended"),
  priority: varchar("priority", { length: 50 }),
  acknowledged: boolean("acknowledged").default(false),
  actionTaken: boolean("action_taken").default(false),
  createdAt: timestamp("created_at").defaultNow(),
});

export const sleepMemoryTracking = pgTable("sleep_memory_tracking", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  trackingDate: timestamp("tracking_date").notNull(),
  studiedBeforeSleep: boolean("studied_before_sleep"),
  studyTopics: text("study_topics"),
  studyDuration: integer("study_duration"),
  sleepQuality: integer("sleep_quality"),
  sleepDuration: numeric("sleep_duration"),
  deepSleepMinutes: integer("deep_sleep_minutes"),
  morningRecallTest: boolean("morning_recall_test"),
  morningRecallAccuracy: numeric("morning_recall_accuracy"),
  consolidationEffect: numeric("consolidation_effect"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const sleepPerformanceCorrelations = pgTable("sleep_performance_correlations", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  performanceArea: varchar("performance_area", { length: 50 }),
  correlationCoefficient: numeric("correlation_coefficient"),
  optimalSleepDuration: numeric("optimal_sleep_duration"),
  optimalSleepQuality: integer("optimal_sleep_quality"),
  dataPoints: integer("data_points"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const sleepProfiles = pgTable("sleep_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  targetSleepDuration: numeric("target_sleep_duration"),
  targetBedtime: varchar("target_bedtime", { length: 10 }),
  targetWakeTime: varchar("target_wake_time", { length: 10 }),
  chronotype: varchar("chronotype", { length: 50 }),
  sleepIssues: text("sleep_issues"),
  trackingMethod: varchar("tracking_method", { length: 50 }),
  wearableDevice: varchar("wearable_device", { length: 100 }),
  personalSleepNeed: numeric("personal_sleep_need"),
  optimalBedtime: varchar("optimal_bedtime", { length: 10 }),
  optimalWakeTime: varchar("optimal_wake_time", { length: 10 }),
  sleepPerformanceCorrelations: text("sleep_performance_correlations"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const sleepSessions = pgTable("sleep_sessions", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  sleepDate: timestamp("sleep_date").notNull(),
  bedTime: timestamp("bed_time"),
  wakeTime: timestamp("wake_time"),
  totalTimeInBed: integer("total_time_in_bed"),
  totalSleepTime: integer("total_sleep_time"),
  sleepEfficiency: integer("sleep_efficiency"),
  awakeDuration: integer("awake_duration"),
  lightSleepDuration: integer("light_sleep_duration"),
  deepSleepDuration: integer("deep_sleep_duration"),
  remSleepDuration: integer("rem_sleep_duration"),
  sleepQuality: integer("sleep_quality"),
  timesToWake: integer("times_to_wake"),
  timeToFallAsleep: integer("time_to_fall_asleep"),
  caffeineAfter2Pm: boolean("caffeine_after_2pm"),
  alcoholBeforeBed: boolean("alcohol_before_bed"),
  screenTimeBeforeBed: integer("screen_time_before_bed"),
  exerciseToday: boolean("exercise_today"),
  stressLevel: integer("stress_level"),
  roomTemperature: integer("room_temperature"),
  noiseLevel: varchar("noise_level", { length: 50 }),
  lightLevel: varchar("light_level", { length: 50 }),
  morningEnergy: integer("morning_energy"),
  morningMood: varchar("morning_mood", { length: 100 }),
  dataSource: varchar("data_source", { length: 255 }),
  createdAt: timestamp("created_at").defaultNow(),
});

export const sleepTracking = pgTable("sleep_tracking", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  sleepDate: timestamp("sleep_date").notNull(),
  bedtime: timestamp("bedtime"),
  wakeTime: timestamp("wake_time"),
  timeInBed: numeric("time_in_bed"),
  actualSleepDuration: numeric("actual_sleep_duration"),
  sleepEfficiency: numeric("sleep_efficiency"),
  lightSleepMinutes: integer("light_sleep_minutes"),
  deepSleepMinutes: integer("deep_sleep_minutes"),
  remSleepMinutes: integer("rem_sleep_minutes"),
  awakeMinutes: integer("awake_minutes"),
  sleepQuality: integer("sleep_quality"),
  sleepScore: integer("sleep_score"),
  timesToWakeUp: integer("times_to_wake_up"),
  timeToFallAsleep: integer("time_to_fall_asleep"),
  restingHeartRate: integer("resting_heart_rate"),
  hrv: integer("hrv"),
  respiratoryRate: numeric("respiratory_rate"),
  bodyTemperature: numeric("body_temperature"),
  recoveryScore: integer("recovery_score"),
  readinessScore: integer("readiness_score"),
  morningMood: varchar("morning_mood", { length: 100 }),
  morningEnergy: integer("morning_energy"),
  morningFocus: integer("morning_focus"),
  hygieneScore: integer("hygiene_score"),
  notes: text("notes"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const smsQueue = pgTable("sms_queue", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  notificationId: varchar("notification_id", { length: 255 }),
  toPhone: varchar("to_phone", { length: 50 }).notNull(),
  message: text("message").notNull(),
  status: varchar("status", { length: 50 }),
  sentAt: timestamp("sent_at"),
  deliveredAt: timestamp("delivered_at"),
  errorMessage: text("error_message"),
  retryCount: integer("retry_count").default(0),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const spiritualEngineAnalytics = pgTable("spiritual_engine_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  practiceType: varchar("practice_type", { length: 100 }).notNull(),
  avgStressReduction: numeric("avg_stress_reduction"),
  avgPeaceIncrease: numeric("avg_peace_increase"),
  avgCompletionRate: numeric("avg_completion_rate"),
  optimalDuration: integer("optimal_duration"),
  optimalTimeOfDay: varchar("optimal_time_of_day", { length: 50 }),
  mostEffectiveFor: text("most_effective_for"),
  sessionCount: integer("session_count"),
  userCount: integer("user_count"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const spiritualExperiences = pgTable("spiritual_experiences", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  experienceDate: timestamp("experience_date").notNull(),
  experienceType: varchar("experience_type", { length: 50 }),
  context: text("context"),
  trigger: varchar("trigger", { length: 255 }),
  description: text("description").notNull(),
  intensity: integer("intensity"),
  duration: integer("duration"),
  emotionalImpact: integer("emotional_impact"),
  meaningfulness: integer("meaningfulness"),
  lifeChanging: boolean("life_changing").default(false),
  insights: text("insights"),
  howItChangedYou: text("how_it_changed_you"),
  actionsTaken: text("actions_taken"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const spiritualMilestones = pgTable("spiritual_milestones", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  milestoneType: varchar("milestone_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  achievedDate: timestamp("achieved_date"),
  significance: text("significance"),
  howYouGrew: text("how_you_grew"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const spiritualProfiles = pgTable("spiritual_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  spiritualBackground: varchar("spiritual_background", { length: 50 }),
  religiousTradition: varchar("religious_tradition", { length: 255 }),
  hasMeditationPractice: boolean("has_meditation_practice").default(false),
  meditationExperience: varchar("meditation_experience", { length: 50 }),
  currentPractices: text("current_practices"),
  primaryGoal: varchar("primary_goal", { length: 50 }),
  specificGoals: text("specific_goals"),
  barriers: text("barriers"),
  preferredPracticeTime: varchar("preferred_practice_time", { length: 50 }),
  preferredDuration: integer("preferred_duration"),
  preferredStyle: text("preferred_style"),
  mostEffectivePractices: text("most_effective_practices"),
  optimalPracticeTime: integer("optimal_practice_time"),
  bestTimeOfDay: varchar("best_time_of_day", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const strategyAdjustments = pgTable("strategyAdjustments", {
  id: integer("id").primaryKey().notNull(),
  adjustmentType: varchar("adjustment_type", { length: 100 }).notNull(),
  adjustmentDescription: text("adjustment_description").notNull(),
  triggeringData: text("triggering_data"),
  expectedImprovement: text("expected_improvement"),
  implementedAt: timestamp("implemented_at").defaultNow().notNull(),
  isActive: varchar("is_active", { length: 50 }),
  measuredImprovement: text("measured_improvement"),
  wasSuccessful: varchar("was_successful", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const strengthBenchmarks = pgTable("strength_benchmarks", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  testDate: timestamp("test_date").notNull(),
  exercise: varchar("exercise", { length: 255 }).notNull(),
  testType: varchar("test_type", { length: 50 }),
  weight: numeric("weight"),
  reps: integer("reps"),
  duration: integer("duration"),
  bodyweightRatio: numeric("bodyweight_ratio"),
  improvementFromLast: numeric("improvement_from_last"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const stressAnalytics = pgTable("stress_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  interventionType: varchar("intervention_type", { length: 100 }).notNull(),
  avgStressReduction: numeric("avg_stress_reduction"),
  avgEffectivenessRating: numeric("avg_effectiveness_rating"),
  successRate: numeric("success_rate"),
  optimalDuration: integer("optimal_duration"),
  optimalTiming: varchar("optimal_timing", { length: 100 }),
  mostEffectiveForStressType: text("most_effective_for_stress_type"),
  mostEffectiveForUserType: text("most_effective_for_user_type"),
  userCount: integer("user_count"),
  totalUses: integer("total_uses"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const stressEvents = pgTable("stress_events", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  stressLevel: integer("stress_level").notNull(),
  eventTimestamp: timestamp("event_timestamp").notNull(),
  trigger: varchar("trigger", { length: 255 }),
  triggerCategory: varchar("trigger_category", { length: 50 }),
  location: varchar("location", { length: 255 }),
  activity: varchar("activity", { length: 255 }),
  socialContext: varchar("social_context", { length: 50 }),
  heartRate: integer("heart_rate"),
  physicalSymptoms: text("physical_symptoms"),
  primaryEmotion: varchar("primary_emotion", { length: 50 }),
  thoughts: text("thoughts"),
  cognitiveDistortions: text("cognitive_distortions"),
  responseType: varchar("response_type", { length: 50 }),
  interventionUsed: varchar("intervention_used", { length: 255 }),
  interventionEffective: boolean("intervention_effective"),
  recoveryTime: integer("recovery_time"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const stressInterventions = pgTable("stress_interventions", {
  id: varchar("id", { length: 255 }).notNull(),
  interventionName: varchar("intervention_name", { length: 255 }).notNull(),
  description: text("description"),
  category: varchar("category", { length: 50 }),
  researchBacked: boolean("research_backed").default(false),
  researchSources: text("research_sources"),
  durationMinutes: integer("duration_minutes"),
  instructions: text("instructions"),
  bestFor: text("best_for"),
  avgEffectivenessRating: numeric("avg_effectiveness_rating"),
  totalUses: integer("total_uses").default(0),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const stressPredictions = pgTable("stress_predictions", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  predictionType: varchar("prediction_type", { length: 50 }),
  prediction: text("prediction"),
  confidence: numeric("confidence"),
  timeframe: varchar("timeframe", { length: 100 }),
  factors: text("factors"),
  recommendation: text("recommendation"),
  actualOutcome: text("actual_outcome"),
  predictionAccurate: boolean("prediction_accurate"),
  createdAt: timestamp("created_at").defaultNow(),
  validatedAt: timestamp("validated_at"),
});

export const stressProfiles = pgTable("stress_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  baselineStressLevel: integer("baseline_stress_level"),
  baselineHrv: numeric("baseline_hrv"),
  baselineRestingHr: integer("baseline_resting_hr"),
  stressResilienceScore: integer("stress_resilience_score"),
  recoveryCapacity: integer("recovery_capacity"),
  stressMindset: varchar("stress_mindset", { length: 50 }),
  dominantResponse: varchar("dominant_response", { length: 50 }),
  commonTriggers: text("common_triggers"),
  commonSymptoms: text("common_symptoms"),
  preferredInterventions: text("preferred_interventions"),
  stressPatterns: text("stress_patterns"),
  optimalRecoveryTime: integer("optimal_recovery_time"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const stressRecoveryLogs = pgTable("stress_recovery_logs", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  logDate: timestamp("log_date").notNull(),
  perceivedStress: integer("perceived_stress"),
  stressSources: text("stress_sources"),
  morningHrv: integer("morning_hrv"),
  recoveryScore: integer("recovery_score"),
  restingHeartRate: integer("resting_heart_rate"),
  dailyStrain: numeric("daily_strain"),
  recoveryStrategies: text("recovery_strategies"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const stressRecoverySessions = pgTable("stress_recovery_sessions", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  sessionType: varchar("session_type", { length: 50 }),
  durationMinutes: integer("duration_minutes"),
  stressLevelBefore: integer("stress_level_before"),
  hrvBefore: numeric("hrv_before"),
  stressLevelAfter: integer("stress_level_after"),
  hrvAfter: numeric("hrv_after"),
  recoveryScore: integer("recovery_score"),
  notes: text("notes"),
  sessionDate: timestamp("session_date").defaultNow(),
});

export const stressTriggers = pgTable("stress_triggers", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  triggerName: varchar("trigger_name", { length: 255 }).notNull(),
  triggerCategory: varchar("trigger_category", { length: 100 }),
  occurrenceCount: integer("occurrence_count").default(0),
  lastOccurrence: timestamp("last_occurrence"),
  avgStressLevel: numeric("avg_stress_level"),
  avgRecoveryTime: integer("avg_recovery_time"),
  timePatterns: text("time_patterns"),
  contextPatterns: text("context_patterns"),
  avoidable: boolean("avoidable"),
  effectiveStrategies: text("effective_strategies"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const subscription = pgTable("subscription", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  clientProfileId: varchar("client_profile_id", { length: 255 }),
  stripeCustomerId: varchar("stripe_customer_id", { length: 255 }),
  stripeSubscriptionId: varchar("stripe_subscription_id", { length: 255 }),
  status: varchar("status", { length: 50 }).notNull(),
  tier: varchar("tier", { length: 50 }).notNull(),
  priceId: varchar("price_id", { length: 255 }),
  currentPeriodEnd: timestamp("current_period_end"),
  cancelAtPeriodEnd: boolean("cancel_at_period_end").default(false).notNull(),
  foundingMember: boolean("founding_member").default(false).notNull(),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const subscriptions = pgTable("subscriptions", {
  id: integer("id").primaryKey().notNull(),
  userId: integer("user_id").notNull(),
  stripeSubscriptionId: varchar("stripe_subscription_id", { length: 255 }),
  stripeCustomerId: varchar("stripe_customer_id", { length: 255 }),
  stripePriceId: varchar("stripe_price_id", { length: 255 }),
  productId: varchar("product_id", { length: 64 }).notNull(),
  tier: varchar("tier", { length: 50 }),
  billingFrequency: varchar("billing_frequency", { length: 50 }),
  status: varchar("status", { length: 50 }),
  currentPeriodStart: timestamp("current_period_start"),
  currentPeriodEnd: timestamp("current_period_end"),
  cancelAtPeriodEnd: varchar("cancel_at_period_end", { length: 50 }),
  trialStart: timestamp("trial_start"),
  trialEnd: timestamp("trial_end"),
  cancelledAt: timestamp("cancelled_at"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const suggestionEffectiveness = pgTable("suggestionEffectiveness", {
  id: integer("id").primaryKey().notNull(),
  suggestionType: varchar("suggestion_type", { length: 100 }).notNull(),
  totalSuggestions: integer("total_suggestions").notNull(),
  timesUsed: integer("times_used").notNull(),
  timesHelpful: integer("times_helpful").notNull(),
  usageRate: integer("usage_rate").notNull(),
  helpfulnessRate: integer("helpfulness_rate").notNull(),
  avgRating: integer("avg_rating"),
  bestContext: text("best_context"),
  improvements: text("improvements"),
  lastUpdated: timestamp("last_updated").notNull(),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const supplementTracking = pgTable("supplementTracking", {
  id: integer("id").primaryKey().notNull(),
  profileId: integer("profile_id").notNull(),
  supplementName: varchar("supplement_name", { length: 255 }).notNull(),
  dosage: varchar("dosage", { length: 255 }).notNull(),
  frequency: varchar("frequency", { length: 50 }),
  startDate: timestamp("start_date").notNull(),
  endDate: timestamp("end_date"),
  adherence: integer("adherence"),
  sideEffects: text("side_effects"),
  perceivedBenefit: integer("perceived_benefit"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const supplementLogs = pgTable("supplement_logs", {
  id: varchar("id", { length: 255 }).notNull(),
  supplementId: varchar("supplement_id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  logDate: timestamp("log_date").notNull(),
  taken: boolean("taken").default(true),
  dosage: varchar("dosage", { length: 255 }),
  timing: varchar("timing", { length: 100 }),
  withFood: boolean("with_food"),
  perceivedEffect: integer("perceived_effect"),
  sideEffects: text("side_effects"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const supplements = pgTable("supplements", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  supplementName: varchar("supplement_name", { length: 255 }).notNull(),
  brand: varchar("brand", { length: 255 }),
  purpose: varchar("purpose", { length: 50 }),
  dosage: varchar("dosage", { length: 255 }),
  unit: varchar("unit", { length: 50 }),
  frequency: varchar("frequency", { length: 50 }),
  timing: varchar("timing", { length: 50 }),
  active: boolean("active").default(true),
  startDate: timestamp("start_date"),
  endDate: timestamp("end_date"),
  perceivedEffectiveness: integer("perceived_effectiveness"),
  sideEffects: text("side_effects"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const supportTickets = pgTable("support_tickets", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  ticketNumber: varchar("ticket_number", { length: 50 }).notNull(),
  subject: varchar("subject", { length: 500 }).notNull(),
  description: text("description"),
  category: varchar("category", { length: 50 }),
  priority: varchar("priority", { length: 50 }),
  status: varchar("status", { length: 50 }),
  assignedTo: varchar("assigned_to", { length: 255 }),
  assignedAt: timestamp("assigned_at"),
  resolvedBy: varchar("resolved_by", { length: 255 }),
  resolvedAt: timestamp("resolved_at"),
  resolutionNotes: text("resolution_notes"),
  satisfactionRating: integer("satisfaction_rating"),
  satisfactionFeedback: text("satisfaction_feedback"),
  firstResponseAt: timestamp("first_response_at"),
  firstResponseSla: integer("first_response_sla"),
  resolutionSla: integer("resolution_sla"),
  slaBreached: boolean("sla_breached").default(false),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
  closedAt: timestamp("closed_at"),
});

export const syncLogs = pgTable("sync_logs", {
  id: varchar("id", { length: 255 }).notNull(),
  userIntegrationId: varchar("user_integration_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  syncType: varchar("sync_type", { length: 50 }),
  status: varchar("status", { length: 50 }),
  recordsProcessed: integer("records_processed").default(0),
  recordsSuccessful: integer("records_successful").default(0),
  recordsFailed: integer("records_failed").default(0),
  startedAt: timestamp("started_at").defaultNow(),
  completedAt: timestamp("completed_at"),
  durationSeconds: integer("duration_seconds"),
  errorMessage: text("error_message"),
  errorDetails: text("error_details"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const systemAnnouncements = pgTable("system_announcements", {
  id: varchar("id", { length: 255 }).notNull(),
  title: varchar("title", { length: 500 }).notNull(),
  message: text("message").notNull(),
  announcementType: varchar("announcement_type", { length: 50 }),
  severity: varchar("severity", { length: 50 }),
  targetAudience: varchar("target_audience", { length: 50 }),
  targetUserIds: text("target_user_ids"),
  displayLocation: text("display_location"),
  dismissible: boolean("dismissible").default(true),
  startDate: timestamp("start_date"),
  endDate: timestamp("end_date"),
  active: boolean("active").default(true),
  createdBy: varchar("created_by", { length: 255 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const techniqueEffectiveness = pgTable("techniqueEffectiveness", {
  id: integer("id").primaryKey().notNull(),
  techniqueName: varchar("technique_name", { length: 255 }).notNull(),
  techniqueCategory: varchar("technique_category", { length: 100 }).notNull(),
  totalUsage: integer("total_usage").notNull(),
  successCount: integer("success_count").notNull(),
  successRate: integer("success_rate").notNull(),
  avgTimeToResults: integer("avg_time_to_results"),
  bestForIssues: text("best_for_issues"),
  bestForDemographics: text("best_for_demographics"),
  clientFeedback: text("client_feedback"),
  coachNotes: text("coach_notes"),
  lastUpdated: timestamp("last_updated").notNull(),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const therapySessions = pgTable("therapySessions", {
  id: integer("id").primaryKey().notNull(),
  profileId: integer("profile_id").notNull(),
  therapyType: varchar("therapy_type", { length: 50 }),
  sessionDate: timestamp("session_date").notNull(),
  duration: integer("duration").notNull(),
  goalsAddressed: text("goals_addressed"),
  progress: text("progress"),
  parentFeedback: text("parent_feedback"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const thoughtRecords = pgTable("thought_records", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  recordDate: timestamp("record_date").notNull(),
  situation: text("situation").notNull(),
  automaticThought: text("automatic_thought").notNull(),
  emotionsBefore: text("emotions_before"),
  evidenceFor: text("evidence_for"),
  evidenceAgainst: text("evidence_against"),
  cognitiveDistortions: text("cognitive_distortions"),
  balancedThought: text("balanced_thought"),
  emotionsAfter: text("emotions_after"),
  behavioralResponse: text("behavioral_response"),
  effectiveness: integer("effectiveness"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const ticketMessages = pgTable("ticket_messages", {
  id: varchar("id", { length: 255 }).notNull(),
  ticketId: varchar("ticket_id", { length: 255 }).notNull(),
  senderId: varchar("sender_id", { length: 255 }).notNull(),
  senderType: varchar("sender_type", { length: 50 }),
  message: text("message").notNull(),
  attachments: text("attachments"),
  internalNote: boolean("internal_note").default(false),
  sentAt: timestamp("sent_at").defaultNow(),
});

export const transformativeMoments = pgTable("transformative_moments", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  momentDate: timestamp("moment_date").notNull(),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  relatedPrinciple: varchar("related_principle", { length: 255 }),
  momentType: varchar("moment_type", { length: 50 }),
  significance: integer("significance"),
  lifeAreasAffected: text("life_areas_affected"),
  insights: text("insights"),
  lessonsLearned: text("lessons_learned"),
  howToMaintain: text("how_to_maintain"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const transformativePrinciplesAnalytics = pgTable("transformative_principles_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  principleId: varchar("principle_id", { length: 255 }).notNull(),
  avgLifeImpact: numeric("avg_life_impact"),
  avgEmbodimentLevel: numeric("avg_embodiment_level"),
  relationshipImprovement: numeric("relationship_improvement"),
  careerImprovement: numeric("career_improvement"),
  healthImprovement: numeric("health_improvement"),
  mentalHealthImprovement: numeric("mental_health_improvement"),
  optimalPracticeFrequency: varchar("optimal_practice_frequency", { length: 100 }),
  optimalPracticeFormat: varchar("optimal_practice_format", { length: 100 }),
  mostEffectiveFor: text("most_effective_for"),
  practiceCount: integer("practice_count"),
  userCount: integer("user_count"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const transformativePrinciplesProfiles = pgTable("transformative_principles_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  overallGrowth: integer("overall_growth"),
  primaryPrinciple: varchar("primary_principle", { length: 50 }),
  preferredPracticeTime: varchar("preferred_practice_time", { length: 50 }),
  practiceFrequency: varchar("practice_frequency", { length: 50 }),
  remindersEnabled: boolean("reminders_enabled").default(true),
  reminderTime: varchar("reminder_time", { length: 10 }),
  mostImpactfulPrinciples: text("most_impactful_principles"),
  optimalPracticeFormat: text("optimal_practice_format"),
  principleLifeCorrelations: text("principle_life_correlations"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const trendDetection = pgTable("trendDetection", {
  id: integer("id").primaryKey().notNull(),
  trendName: varchar("trend_name", { length: 255 }).notNull(),
  trendDescription: text("trend_description").notNull(),
  trendCategory: varchar("trend_category", { length: 100 }).notNull(),
  affectedPercentage: integer("affected_percentage").notNull(),
  totalClientsAnalyzed: integer("total_clients_analyzed").notNull(),
  affectedClientCount: integer("affected_client_count").notNull(),
  suggestedContent: text("suggested_content"),
  suggestedApproach: text("suggested_approach"),
  isActive: varchar("is_active", { length: 50 }),
  isAddressed: varchar("is_addressed", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const trendData = pgTable("trend_data", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  metricName: varchar("metric_name", { length: 255 }).notNull(),
  metricCategory: varchar("metric_category", { length: 100 }),
  periodType: varchar("period_type", { length: 50 }),
  periodStart: timestamp("period_start").notNull(),
  periodEnd: timestamp("period_end").notNull(),
  value: numeric("value"),
  trendDirection: varchar("trend_direction", { length: 50 }),
  changePercent: numeric("change_percent"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const trustedDevices = pgTable("trusted_devices", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  deviceId: varchar("device_id", { length: 255 }).notNull(),
  deviceName: varchar("device_name", { length: 255 }),
  deviceType: varchar("device_type", { length: 50 }),
  deviceFingerprint: varchar("device_fingerprint", { length: 500 }),
  trusted: boolean("trusted").default(true),
  lastSeenAt: timestamp("last_seen_at"),
  lastSeenIp: varchar("last_seen_ip", { length: 50 }),
  trustedAt: timestamp("trusted_at").defaultNow(),
  untrustedAt: timestamp("untrusted_at"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const usageAlerts = pgTable("usage_alerts", {
  id: integer("id").primaryKey().notNull(),
  userId: integer("user_id").notNull(),
  alertType: varchar("alert_type", { length: 50 }).notNull(),
  resourceType: varchar("resource_type", { length: 50 }).notNull(),
  thresholdValue: integer("threshold_value").notNull(),
  currentValue: integer("current_value").notNull(),
  sentAt: timestamp("sent_at").defaultNow().notNull(),
  acknowledged: boolean("acknowledged").default(false),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const usageSummary = pgTable("usage_summary", {
  id: integer("id").primaryKey().notNull(),
  userId: integer("user_id").notNull(),
  subscriptionId: integer("subscription_id"),
  billingPeriodStart: timestamp("billing_period_start").notNull(),
  billingPeriodEnd: timestamp("billing_period_end").notNull(),
  aiVoiceMinutesUsed: integer("ai_voice_minutes_used").default(0),
  aiVoiceOverageCents: integer("ai_voice_overage_cents").default(0),
  humanCoachCallsUsed: integer("human_coach_calls_used").default(0),
  humanCoachOverageCents: integer("human_coach_overage_cents").default(0),
  totalOverageCents: integer("total_overage_cents").default(0),
  stripeInvoiceId: varchar("stripe_invoice_id", { length: 255 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const usageTracking = pgTable("usage_tracking", {
  id: integer("id").primaryKey().notNull(),
  subscriptionId: integer("subscription_id").notNull(),
  userId: integer("user_id").notNull(),
  periodStart: timestamp("period_start").notNull(),
  periodEnd: timestamp("period_end").notNull(),
  aiSessionsUsed: integer("ai_sessions_used").default(0).notNull(),
  aiMessagesUsed: integer("ai_messages_used").default(0).notNull(),
  humanSessionsUsed: integer("human_sessions_used").default(0).notNull(),
  humanSessionsIncluded: integer("human_sessions_included").notNull(),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const user = pgTable("user", {
  id: varchar("id", { length: 255 }).notNull(),
  openId: varchar("open_id", { length: 255 }).notNull(),
  name: varchar("name", { length: 255 }).notNull(),
  email: varchar("email", { length: 255 }),
  avatar: text("avatar"),
  role: varchar("role", { length: 50 }).notNull(),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const userAchievements = pgTable("user_achievements", {
  id: varchar("id", { length: 255 }).notNull(),
  achievementId: varchar("achievement_id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  progress: integer("progress").default(0),
  completed: boolean("completed").default(false),
  unlockedAt: timestamp("unlocked_at"),
  displayOnProfile: boolean("display_on_profile").default(true),
  createdAt: timestamp("created_at").defaultNow(),
});

export const userBadges = pgTable("user_badges", {
  id: varchar("id", { length: 255 }).notNull(),
  badgeId: varchar("badge_id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  awardedFor: text("awarded_for"),
  displayOnProfile: boolean("display_on_profile").default(true),
  awardedAt: timestamp("awarded_at").defaultNow(),
});

export const userBetaOptIns = pgTable("user_beta_opt_ins", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  betaFeatureId: varchar("beta_feature_id", { length: 255 }).notNull(),
  feedback: text("feedback"),
  rating: integer("rating"),
  optedInAt: timestamp("opted_in_at").defaultNow(),
  optedOutAt: timestamp("opted_out_at"),
});

export const userChallenges = pgTable("user_challenges", {
  id: varchar("id", { length: 255 }).notNull(),
  challengeId: varchar("challenge_id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  progress: integer("progress").default(0),
  completed: boolean("completed").default(false),
  startedAt: timestamp("started_at").defaultNow(),
  completedAt: timestamp("completed_at"),
  attempts: integer("attempts").default(1),
  createdAt: timestamp("created_at").defaultNow(),
});

export const userFeatureFlags = pgTable("user_feature_flags", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  featureName: varchar("feature_name", { length: 100 }).notNull(),
  enabled: boolean("enabled").default(false),
  enabledAt: timestamp("enabled_at"),
  enabledBy: varchar("enabled_by", { length: 100 }),
  createdAt: timestamp("created_at").defaultNow(),
});

export const userFeedback = pgTable("user_feedback", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  feedbackType: varchar("feedback_type", { length: 50 }),
  title: varchar("title", { length: 500 }),
  description: text("description").notNull(),
  page: varchar("page", { length: 255 }),
  feature: varchar("feature", { length: 255 }),
  attachments: text("attachments"),
  status: varchar("status", { length: 50 }),
  upvotes: integer("upvotes").default(0),
  adminResponse: text("admin_response"),
  respondedAt: timestamp("responded_at"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const userIntegrations = pgTable("user_integrations", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  integrationId: varchar("integration_id", { length: 255 }).notNull(),
  status: varchar("status", { length: 50 }),
  accessToken: varchar("access_token", { length: 500 }),
  refreshToken: varchar("refresh_token", { length: 500 }),
  tokenExpiresAt: timestamp("token_expires_at"),
  apiKey: varchar("api_key", { length: 500 }),
  syncEnabled: boolean("sync_enabled").default(true),
  syncFrequency: varchar("sync_frequency", { length: 50 }),
  lastSyncAt: timestamp("last_sync_at"),
  nextSyncAt: timestamp("next_sync_at"),
  dataTypesToSync: text("data_types_to_sync"),
  totalSyncs: integer("total_syncs").default(0),
  totalRecordsImported: integer("total_records_imported").default(0),
  totalRecordsExported: integer("total_records_exported").default(0),
  lastError: text("last_error"),
  errorCount: integer("error_count").default(0),
  satisfactionRating: integer("satisfaction_rating"),
  connectedAt: timestamp("connected_at").defaultNow(),
  disconnectedAt: timestamp("disconnected_at"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const userInterventionLogs = pgTable("user_intervention_logs", {
  id: varchar("id", { length: 255 }).notNull(),
  interventionId: varchar("intervention_id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  stressEventId: varchar("stress_event_id", { length: 255 }),
  stressLevelBefore: integer("stress_level_before"),
  durationMinutes: integer("duration_minutes"),
  completedFully: boolean("completed_fully").default(true),
  stressLevelAfter: integer("stress_level_after"),
  effectivenessRating: integer("effectiveness_rating"),
  sideEffects: text("side_effects"),
  notes: text("notes"),
  usedAt: timestamp("used_at").defaultNow(),
});

export const userNotificationFeedback = pgTable("user_notification_feedback", {
  id: varchar("id", { length: 255 }).notNull(),
  notificationId: varchar("notification_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  feedbackType: varchar("feedback_type", { length: 50 }),
  feedbackText: text("feedback_text"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const userReports = pgTable("user_reports", {
  id: varchar("id", { length: 255 }).notNull(),
  reportedBy: varchar("reported_by", { length: 255 }).notNull(),
  reportedType: varchar("reported_type", { length: 50 }),
  reportedId: varchar("reported_id", { length: 255 }).notNull(),
  reason: varchar("reason", { length: 50 }),
  description: text("description"),
  status: varchar("status", { length: 50 }),
  reviewedBy: varchar("reviewed_by", { length: 255 }),
  reviewedAt: timestamp("reviewed_at"),
  reviewNotes: text("review_notes"),
  actionTaken: varchar("action_taken", { length: 255 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const userResourceInteractions = pgTable("user_resource_interactions", {
  id: varchar("id", { length: 255 }).notNull(),
  resourceId: varchar("resource_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  viewed: boolean("viewed").default(false),
  viewedAt: timestamp("viewed_at"),
  completed: boolean("completed").default(false),
  completedAt: timestamp("completed_at"),
  helpful: boolean("helpful"),
  helpfulnessRating: integer("helpfulness_rating"),
  actionTaken: boolean("action_taken").default(false),
  impactDescription: text("impact_description"),
  recommendedAt: timestamp("recommended_at").defaultNow(),
});

export const userSettings = pgTable("user_settings", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  displayName: varchar("display_name", { length: 255 }),
  bio: text("bio"),
  avatarUrl: varchar("avatar_url", { length: 500 }),
  email: varchar("email", { length: 255 }),
  phoneNumber: varchar("phone_number", { length: 50 }),
  timezone: varchar("timezone", { length: 100 }),
  country: varchar("country", { length: 100 }),
  language: varchar("language", { length: 10 }),
  measurementSystem: varchar("measurement_system", { length: 50 }),
  temperatureUnit: varchar("temperature_unit", { length: 50 }),
  dateFormat: varchar("date_format", { length: 50 }),
  timeFormat: varchar("time_format", { length: 50 }),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const users = pgTable("users", {
  id: integer("id").primaryKey().notNull(),
  openId: varchar("open_id", { length: 64 }).notNull(),
  name: text("name"),
  email: varchar("email", { length: 320 }),
  loginMethod: varchar("login_method", { length: 64 }),
  birthdate: date("birthdate"),
  role: varchar("role", { length: 50 }),
  primaryGoal: text("primary_goal"),
  secondaryGoal: text("secondary_goal"),
  mainChallenges: text("main_challenges"),
  preferredFrequency: varchar("preferred_frequency", { length: 50 }),
  timezone: varchar("timezone", { length: 64 }),
  availability: text("availability"),
  communicationStyle: varchar("communication_style", { length: 50 }),
  triggers: text("triggers"),
  profileCompleteness: integer("profile_completeness").default(0),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
  lastSignedIn: timestamp("last_signed_in").defaultNow().notNull(),
  isTestAccount: boolean("is_test_account").default(false),
  isGuest: boolean("is_guest").default(false),
});

export const validatedResearch = pgTable("validated_research", {
  id: varchar("id", { length: 255 }).notNull(),
  title: varchar("title", { length: 500 }).notNull(),
  authors: text("authors").notNull(),
  journal: varchar("journal", { length: 255 }).notNull(),
  publicationYear: integer("publication_year").notNull(),
  doi: varchar("doi", { length: 255 }),
  pubmedId: varchar("pubmed_id", { length: 50 }),
  url: varchar("url", { length: 500 }),
  studyType: varchar("study_type", { length: 50 }),
  evidenceLevel: varchar("evidence_level", { length: 50 }),
  sampleSize: integer("sample_size"),
  hasControlGroup: boolean("has_control_group"),
  isRandomized: boolean("is_randomized"),
  isBlinded: boolean("is_blinded"),
  hasReplication: boolean("has_replication"),
  effectSize: numeric("effect_size"),
  pValue: numeric("p_value"),
  confidenceInterval: varchar("confidence_interval", { length: 100 }),
  journalImpactFactor: numeric("journal_impact_factor"),
  isPeerReviewed: boolean("is_peer_reviewed").notNull(),
  isOpenAccess: boolean("is_open_access"),
  hasConflictOfInterest: boolean("has_conflict_of_interest"),
  fundingSource: text("funding_source"),
  industrySponsored: boolean("industry_sponsored"),
  domain: varchar("domain", { length: 50 }),
  keyFindings: text("key_findings").notNull(),
  clinicalSignificance: text("clinical_significance"),
  limitations: text("limitations"),
  practicalApplication: text("practical_application"),
  targetPopulation: text("target_population"),
  contraindications: text("contraindications"),
  validationStatus: varchar("validation_status", { length: 50 }),
  reviewedBy: varchar("reviewed_by", { length: 255 }),
  reviewedAt: timestamp("reviewed_at"),
  reviewNotes: text("review_notes"),
  citationCount: integer("citation_count").default(0),
  recommendationCount: integer("recommendation_count").default(0),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const videoTestimonials = pgTable("videoTestimonials", {
  id: integer("id").primaryKey().notNull(),
  name: varchar("name", { length: 255 }).notNull(),
  title: varchar("title", { length: 255 }).notNull(),
  company: varchar("company", { length: 255 }).notNull(),
  quote: text("quote").notNull(),
  metric: varchar("metric", { length: 255 }).notNull(),
  metricValue: varchar("metric_value", { length: 100 }).notNull(),
  videoUrl: text("video_url"),
  videoKey: varchar("video_key", { length: 500 }),
  thumbnailUrl: text("thumbnail_url"),
  thumbnailKey: varchar("thumbnail_key", { length: 500 }),
  duration: integer("duration"),
  isPublished: varchar("is_published", { length: 50 }),
  displayOrder: integer("display_order").default(0).notNull(),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const visualizationAnalytics = pgTable("visualization_analytics", {
  id: varchar("id", { length: 255 }).notNull(),
  widgetType: varchar("widget_type", { length: 100 }).notNull(),
  avgViewDuration: numeric("avg_view_duration"),
  avgViewsPerUser: numeric("avg_views_per_user"),
  actionRate: numeric("action_rate"),
  avgBehaviorChange: numeric("avg_behavior_change"),
  avgHelpfulnessRating: numeric("avg_helpfulness_rating"),
  optimalTimeRange: varchar("optimal_time_range", { length: 100 }),
  optimalUpdateFrequency: varchar("optimal_update_frequency", { length: 100 }),
  mostEffectiveFor: text("most_effective_for"),
  userCount: integer("user_count"),
  totalViews: integer("total_views"),
  lastCalculated: timestamp("last_calculated").defaultNow(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const visualizationProfiles = pgTable("visualization_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  defaultDashboard: varchar("default_dashboard", { length: 50 }),
  preferredChartTypes: text("preferred_chart_types"),
  defaultTimeRange: varchar("default_time_range", { length: 50 }),
  showComparisons: boolean("show_comparisons").default(true),
  showTrendlines: boolean("show_trendlines").default(true),
  showGoalLines: boolean("show_goal_lines").default(true),
  mostViewedCharts: text("most_viewed_charts"),
  mostActionableCharts: text("most_actionable_charts"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const visualizationWidgets = pgTable("visualization_widgets", {
  id: varchar("id", { length: 255 }).notNull(),
  widgetName: varchar("widget_name", { length: 255 }).notNull(),
  description: text("description"),
  widgetType: varchar("widget_type", { length: 50 }),
  dataSource: varchar("data_source", { length: 255 }).notNull(),
  dataQuery: text("data_query"),
  configuration: text("configuration"),
  refreshInterval: integer("refresh_interval"),
  totalUses: integer("total_uses").default(0),
  avgHelpfulnessRating: numeric("avg_helpfulness_rating"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const voiceCoachingFeedback = pgTable("voice_coaching_feedback", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  preferenceId: varchar("preference_id", { length: 255 }),
  sessionMode: varchar("session_mode", { length: 50 }),
  sessionDuration: integer("session_duration"),
  overallRating: integer("overall_rating"),
  styleRating: varchar("style_rating", { length: 50 }),
  paceRating: varchar("pace_rating", { length: 50 }),
  helpfulnessRating: integer("helpfulness_rating"),
  whatWorked: text("what_worked"),
  whatDidntWork: text("what_didnt_work"),
  suggestions: text("suggestions"),
  startingMood: varchar("starting_mood", { length: 50 }),
  endingMood: varchar("ending_mood", { length: 50 }),
  confidenceChange: integer("confidence_change"),
  wouldRecommend: boolean("would_recommend"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const voiceCoachingPreferences = pgTable("voice_coaching_preferences", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  preferredStyle: varchar("preferred_style", { length: 50 }),
  preferredPace: varchar("preferred_pace", { length: 50 }),
  preferredEnergy: varchar("preferred_energy", { length: 50 }),
  feedbackDirectness: varchar("feedback_directness", { length: 50 }),
  challengeLevel: varchar("challenge_level", { length: 50 }),
  effectiveApproaches: text("effective_approaches"),
  ineffectiveApproaches: text("ineffective_approaches"),
  coachNotes: text("coach_notes"),
  knownTriggers: text("known_triggers"),
  preferredVoice: varchar("preferred_voice", { length: 50 }),
  totalSessions: integer("total_sessions").default(0),
  avgSessionRating: numeric("avg_session_rating"),
  lastSessionDate: timestamp("last_session_date"),
  rapportLevel: integer("rapport_level"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const voiceCoachingSessionLogs = pgTable("voice_coaching_session_logs", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  sessionMode: varchar("session_mode", { length: 50 }),
  voiceUsed: varchar("voice_used", { length: 50 }),
  startedAt: timestamp("started_at").defaultNow(),
  endedAt: timestamp("ended_at"),
  durationSeconds: integer("duration_seconds"),
  userSpeakingTime: integer("user_speaking_time"),
  coachSpeakingTime: integer("coach_speaking_time"),
  silenceTime: integer("silence_time"),
  emotionalJourney: text("emotional_journey"),
  breakthroughMoments: text("breakthrough_moments"),
  struggleMoments: text("struggle_moments"),
  adaptationsMade: text("adaptations_made"),
  transcriptSummary: text("transcript_summary"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const voicePrints = pgTable("voice_prints", {
  id: integer("id").primaryKey().notNull(),
  userId: integer("user_id").notNull(),
  voicePrint: text("voice_print").notNull(),
  voicePrintVersion: varchar("voice_print_version", { length: 20 }),
  enrollmentSamples: integer("enrollment_samples").default(3),
  enrollmentQuality: varchar("enrollment_quality", { length: 20 }),
  verificationCount: integer("verification_count").default(0),
  lastVerifiedAt: timestamp("last_verified_at"),
  verificationAccuracy: integer("verification_accuracy").default(0),
  isActive: varchar("is_active", { length: 10 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const voiceSignature = pgTable("voice_signature", {
  id: varchar("id", { length: 255 }).notNull(),
  clientProfileId: varchar("client_profile_id", { length: 255 }).notNull(),
  voiceprint: json("voiceprint"),
  confidenceThreshold: real("confidence_threshold").notNull(),
  lastRecognized: timestamp("last_recognized"),
  recognitionCount: integer("recognition_count").default(0).notNull(),
  createdAt: timestamp("created_at").defaultNow().notNull(),
  updatedAt: timestamp("updated_at").defaultNow().notNull(),
});

export const webhookEvents = pgTable("webhook_events", {
  id: varchar("id", { length: 255 }).notNull(),
  webhookId: varchar("webhook_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  eventType: varchar("event_type", { length: 100 }).notNull(),
  eventPayload: text("event_payload"),
  processed: boolean("processed").default(false),
  processedAt: timestamp("processed_at"),
  processingError: text("processing_error"),
  receivedAt: timestamp("received_at").defaultNow(),
});

export const webhooks = pgTable("webhooks", {
  id: varchar("id", { length: 255 }).notNull(),
  userIntegrationId: varchar("user_integration_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  webhookUrl: varchar("webhook_url", { length: 500 }).notNull(),
  webhookSecret: varchar("webhook_secret", { length: 255 }),
  eventTypes: text("event_types"),
  active: boolean("active").default(true),
  totalReceived: integer("total_received").default(0),
  lastReceivedAt: timestamp("last_received_at"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const weeklyHabitReviews = pgTable("weekly_habit_reviews", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  weekStartDate: timestamp("week_start_date").notNull(),
  overallSuccessRate: numeric("overall_success_rate"),
  totalHabitsCompleted: integer("total_habits_completed"),
  biggestWins: text("biggest_wins"),
  habitsGettingEasier: text("habits_getting_easier"),
  biggestChallenges: text("biggest_challenges"),
  habitsStrugglingWith: text("habits_struggling_with"),
  limitingLanguageCaught: integer("limiting_language_caught"),
  empoweringLanguageUsed: integer("empowering_language_used"),
  keyInsights: text("key_insights"),
  lessonsLearned: text("lessons_learned"),
  adjustmentsPlanned: text("adjustments_planned"),
  newHabitsToStart: text("new_habits_to_start"),
  habitsToModify: text("habits_to_modify"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const weeklyPrincipleReviews = pgTable("weekly_principle_reviews", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  weekStartDate: timestamp("week_start_date").notNull(),
  overallGrowth: integer("overall_growth"),
  focusPrinciple: varchar("focus_principle", { length: 255 }),
  biggestWins: text("biggest_wins"),
  principlesEmbodied: text("principles_embodied"),
  biggestChallenges: text("biggest_challenges"),
  principlesNeeded: text("principles_needed"),
  keyInsights: text("key_insights"),
  lessonsLearned: text("lessons_learned"),
  focusForNextWeek: varchar("focus_for_next_week", { length: 255 }),
  commitments: text("commitments"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const weeklyReports = pgTable("weekly_reports", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  weekStartDate: timestamp("week_start_date").notNull(),
  overallScore: integer("overall_score"),
  scoreChange: numeric("score_change"),
  avgHabitCompletionRate: numeric("avg_habit_completion_rate"),
  habitsCompletionChange: numeric("habits_completion_change"),
  avgSleepDuration: numeric("avg_sleep_duration"),
  avgSleepQuality: numeric("avg_sleep_quality"),
  sleepConsistency: numeric("sleep_consistency"),
  avgMood: numeric("avg_mood"),
  avgEnergy: numeric("avg_energy"),
  moodStability: numeric("mood_stability"),
  goalsAchieved: integer("goals_achieved"),
  goalsInProgress: integer("goals_in_progress"),
  biggestWins: text("biggest_wins"),
  biggestChallenges: text("biggest_challenges"),
  keyInsights: text("key_insights"),
  recommendations: text("recommendations"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const woopPlans = pgTable("woop_plans", {
  id: varchar("id", { length: 255 }).notNull(),
  goalId: varchar("goal_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  wish: text("wish").notNull(),
  outcome: text("outcome").notNull(),
  outcomeVisualization: text("outcome_visualization"),
  obstacle: text("obstacle").notNull(),
  obstacleAnticipation: text("obstacle_anticipation"),
  plan: text("plan").notNull(),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

export const workouts = pgTable("workouts", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  workoutDate: timestamp("workout_date").notNull(),
  workoutType: varchar("workout_type", { length: 50 }),
  primaryFocus: varchar("primary_focus", { length: 50 }),
  duration: integer("duration"),
  intensity: varchar("intensity", { length: 50 }),
  perceivedExertion: integer("perceived_exertion"),
  energyBefore: integer("energy_before"),
  sorenessBefore: integer("soreness_before"),
  motivationBefore: integer("motivation_before"),
  performanceRating: integer("performance_rating"),
  personalRecords: text("personal_records"),
  energyAfter: integer("energy_after"),
  sorenessAfter: integer("soreness_after"),
  satisfactionLevel: integer("satisfaction_level"),
  location: varchar("location", { length: 255 }),
  temperature: integer("temperature"),
  notes: text("notes"),
  completed: boolean("completed").default(true),
  createdAt: timestamp("created_at").defaultNow(),
});

export const writingStreaks = pgTable("writing_streaks", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  startDate: timestamp("start_date").notNull(),
  endDate: timestamp("end_date"),
  streakLength: integer("streak_length"),
  active: boolean("active").default(true),
  createdAt: timestamp("created_at").defaultNow(),
});

export const youngMenMilestones = pgTable("young_men_milestones", {
  id: varchar("id", { length: 255 }).notNull(),
  profileId: varchar("profile_id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  milestoneType: varchar("milestone_type", { length: 50 }),
  title: varchar("title", { length: 255 }).notNull(),
  description: text("description"),
  achievedDate: timestamp("achieved_date"),
  whyItMatters: text("why_it_matters"),
  whoYouBecame: text("who_you_became"),
  createdAt: timestamp("created_at").defaultNow(),
});

export const youngMenProfiles = pgTable("young_men_profiles", {
  id: varchar("id", { length: 255 }).notNull(),
  userId: varchar("user_id", { length: 255 }).notNull(),
  age: integer("age").notNull(),
  livingSituation: varchar("living_situation", { length: 50 }),
  educationStatus: varchar("education_status", { length: 50 }),
  employmentStatus: varchar("employment_status", { length: 50 }),
  hasFatherFigure: boolean("has_father_figure").default(false),
  hasMotherFigure: boolean("has_mother_figure").default(false),
  hasMentor: boolean("has_mentor").default(false),
  hasMaleRoleModel: boolean("has_male_role_model").default(false),
  roleModelGaps: text("role_model_gaps"),
  primaryNeeds: text("primary_needs"),
  primaryGoal: varchar("primary_goal", { length: 50 }),
  specificGoals: text("specific_goals"),
  mainChallenges: text("main_challenges"),
  strengths: text("strengths"),
  interests: text("interests"),
  createdAt: timestamp("created_at").defaultNow(),
  updatedAt: timestamp("updated_at").defaultNow(),
});

// Missing tables referenced in code but not in production - create stubs
export const autismDailyLogs = pgTable("autism_daily_logs", {
  id: serial("id").primaryKey(),
  clientId: integer("client_id"),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const authSessions = pgTable("auth_sessions", {
  id: serial("id").primaryKey(),
  userId: integer("user_id"),
  token: varchar("token", { length: 255 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const anonymousSessions = pgTable("anonymous_sessions", {
  id: serial("id").primaryKey(),
  sessionId: varchar("session_id", { length: 255 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const clientFolders = pgTable("client_folders", {
  id: serial("id").primaryKey(),
  clientId: integer("client_id"),
  name: varchar("name", { length: 255 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});

export const magicLinks = pgTable("magic_links", {
  id: serial("id").primaryKey(),
  email: varchar("email", { length: 255 }),
  token: varchar("token", { length: 255 }),
  createdAt: timestamp("created_at").defaultNow().notNull(),
});
